const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/HomeView-pPfbhNLk.js","assets/vendor-CYhgnaJV.js","assets/libs-BZRZkBIg.js","assets/rolldown-runtime-Cn8xt2Gj.js","assets/tanstack-CjdblyHw.js","assets/supabase-CVUXu_xj.js","assets/PostItem-3jEq9Ip7.js","assets/useViewTracker-Zlm6_4eG.js","assets/useGetSuggestedUsers-DQP3QTN5.js","assets/useFollowUser-Dc9NDPhU.js","assets/ProfileView-urzjDVUv.js","assets/UserStatus-Dw0OykAG.js","assets/MessagesView-D3WcrZr-.js","assets/ReelsView-Bt885gki.js","assets/NotificationsView-CVW2VwXZ.js","assets/ExploreView-Bfz4Vwfp.js","assets/AuthView-Bc6Hr8sa.js","assets/PostView-BlhW58mL.js"])))=>i.map(i=>d[i]);
import{a as e}from"./rolldown-runtime-Cn8xt2Gj.js";import{$ as t,$t as n,A as r,Bt as i,C as a,Ct as o,D as s,E as c,F as l,G as u,Gt as d,H as f,Ht as p,I as m,It as h,Jt as g,Kt as _,L as v,Lt as y,M as b,N as x,Nt as S,O as C,P as w,Pt as T,Qt as E,R as D,Rt as O,S as k,St as A,T as j,Tt as M,U as N,Ut as P,V as F,Vt as I,W as L,Wt as R,X as z,Xt as B,Yt as V,Z as H,Zt as U,_ as W,_t as ee,a as G,at as te,b as K,bt as ne,c as q,d as J,et as Y,f as re,ft as ie,g as ae,gt as oe,h as se,ht as ce,j as le,jt as ue,k as de,l as fe,m as pe,mt as me,nn as he,nt as ge,o as _e,ot as ve,p as ye,pt as be,q as xe,qt as Se,rn as Ce,rt as we,s as Te,st as Ee,tn as De,tt as Oe,u as ke,ut as Ae,v as je,vt as Me,w as Ne,wt as Pe,x as Fe,y as Ie,z as Le,zt as Re}from"./vendor-CYhgnaJV.js";import{C as ze,Ct as Be,S as Ve,St as He,a as Ue,bt as We,i as Ge,o as Ke,wt as qe,x as Je,xt as Ye}from"./libs-BZRZkBIg.js";import{i as Xe,t as Ze}from"./tanstack-CjdblyHw.js";import{t as Qe}from"./supabase-CVUXu_xj.js";(function(){let e=document.createElement(`link`).relList;if(e&&e.supports&&e.supports(`modulepreload`))return;for(let e of document.querySelectorAll(`link[rel="modulepreload"]`))n(e);new MutationObserver(e=>{for(let t of e)if(t.type===`childList`)for(let e of t.addedNodes)e.tagName===`LINK`&&e.rel===`modulepreload`&&n(e)}).observe(document,{childList:!0,subtree:!0});function t(e){let t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin===`use-credentials`?t.credentials=`include`:e.crossOrigin===`anonymous`?t.credentials=`omit`:t.credentials=`same-origin`,t}function n(e){if(e.ep)return;e.ep=!0;let n=t(e);fetch(e.href,n)}})();var $e=he(),X=Ce(),et=e(qe(),1),tt=e(Be(),1),nt=e(He(),1),rt=e(Ye(),1),it=e(We(),1);et.default.extend(tt.default),et.default.extend(nt.default),et.default.extend(rt.default),et.default.extend(it.default);var at=O();const ot=l((e,t)=>({currentUser:{id:``,username:``,name:``,avatar:``,stats:{posts:0,followers:0,following:0}},stories:[],posts:[],savedPostIds:new Set,followedUsers:new Set,theme:`dark`,toastMessage:null,isCreateModalOpen:!1,isEditProfileOpen:!1,viewingStory:null,viewingPost:null,viewingReel:null,isSidebarExpanded:!0,unreadNotificationsCount:0,unreadMessagesCount:0,setUnreadNotificationsCount:t=>e({unreadNotificationsCount:t}),setUnreadMessagesCount:t=>e({unreadMessagesCount:t}),toggleSidebar:()=>e(e=>({isSidebarExpanded:!e.isSidebarExpanded})),toggleTheme:()=>e(e=>({theme:e.theme===`dark`?`light`:`dark`})),setToastMessage:t=>e({toastMessage:t}),showToast:e=>{w(e)},setCreateModalOpen:t=>e({isCreateModalOpen:t}),setEditProfileOpen:t=>e({isEditProfileOpen:t}),setViewingStory:t=>e({viewingStory:t}),setViewingPost:t=>e({viewingPost:t}),setViewingReel:t=>e({viewingReel:t}),setCurrentUser:t=>e({currentUser:t}),addStory:n=>e(e=>{let r={id:String(Date.now()),username:e.currentUser.username,img:n,isUser:!0};return t().showToast(`Story added`),{stories:[r,...e.stories.filter(e=>!e.isUser)]}})})),st=(0,X.createContext)(void 0),ct=()=>{let e=(0,X.useContext)(st);if(e===void 0)throw Error(`useAuth must be used within an AuthProvider`);return e};function Z(...e){return Ve(ze(e))}const lt=e=>new Promise(t=>{let n=document.createElement(`canvas`),r=document.createElement(`video`);r.autoplay=!0,r.muted=!0,r.playsInline=!0,r.src=URL.createObjectURL(e),r.onloadeddata=()=>{r.currentTime=1},r.onseeked=()=>{let e=n.getContext(`2d`);e?(n.width=r.videoWidth,n.height=r.videoHeight,e.drawImage(r,0,0,r.videoWidth,r.videoHeight),n.toBlob(e=>{t(e?new File([e],`thumbnail.jpg`,{type:`image/jpeg`,lastModified:Date.now()}):null),URL.revokeObjectURL(r.src)},`image/jpeg`,.7)):t(null)},r.onerror=()=>{t(null)}});var Q=d();function ut(e){let t=(0,at.c)(8),n,r;t[0]===e?(n=t[1],r=t[2]):({className:n,...r}=e,t[0]=e,t[1]=n,t[2]=r);let i;t[3]===n?i=t[4]:(i=Z(`relative flex size-8 shrink-0 overflow-hidden rounded-full`,n),t[3]=n,t[4]=i);let a;return t[5]!==r||t[6]!==i?(a=(0,Q.jsx)(le,{"data-slot":`avatar`,className:i,...r}),t[5]=r,t[6]=i,t[7]=a):a=t[7],a}function dt(e){let t=(0,at.c)(8),n,i;t[0]===e?(n=t[1],i=t[2]):({className:n,...i}=e,t[0]=e,t[1]=n,t[2]=i);let a;t[3]===n?a=t[4]:(a=Z(`aspect-square size-full`,n),t[3]=n,t[4]=a);let o;return t[5]!==i||t[6]!==a?(o=(0,Q.jsx)(r,{"data-slot":`avatar-image`,className:a,...i}),t[5]=i,t[6]=a,t[7]=o):o=t[7],o}function ft(e){let t=(0,at.c)(8),n,r;t[0]===e?(n=t[1],r=t[2]):({className:n,...r}=e,t[0]=e,t[1]=n,t[2]=r);let i;t[3]===n?i=t[4]:(i=Z(`bg-muted flex size-full items-center justify-center rounded-full`,n),t[3]=n,t[4]=i);let a;return t[5]!==r||t[6]!==i?(a=(0,Q.jsx)(de,{"data-slot":`avatar-fallback`,className:i,...r}),t[5]=r,t[6]=i,t[7]=a):a=t[7],a}var pt=O(),mt=Je(`inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive`,{variants:{variant:{default:`bg-primary text-primary-foreground hover:bg-primary/90`,destructive:`bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60`,outline:`border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50`,secondary:`bg-secondary text-secondary-foreground hover:bg-secondary/80`,ghost:`hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50`,link:`text-primary underline-offset-4 hover:underline`},size:{default:`h-9 px-4 py-2 has-[>svg]:px-3`,sm:`h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5`,lg:`h-10 rounded-md px-6 has-[>svg]:px-4`,icon:`size-9`,"icon-sm":`size-8`,"icon-lg":`size-10`}},defaultVariants:{variant:`default`,size:`default`}});function ht(e){let t=(0,pt.c)(16),n,r,i,a,o;t[0]===e?(n=t[1],r=t[2],i=t[3],a=t[4],o=t[5]):({className:n,variant:i,size:a,asChild:o,...r}=e,t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=a,t[5]=o);let s=i===void 0?`default`:i,c=a===void 0?`default`:a,l=o!==void 0&&o?b:`button`,u;t[6]!==n||t[7]!==c||t[8]!==s?(u=Z(mt({variant:s,size:c,className:n})),t[6]=n,t[7]=c,t[8]=s,t[9]=u):u=t[9];let d;return t[10]!==l||t[11]!==r||t[12]!==c||t[13]!==u||t[14]!==s?(d=(0,Q.jsx)(l,{"data-slot":`button`,"data-variant":s,"data-size":c,className:u,...r}),t[10]=l,t[11]=r,t[12]=c,t[13]=u,t[14]=s,t[15]=d):d=t[15],d}var gt=O(),_t=()=>{let e=(0,gt.c)(96),{toggleTheme:t,currentUser:n,setCreateModalOpen:r,isSidebarExpanded:i,toggleSidebar:a,unreadNotificationsCount:o,unreadMessagesCount:s}=ot(),{signOut:c}=ct(),l,d,f,p;e[0]===Symbol.for(`react.memo_cache_sentinel`)?(l={icon:(0,Q.jsx)(oe,{size:24}),label:`Home`,path:`/`},d={icon:(0,Q.jsx)(H,{size:24}),label:`Explore`,path:`/explore`},f={icon:(0,Q.jsx)(A,{size:24}),label:`Reels`,path:`/reels`},p=(0,Q.jsx)(Ee,{size:24}),e[0]=l,e[1]=d,e[2]=f,e[3]=p):(l=e[0],d=e[1],f=e[2],p=e[3]);let m=s>0?s>99?`99+`:s:void 0,_;e[4]===m?_=e[5]:(_={icon:p,label:`Messages`,path:`/messages`,badge:m},e[4]=m,e[5]=_);let v;e[6]===Symbol.for(`react.memo_cache_sentinel`)?(v=(0,Q.jsx)(ee,{size:24}),e[6]=v):v=e[6];let y=o>0?o>99?`99+`:o:void 0,b;e[7]===y?b=e[8]:(b={icon:v,label:`Notifications`,path:`/notifications`,badge:y},e[7]=y,e[8]=b);let x;e[9]!==_||e[10]!==b?(x=[l,d,f,_,b],e[9]=_,e[10]=b,e[11]=x):x=e[11];let S=x,C=`hidden md:flex flex-col ${i?`w-[245px]`:`w-[72px]`} h-screen fixed border-r border-border p-4 pb-5 justify-between z-50 transition-all duration-300 bg-background text-foreground`,w=`mb-8 mt-4 ${i?`px-2`:`flex justify-center`}`,T;e[12]===i?T=e[13]:(T=i?(0,Q.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,Q.jsx)(`img`,{src:`/icon.png`,alt:`Logo`,className:`w-8 h-8 object-contain`}),(0,Q.jsx)(`h1`,{className:`text-xl font-bold tracking-tight text-[#006a4e]`,children:`Banglagram`})]}):(0,Q.jsx)(Se,{to:`/`,className:`flex justify-center items-center`,children:(0,Q.jsx)(`img`,{src:`/icon.png`,alt:`Banglagram`,className:`w-8 h-8 object-contain`})}),e[12]=i,e[13]=T);let E;e[14]!==w||e[15]!==T?(E=(0,Q.jsx)(`div`,{className:w,children:T}),e[14]=w,e[15]=T,e[16]=E):E=e[16];let D;e[17]!==i||e[18]!==S?(D=S.map((e,t)=>(0,Q.jsx)(g,{to:e.path,className:vt,children:t=>{let{isActive:n}=t;return(0,Q.jsxs)(h.div,{whileTap:{scale:.98},className:`flex items-center ${i?`gap-4 px-3`:`justify-center`} py-3 rounded-lg hover:bg-muted`,children:[(0,Q.jsxs)(`div`,{className:`relative`,children:[(0,Q.jsx)(`div`,{className:n?`text-[#006a4e]`:``,children:e.icon}),e.badge&&(0,Q.jsx)(`div`,{className:`absolute -top-2 -right-2 bg-[#f42a41] text-white text-[10px] font-bold h-4 min-w-[16px] px-1 flex items-center justify-center rounded-full border-2 border-black`,children:e.badge})]}),i&&(0,Q.jsx)(`span`,{className:`text-base truncate`,children:e.label===`Home`?`Home`:e.label===`Explore`?`Explore`:e.label===`Reels`?`Reels`:e.label===`Messages`?`Messages`:e.label===`Notifications`?`Notifications`:e.label})]})}},t)),e[17]=i,e[18]=S,e[19]=D):D=e[19];let O;e[20]===r?O=e[21]:(O=()=>r(!0),e[20]=r,e[21]=O);let k=!i&&`justify-center px-0`,j;e[22]===k?j=e[23]:(j=Z(`flex items-center justify-start w-full gap-4 px-3 py-6 rounded-lg transition-colors cursor-pointer group hover:bg-muted`,k),e[22]=k,e[23]=j);let M;e[24]===Symbol.for(`react.memo_cache_sentinel`)?(M={scale:.98},e[24]=M):M=e[24];let P;e[25]===Symbol.for(`react.memo_cache_sentinel`)?(P=(0,Q.jsx)(`div`,{className:`relative`,children:(0,Q.jsx)(u,{size:24})}),e[25]=P):P=e[25];let F;e[26]===i?F=e[27]:(F=i&&(0,Q.jsx)(`span`,{className:`text-base truncate ml-2 font-normal`,children:`Create`}),e[26]=i,e[27]=F);let I;e[28]===F?I=e[29]:(I=(0,Q.jsxs)(h.div,{whileTap:M,className:`w-full h-full flex items-center`,children:[P,F]}),e[28]=F,e[29]=I);let L;e[30]!==O||e[31]!==j||e[32]!==I?(L=(0,Q.jsx)(ht,{variant:`ghost`,onClick:O,className:j,asChild:!0,children:I}),e[30]=O,e[31]=j,e[32]=I,e[33]=L):L=e[33];let R=`/profile/${n.username}`,z;e[34]!==n.avatar||e[35]!==n.username?.[0]||e[36]!==i?(z=e=>{let{isActive:t}=e;return(0,Q.jsxs)(h.div,{whileTap:{scale:.98},className:`flex items-center ${i?`gap-4 px-3`:`justify-center`} py-3 rounded-lg hover:bg-muted`,children:[(0,Q.jsxs)(ut,{className:Z(`w-6 h-6`,t&&`border-2 border-[#006a4e]`),children:[(0,Q.jsx)(dt,{src:n.avatar}),(0,Q.jsx)(ft,{children:n.username?.[0]?.toUpperCase()||`?`})]}),i&&(0,Q.jsx)(`span`,{className:`text-base truncate`,children:`Profile`})]})},e[34]=n.avatar,e[35]=n.username?.[0],e[36]=i,e[37]=z):z=e[37];let B;e[38]!==R||e[39]!==z?(B=(0,Q.jsx)(g,{to:R,className:yt,children:z}),e[38]=R,e[39]=z,e[40]=B):B=e[40];let V;e[41]!==D||e[42]!==L||e[43]!==B?(V=(0,Q.jsxs)(`div`,{className:`flex flex-col gap-2`,children:[D,L,B]}),e[41]=D,e[42]=L,e[43]=B,e[44]=V):V=e[44];let U;e[45]!==E||e[46]!==V?(U=(0,Q.jsxs)(`div`,{children:[E,V]}),e[45]=E,e[46]=V,e[47]=U):U=e[47];let W=!i&&`justify-center px-0`,G;e[48]===W?G=e[49]:(G=Z(`flex items-center justify-start w-full gap-4 px-3 py-6 rounded-lg transition-colors cursor-pointer group hover:bg-muted`,W),e[48]=W,e[49]=G);let K;e[50]===Symbol.for(`react.memo_cache_sentinel`)?(K={scale:.98},e[50]=K):K=e[50];let ne,q;e[51]===Symbol.for(`react.memo_cache_sentinel`)?(ne=(0,Q.jsx)(N,{size:24,className:`dark:hidden`}),q=(0,Q.jsx)(te,{size:24,className:`hidden dark:block`}),e[51]=ne,e[52]=q):(ne=e[51],q=e[52]);let J;e[53]===i?J=e[54]:(J=i&&(0,Q.jsx)(`span`,{className:`text-base ml-4 font-normal`,children:`Switch Appearance`}),e[53]=i,e[54]=J);let Y;e[55]===J?Y=e[56]:(Y=(0,Q.jsxs)(h.div,{whileTap:K,className:`w-full h-full flex items-center`,children:[ne,q,J]}),e[55]=J,e[56]=Y);let re;e[57]!==G||e[58]!==Y||e[59]!==t?(re=(0,Q.jsx)(ht,{variant:`ghost`,onClick:t,className:G,asChild:!0,children:Y}),e[57]=G,e[58]=Y,e[59]=t,e[60]=re):re=e[60];let ie=!i&&`justify-center px-0`,ae;e[61]===ie?ae=e[62]:(ae=Z(`flex items-center justify-start w-full gap-4 px-3 py-6 rounded-lg transition-colors cursor-pointer group hover:bg-muted`,ie),e[61]=ie,e[62]=ae);let se;e[63]===Symbol.for(`react.memo_cache_sentinel`)?(se={scale:.98},e[63]=se):se=e[63];let ce,le;e[64]===i?(ce=e[65],le=e[66]):(ce=i?(0,Q.jsx)(ge,{size:24}):(0,Q.jsx)(Oe,{size:24}),le=i&&(0,Q.jsx)(`span`,{className:`text-base ml-4 font-normal`,children:`Collapse`}),e[64]=i,e[65]=ce,e[66]=le);let ue;e[67]!==ce||e[68]!==le?(ue=(0,Q.jsxs)(h.div,{whileTap:se,className:`w-full h-full flex items-center`,children:[ce,le]}),e[67]=ce,e[68]=le,e[69]=ue):ue=e[69];let de;e[70]!==ae||e[71]!==ue||e[72]!==a?(de=(0,Q.jsx)(ht,{variant:`ghost`,onClick:a,className:ae,asChild:!0,children:ue}),e[70]=ae,e[71]=ue,e[72]=a,e[73]=de):de=e[73];let fe;e[74]===c?fe=e[75]:(fe=()=>c(),e[74]=c,e[75]=fe);let pe=!i&&`justify-center px-0`,me;e[76]===pe?me=e[77]:(me=Z(`flex items-center justify-start w-full gap-4 px-3 py-6 rounded-lg transition-colors cursor-pointer group hover:bg-muted text-destructive hover:text-destructive/80`,pe),e[76]=pe,e[77]=me);let he;e[78]===Symbol.for(`react.memo_cache_sentinel`)?(he={scale:.98},e[78]=he):he=e[78];let _e;e[79]===Symbol.for(`react.memo_cache_sentinel`)?(_e=(0,Q.jsx)(Ae,{size:24}),e[79]=_e):_e=e[79];let ve;e[80]===i?ve=e[81]:(ve=i&&(0,Q.jsx)(`span`,{className:`text-base ml-4 font-normal`,children:`Log Out`}),e[80]=i,e[81]=ve);let ye;e[82]===ve?ye=e[83]:(ye=(0,Q.jsxs)(h.div,{whileTap:he,className:`w-full h-full flex items-center`,children:[_e,ve]}),e[82]=ve,e[83]=ye);let be;e[84]!==fe||e[85]!==me||e[86]!==ye?(be=(0,Q.jsx)(ht,{variant:`ghost`,onClick:fe,className:me,asChild:!0,children:ye}),e[84]=fe,e[85]=me,e[86]=ye,e[87]=be):be=e[87];let xe;e[88]!==re||e[89]!==de||e[90]!==be?(xe=(0,Q.jsxs)(`div`,{className:`flex flex-col gap-2`,children:[re,de,be]}),e[88]=re,e[89]=de,e[90]=be,e[91]=xe):xe=e[91];let Ce;return e[92]!==C||e[93]!==U||e[94]!==xe?(Ce=(0,Q.jsxs)(`div`,{className:C,children:[U,xe]}),e[92]=C,e[93]=U,e[94]=xe,e[95]=Ce):Ce=e[95],Ce};function vt(e){let{isActive:t}=e;return`block rounded-lg transition-colors cursor-pointer group ${t?`font-bold`:``}`}function yt(e){let{isActive:t}=e;return`block rounded-lg transition-colors cursor-pointer group ${t?`font-bold`:``}`}var bt=O(),xt=()=>{let e=(0,bt.c)(19),{currentUser:t,setCreateModalOpen:n}=ot(),r;e[0]===Symbol.for(`react.memo_cache_sentinel`)?(r=[{icon:(0,Q.jsx)(oe,{size:24}),label:`Home`,path:`/`},{icon:(0,Q.jsx)(H,{size:24}),label:`Explore`,path:`/explore`},{icon:(0,Q.jsx)(A,{size:24}),label:`Reels`,path:`/reels`}],e[0]=r):r=e[0];let i=r,a;e[1]===Symbol.for(`react.memo_cache_sentinel`)?(a=i.map(Ct),e[1]=a):a=e[1];let o;e[2]===Symbol.for(`react.memo_cache_sentinel`)?(o={scale:.8},e[2]=o):o=e[2];let s;e[3]===n?s=e[4]:(s=()=>n(!0),e[3]=n,e[4]=s);let c;e[5]===Symbol.for(`react.memo_cache_sentinel`)?(c=(0,Q.jsx)(u,{size:24}),e[5]=c):c=e[5];let l;e[6]===s?l=e[7]:(l=(0,Q.jsx)(h.div,{whileTap:o,className:`p-3`,onClick:s,children:c}),e[6]=s,e[7]=l);let d;e[8]===Symbol.for(`react.memo_cache_sentinel`)?(d={scale:.8},e[8]=d):d=e[8];let f;e[9]===Symbol.for(`react.memo_cache_sentinel`)?(f=(0,Q.jsx)(g,{to:`/messages`,className:wt,children:(0,Q.jsx)(h.div,{whileTap:d,className:`p-3`,children:(0,Q.jsx)(Ee,{size:24})})}),e[9]=f):f=e[9];let p=`/profile/${t.username}`,m;e[10]!==t.avatar||e[11]!==t.username?.[0]?(m=e=>{let{isActive:n}=e;return(0,Q.jsx)(h.div,{whileTap:{scale:.8},className:`p-3`,children:(0,Q.jsxs)(ut,{className:Z(`w-6 h-6`,n&&`border-2 border-[#006a4e]`),children:[(0,Q.jsx)(dt,{src:t.avatar}),(0,Q.jsx)(ft,{children:t.username?.[0]?.toUpperCase()||`?`})]})})},e[10]=t.avatar,e[11]=t.username?.[0],e[12]=m):m=e[12];let _;e[13]!==p||e[14]!==m?(_=(0,Q.jsx)(g,{to:p,className:Tt,children:m}),e[13]=p,e[14]=m,e[15]=_):_=e[15];let v;return e[16]!==_||e[17]!==l?(v=(0,Q.jsxs)(`div`,{className:`md:hidden fixed bottom-0 left-0 right-0 border-t border-border flex justify-around items-center h-12 z-50 px-2 pb-safe bg-background/90 text-foreground backdrop-blur-md bg-opacity-90`,children:[a,l,f,_]}),e[16]=_,e[17]=l,e[18]=v):v=e[18],v};function St(e){let{isActive:t}=e;return`block ${t?`text-[#006a4e]`:``}`}function Ct(e,t){return(0,Q.jsx)(g,{to:e.path,className:St,children:(0,Q.jsx)(h.div,{whileTap:{scale:.8},className:`p-3`,children:e.icon})},t)}function wt(e){let{isActive:t}=e;return`block ${t?`text-[#006a4e]`:``}`}function Tt(e){let{isActive:t}=e;return`block ${t?`text-[#006a4e]`:``}`}var Et=O(),Dt=()=>{let e=(0,Et.c)(14),{isSidebarExpanded:t}=ot(),{user:n}=ct(),r=E(),i;e[0]===r.pathname?i=e[1]:(i=r.pathname.startsWith(`/messages`),e[0]=r.pathname,e[1]=i);let a=i,o;e[2]===r.pathname?o=e[3]:(o=r.pathname.startsWith(`/reels`),e[2]=r.pathname,e[3]=o);let s=o,c;e[4]!==a||e[5]!==s||e[6]!==n?(c=n?(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(_t,{}),!a&&!s&&(0,Q.jsx)(xt,{})]}):(0,Q.jsx)(`div`,{className:`fixed top-4 right-4 z-[60]`,children:(0,Q.jsx)(Se,{to:`/`,className:`bg-[#006a4e] text-white px-4 py-2 rounded-lg font-semibold text-sm shadow-lg hover:bg-[#00523c] transition-colors`,children:`Log In`})}),e[4]=a,e[5]=s,e[6]=n,e[7]=c):c=e[7];let l=`flex-grow ${n?t?`md:ml-[245px]`:`md:ml-[72px]`:``} flex justify-center transition-all duration-300 ${n&&!a&&!s?`pb-14 md:pb-0`:``}`,u;e[8]===Symbol.for(`react.memo_cache_sentinel`)?(u=(0,Q.jsx)(V,{}),e[8]=u):u=e[8];let d;e[9]===l?d=e[10]:(d=(0,Q.jsx)(`main`,{className:l,children:u}),e[9]=l,e[10]=d);let f;return e[11]!==c||e[12]!==d?(f=(0,Q.jsxs)(`div`,{className:`min-h-screen font-['Hind_Siliguri'] flex flex-col md:flex-row transition-colors duration-300 bg-background text-foreground`,children:[c,d]}),e[11]=c,e[12]=d,e[13]=f):f=e[13],f};const $=Qe(`https://uyffyqlgyjieayivgvhg.supabase.co`,`sb_publishable_WFDkcqORIdT_6pMJSoxjQg_EMHEKNfb`);var Ot=O();const kt=()=>{let e=(0,Ot.c)(12),{user:t}=ct(),n;e[0]===t?n=e[1]:(n=async()=>{if(t)try{let e=new Date().toISOString();await $.from(`profiles`).update({last_seen:e,is_online:!0}).eq(`id`,t.id)}catch(e){let t=e;console.error(`Error updating last seen:`,t)}},e[0]=t,e[1]=n);let r=n,i;e[2]===t?i=e[3]:(i=async()=>{if(t)try{let e=new Date().toISOString();await $.from(`profiles`).update({last_seen:e,is_online:!1}).eq(`id`,t.id)}catch(e){let t=e;console.error(`Error updating offline status:`,t)}},e[2]=t,e[3]=i);let a=i,o,s;e[4]!==r||e[5]!==a||e[6]!==t?(o=()=>{if(!t)return;r();let e=setInterval(r,3e4),n=()=>{document.hidden?a():r()},i=()=>{a()};return document.addEventListener(`visibilitychange`,n),window.addEventListener(`beforeunload`,i),()=>{clearInterval(e),document.removeEventListener(`visibilitychange`,n),window.removeEventListener(`beforeunload`,i)}},s=[t,r,a],e[4]=r,e[5]=a,e[6]=t,e[7]=o,e[8]=s):(o=e[7],s=e[8]),(0,X.useEffect)(o,s);let c;return e[9]!==r||e[10]!==a?(c={updateLastSeen:r,updateOfflineStatus:a},e[9]=r,e[10]=a,e[11]=c):c=e[11],c};var At=O(),jt=60*1e3;const Mt=()=>{let e=(0,At.c)(3),{user:t}=ct(),n,r;e[0]===t?(n=e[1],r=e[2]):(n=()=>{if(!t)return;let e=async()=>{try{await $.from(`profiles`).update({is_online:!0,last_seen:new Date().toISOString()}).eq(`id`,t.id)}catch(e){let t=e;console.error(`Error updating online status:`,t)}};e();let n=setInterval(e,jt),r=()=>{document.visibilityState===`visible`&&e()};return document.addEventListener(`visibilitychange`,r),()=>{clearInterval(n),document.removeEventListener(`visibilitychange`,r)}},r=[t],e[0]=t,e[1]=n,e[2]=r),(0,X.useEffect)(n,r)};var Nt=O(),Pt=e(qe(),1);const Ft=[`feed`],It=e=>{let t=(0,Nt.c)(2),n;return t[0]===e?n=t[1]:(n={queryKey:Ft,queryFn:async t=>{let{pageParam:n}=t,r=n===void 0?0:n,{data:i,error:a}=await $.rpc(`get_ranked_feed_v2`,{current_user_id:e,limit_count:10,offset_count:r*10});if(a)throw a;let o=i||[];return o.length>0&&(console.log(`FIRST POST RAW DATA V2:`,o[0]),console.log(`VIEW COUNT VALUE:`,o[0].view_count)),o.map(Lt)},initialPageParam:0,getNextPageParam:Rt},t[0]=e,t[1]=n),I(n)};function Lt(e){return{id:e.id,user:{id:e.user_id,username:e.username,name:e.full_name||e.username,avatar:e.avatar_url||``,isVerified:e.is_verified||!1},content:{type:e.type===`reel`?`video`:`image`,src:e.type===`reel`?e.video_url:e.image_url,poster:e.thumbnail_url||(e.type===`reel`?e.video_url:e.image_url)},likes:e.likes_count||0,caption:e.caption||``,comments:e.comments_count||0,views:Number(e.view_count||0),time:(0,Pt.default)(e.created_at).fromNow(),createdAt:e.created_at,isVerified:e.is_verified||!1,hasLiked:e.has_liked,hasSaved:e.has_saved}}function Rt(e,t){return e.length===10?t.length:void 0}var zt=O(),Bt=e(qe(),1);const Vt=e=>[`profile`,e],Ht=(e,t)=>{let n=(0,zt.c)(9),r=e||``,i;n[0]===r?i=n[1]:(i=Vt(r),n[0]=r,n[1]=i);let a=!!e,o;n[2]!==t||n[3]!==e?(o=async()=>{if(!e)throw Error(`Username required`);let{data:n,error:r}=await $.from(`profiles`).select(`id, username, full_name, avatar_url, bio, is_verified, is_online, last_seen`).eq(`username`,e).single();if(r)throw r;let i=n,{count:a}=await $.from(`posts`).select(`*`,{count:`exact`,head:!0}).eq(`user_id`,i.id),{count:o}=await $.from(`follows`).select(`*`,{count:`exact`,head:!0}).eq(`following_id`,i.id),{count:s}=await $.from(`follows`).select(`*`,{count:`exact`,head:!0}).eq(`follower_id`,i.id),{data:c}=await $.from(`posts`).select(`
           id,
           image_url,
           caption,
           created_at,
           likes (count),
           comments (count)
        `).eq(`user_id`,i.id).order(`created_at`,{ascending:!1}),l=c||[],u=new Set;if(t&&l.length>0){let e=l.map(Ut),{data:n}=await $.from(`likes`).select(`post_id`).eq(`user_id`,t).in(`post_id`,e);n&&n.forEach(e=>u.add(e.post_id||``))}let d=!1;if(t&&t!==i.id){let{count:e}=await $.from(`follows`).select(`*`,{count:`exact`,head:!0}).match({follower_id:t,following_id:i.id});d=!!e&&e>0}let f=l.map(e=>{let t=e.likes,n=e.comments;return{id:e.id,user:{id:i.id,username:i.username,name:i.full_name||i.username,avatar:i.avatar_url||``,isVerified:i.is_verified||!1},content:{type:`image`,src:e.image_url},likes:t[0]?.count||0,caption:e.caption||``,comments:n[0]?.count||0,time:(0,Bt.default)(e.created_at).fromNow(),isVerified:i.is_verified||!1,hasLiked:u.has(e.id)}});return{user:{id:i.id,username:i.username,name:i.full_name||``,avatar:i.avatar_url||``,bio:i.bio||``,isVerified:i.is_verified||!1,stats:{posts:a||0,followers:o||0,following:s||0},isFollowing:d,isOnline:i.is_online,lastSeen:i.last_seen},posts:f}},n[2]=t,n[3]=e,n[4]=o):o=n[4];let s;return n[5]!==i||n[6]!==a||n[7]!==o?(s={queryKey:i,enabled:a,queryFn:o},n[5]=i,n[6]=a,n[7]=o,n[8]=s):s=n[8],P(s)};function Ut(e){return e.id}var Wt=O(),Gt=e(qe(),1);const Kt=()=>{let e=(0,Wt.c)(2),t=R(),n;return e[0]===t?n=e[1]:(n={mutationFn:qt,onSuccess:(e,n)=>{t.invalidateQueries({queryKey:Ft}),t.invalidateQueries({queryKey:Vt(n.username)})}},e[0]=t,e[1]=n),p(n)};async function qt(e){let{files:t,thumbnail:n,caption:r,userId:i}=e,a=t.map(async e=>{let t=e.name.split(`.`).pop(),n=`${i}/${(0,Gt.default)().valueOf()}_${Math.random().toString(36).substr(2,9)}.${t}`,{error:r}=await $.storage.from(`posts`).upload(n,e,{cacheControl:`3600`,upsert:!1,contentType:e.type});if(r)throw r;let{data:a}=$.storage.from(`posts`).getPublicUrl(n),{publicUrl:o}=a;return o}),o=await Promise.all(a),s=JSON.stringify(o),c=null;if(n){let e=`${i}/${(0,Gt.default)().valueOf()}_thumb.jpg`,{error:t}=await $.storage.from(`posts`).upload(e,n,{cacheControl:`3600`,upsert:!1,contentType:`image/jpeg`});if(!t){let{data:t}=$.storage.from(`posts`).getPublicUrl(e);c=t.publicUrl}}let{data:l,error:u}=await $.from(`posts`).insert({user_id:i,caption:r,image_url:s,thumbnail_url:c}).select().single();if(u)throw u;return l}var Jt=O();const Yt=[`reels`],Xt=e=>{let t=(0,Jt.c)(2),n;return t[0]===e?n=t[1]:(n={queryKey:Yt,initialPageParam:0,queryFn:async t=>{let{pageParam:n}=t,r=(n===void 0?0:n)*5,i=r+4,{data:a,error:o}=await $.from(`reels`).select(`
          *,
          profiles (username, full_name, avatar_url, is_verified),
          likes (count),
          comments (count)
        `).order(`created_at`,{ascending:!1}).range(r,i);if(o)throw o;let s=a||[],c=s.map(Zt),l=new Set,u=Array.from(new Set(s.map(Qt))),d=new Set;if(e){if(c.length>0){let{data:t}=await $.from(`likes`).select(`reel_id`).eq(`user_id`,e).in(`reel_id`,c);t&&t.forEach(e=>l.add(e.reel_id||``))}if(u.length>0){let{data:t}=await $.from(`follows`).select(`following_id`).eq(`follower_id`,e).in(`following_id`,u);t&&t.forEach(e=>d.add(e.following_id))}}return s.map(e=>({id:e.id,userId:e.user_id,user:{id:e.user_id,username:e.profiles?.username||`Unknown`,name:e.profiles?.full_name||`Unknown`,avatar:e.profiles?.avatar_url||``,isVerified:e.profiles?.is_verified||!1,isFollowing:d.has(e.user_id)},src:e.video_url,likes:e.likes?.[0]?.count||0,comments:e.comments?.[0]?.count||0,views:e.view_count||0,caption:e.caption||``,audio:e.audio_track_name||`Original Audio`,hasLiked:l.has(e.id)}))},getNextPageParam:$t},t[0]=e,t[1]=n),I(n)};function Zt(e){return e.id}function Qt(e){return e.user_id}function $t(e,t){return e.length===5?t.length:void 0}var en=O(),tn=e(qe(),1);const nn=()=>{let e=(0,en.c)(2),t=R(),n;return e[0]===t?n=e[1]:(n={mutationFn:rn,onSuccess:()=>{t.invalidateQueries({queryKey:Yt})}},e[0]=t,e[1]=n),p(n)};async function rn(e){let{file:t,thumbnail:n,caption:r,userId:i}=e,a=t.name.split(`.`).pop(),o=`${i}/${(0,tn.default)().valueOf()}.${a}`,{error:s}=await $.storage.from(`reels`).upload(o,t,{cacheControl:`3600`,upsert:!1,contentType:t.type});if(s)throw s;let{data:c}=$.storage.from(`reels`).getPublicUrl(o),{publicUrl:l}=c,u=null;if(n){let e=`${i}/${(0,tn.default)().valueOf()}_thumb.jpg`,{error:t}=await $.storage.from(`reels`).upload(e,n,{cacheControl:`3600`,upsert:!1,contentType:`image/jpeg`});if(!t){let{data:t}=$.storage.from(`reels`).getPublicUrl(e);u=t.publicUrl}}let{data:d,error:f}=await $.from(`reels`).insert({user_id:i,caption:r,video_url:l,thumbnail_url:u}).select().single();if(f)throw f;return d}var an=O();const on=[`stories`],sn=e=>{let t=(0,an.c)(2),n;return t[0]===e?n=t[1]:(n={queryKey:on,queryFn:async()=>{let{data:t,error:n}=await $.from(`stories`).select(`
            *,
            user:profiles (
                username,
                avatar_url,
                is_verified
            )
        `).order(`created_at`,{ascending:!1});if(n)throw n;return t.map(t=>({id:t.id,username:t.user?.username||`User`,userAvatar:t.user?.avatar_url||``,img:t.media_url,isUser:t.user_id===e,isVerified:t.user?.is_verified||!1,createdAt:t.created_at}))}},t[0]=e,t[1]=n),P(n)};var cn=O(),ln=e(qe(),1);const un=()=>{let e=(0,cn.c)(2),t=R(),n;return e[0]===t?n=e[1]:(n={mutationFn:dn,onSuccess:()=>{t.invalidateQueries({queryKey:on})}},e[0]=t,e[1]=n),p(n)};async function dn(e){let{file:t,userId:n}=e,r=t.name.split(`.`).pop(),i=`${`${n}-${(0,ln.default)().valueOf()}.${r}`}`,{error:a}=await $.storage.from(`stories`).upload(i,t);if(a)throw a;let{data:o}=$.storage.from(`stories`).getPublicUrl(i),{publicUrl:s}=o,c=(0,ln.default)().add(24,`hour`),{error:l}=await $.from(`stories`).insert({user_id:n,media_url:s,expires_at:c.toISOString()});if(l)throw l}var fn=O();function pn(e){let t=(0,fn.c)(8),n,r;t[0]===e?(n=t[1],r=t[2]):({className:n,...r}=e,t[0]=e,t[1]=n,t[2]=r);let i;t[3]===n?i=t[4]:(i=Z(`border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm`,n),t[3]=n,t[4]=i);let a;return t[5]!==r||t[6]!==i?(a=(0,Q.jsx)(`textarea`,{"data-slot":`textarea`,className:i,...r}),t[5]=r,t[6]=i,t[7]=a):a=t[7],a}var mn=O();function hn(e){let t=(0,mn.c)(4),n;t[0]===e?n=t[1]:({...n}=e,t[0]=e,t[1]=n);let r;return t[2]===n?r=t[3]:(r=(0,Q.jsx)(s,{"data-slot":`dialog`,...n}),t[2]=n,t[3]=r),r}function gn(e){let t=(0,mn.c)(4),n;t[0]===e?n=t[1]:({...n}=e,t[0]=e,t[1]=n);let r;return t[2]===n?r=t[3]:(r=(0,Q.jsx)(c,{"data-slot":`dialog-portal`,...n}),t[2]=n,t[3]=r),r}function _n(e){let t=(0,mn.c)(8),n,r;t[0]===e?(n=t[1],r=t[2]):({className:n,...r}=e,t[0]=e,t[1]=n,t[2]=r);let i;t[3]===n?i=t[4]:(i=Z(`data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50`,n),t[3]=n,t[4]=i);let a;return t[5]!==r||t[6]!==i?(a=(0,Q.jsx)(j,{"data-slot":`dialog-overlay`,className:i,...r}),t[5]=r,t[6]=i,t[7]=a):a=t[7],a}function vn(e){let t=(0,mn.c)(15),n,r,i,o;t[0]===e?(n=t[1],r=t[2],i=t[3],o=t[4]):({className:r,children:n,showCloseButton:o,...i}=e,t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o);let s=o===void 0?!0:o,c;t[5]===Symbol.for(`react.memo_cache_sentinel`)?(c=(0,Q.jsx)(_n,{}),t[5]=c):c=t[5];let l;t[6]===r?l=t[7]:(l=Z(`bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 outline-none sm:max-w-lg`,r),t[6]=r,t[7]=l);let u;t[8]===s?u=t[9]:(u=s&&(0,Q.jsxs)(a,{"data-slot":`dialog-close`,className:`ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4`,children:[(0,Q.jsx)(m,{}),(0,Q.jsx)(`span`,{className:`sr-only`,children:`Close`})]}),t[8]=s,t[9]=u);let d;return t[10]!==n||t[11]!==i||t[12]!==l||t[13]!==u?(d=(0,Q.jsxs)(gn,{"data-slot":`dialog-portal`,children:[c,(0,Q.jsxs)(Ne,{"data-slot":`dialog-content`,className:l,...i,children:[n,u]})]}),t[10]=n,t[11]=i,t[12]=l,t[13]=u,t[14]=d):d=t[14],d}function yn(e){let t=(0,mn.c)(8),n,r;t[0]===e?(n=t[1],r=t[2]):({className:n,...r}=e,t[0]=e,t[1]=n,t[2]=r);let i;t[3]===n?i=t[4]:(i=Z(`flex flex-col gap-2 text-center sm:text-left`,n),t[3]=n,t[4]=i);let a;return t[5]!==r||t[6]!==i?(a=(0,Q.jsx)(`div`,{"data-slot":`dialog-header`,className:i,...r}),t[5]=r,t[6]=i,t[7]=a):a=t[7],a}function bn(e){let t=(0,mn.c)(8),n,r;t[0]===e?(n=t[1],r=t[2]):({className:n,...r}=e,t[0]=e,t[1]=n,t[2]=r);let i;t[3]===n?i=t[4]:(i=Z(`text-lg leading-none font-semibold`,n),t[3]=n,t[4]=i);let a;return t[5]!==r||t[6]!==i?(a=(0,Q.jsx)(C,{"data-slot":`dialog-title`,className:i,...r}),t[5]=r,t[6]=i,t[7]=a):a=t[7],a}var xn=({onFileSelect:e,accept:t={"image/*":[],"video/*":[]},maxSize:n=100*1024*1024,multiple:r=!1})=>{let{getRootProps:i,getInputProps:a,isDragActive:o,isDragReject:s}=k({onDrop:(0,X.useCallback)(t=>{t&&t.length>0&&e(t)},[e]),accept:t,maxSize:n,multiple:r}),c=o?`border-primary`:s?`border-destructive`:`border-border`,l=o?`bg-primary/10`:`bg-transparent`;return(0,Q.jsxs)(`div`,{...i(),className:`w-full h-full min-h-[300px] flex flex-col items-center justify-center border-2 border-dashed ${c} ${l} rounded-xl transition-colors cursor-pointer p-8`,children:[(0,Q.jsx)(`input`,{...a()}),(0,Q.jsxs)(`div`,{className:`flex flex-col items-center gap-4 text-center`,children:[(0,Q.jsxs)(`div`,{className:`flex gap-4 mb-2`,children:[(0,Q.jsx)(me,{size:40,className:`text-foreground opacity-80`}),(0,Q.jsx)(Le,{size:40,className:`text-foreground opacity-80`})]}),o?(0,Q.jsx)(`p`,{className:`text-xl font-medium text-primary`,children:`Drop files here`}):s?(0,Q.jsx)(`p`,{className:`text-xl font-medium text-destructive`,children:`File not supported`}):(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(`p`,{className:`text-xl font-light text-foreground`,children:`Drag photos or videos here`}),(0,Q.jsx)(`button`,{className:`bg-primary hover:bg-primary/90 text-primary-foreground px-4 py-2 rounded-lg text-sm font-semibold transition-colors mt-4`,children:`Select`})]})]})]})},Sn=O();function Cn(e){let t=(0,Sn.c)(8),n,r;t[0]===e?(n=t[1],r=t[2]):({className:n,...r}=e,t[0]=e,t[1]=n,t[2]=r);let i;t[3]===n?i=t[4]:(i=Z(`bg-accent animate-pulse rounded-md`,n),t[3]=n,t[4]=i);let a;return t[5]!==r||t[6]!==i?(a=(0,Q.jsx)(`div`,{"data-slot":`skeleton`,className:i,...r}),t[5]=r,t[6]=i,t[7]=a):a=t[7],a}var wn=O(),Tn=e=>{let t=(0,wn.c)(24),n,r,i,a,o;t[0]===e?(n=t[1],r=t[2],i=t[3],a=t[4],o=t[5]):({src:o,alt:n,className:r,fallbacknode:i,...a}=e,t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=a,t[5]=o);let[s,c]=(0,X.useState)(!1),[l,u]=(0,X.useState)(!0);if(!o||s){if(i){let e;return t[6]===i?e=t[7]:(e=(0,Q.jsx)(Q.Fragment,{children:i}),t[6]=i,t[7]=e),e}let e=`flex items-center justify-center bg-gray-100 dark:bg-zinc-800 text-gray-400 ${r}`,n;t[8]===Symbol.for(`react.memo_cache_sentinel`)?(n=(0,Q.jsx)(ce,{size:24}),t[8]=n):n=t[8];let a;return t[9]===e?a=t[10]:(a=(0,Q.jsx)(`div`,{className:e,children:n}),t[9]=e,t[10]=a),a}let d;t[11]!==r||t[12]!==l?(d=l&&(0,Q.jsx)(Cn,{className:`absolute inset-0 ${r}`}),t[11]=r,t[12]=l,t[13]=d):d=t[13];let f=`${r} ${l?`opacity-0`:`opacity-100`} transition-opacity duration-300`,p,m;t[14]===Symbol.for(`react.memo_cache_sentinel`)?(p=()=>{c(!0),u(!1)},m=()=>u(!1),t[14]=p,t[15]=m):(p=t[14],m=t[15]);let h;t[16]!==n||t[17]!==a||t[18]!==o||t[19]!==f?(h=(0,Q.jsx)(`img`,{src:o,alt:n,className:f,onError:p,onLoad:m,...a}),t[16]=n,t[17]=a,t[18]=o,t[19]=f,t[20]=h):h=t[20];let g;return t[21]!==d||t[22]!==h?(g=(0,Q.jsxs)(Q.Fragment,{children:[d,h]}),t[21]=d,t[22]=h,t[23]=g):g=t[23],g},En=O(),Dn=e=>{let t=(0,En.c)(62),{images:n,aspectRatio:r,className:i,imageClassName:a,onDoubleClick:o}=e,s=r===void 0?`aspect-square`:r,[c,l]=(0,X.useState)(0),[u,d]=(0,X.useState)(0);if(n.length<=1){let e;t[0]!==s||t[1]!==i?(e=Z(`w-full relative overflow-hidden`,s,i),t[0]=s,t[1]=i,t[2]=e):e=t[2];let r;t[3]!==a||t[4]!==n[0]||t[5]!==n.length?(r=n.length===1&&(0,Q.jsx)(Tn,{src:n[0],className:Z(`w-full h-full`,a||`object-cover`),alt:`Post content`}),t[3]=a,t[4]=n[0],t[5]=n.length,t[6]=r):r=t[6];let c;return t[7]!==o||t[8]!==e||t[9]!==r?(c=(0,Q.jsx)(`div`,{className:e,onDoubleClick:o,children:r}),t[7]=o,t[8]=e,t[9]=r,t[10]=c):c=t[10],c}let f;t[11]===n.length?f=t[12]:(f=e=>{d(e),l(t=>{let r=t+e;return r<0&&(r=0),r>=n.length&&(r=n.length-1),r})},t[11]=n.length,t[12]=f);let p=f,m;t[13]!==c||t[14]!==n.length||t[15]!==p?(m=(e,t)=>{t.offset.x<-50&&c<n.length-1?p(1):t.offset.x>50&&c>0&&p(-1)},t[13]=c,t[14]=n.length,t[15]=p,t[16]=m):m=t[16];let g=m,_;t[17]===Symbol.for(`react.memo_cache_sentinel`)?(_={enter:On,center:{zIndex:1,x:0,opacity:1},exit:kn},t[17]=_):_=t[17];let v=_,b;t[18]!==s||t[19]!==i?(b=Z(`w-full relative overflow-hidden group touch-pan-y`,s,i),t[18]=s,t[19]=i,t[20]=b):b=t[20];let x;t[21]===Symbol.for(`react.memo_cache_sentinel`)?(x={x:{type:`spring`,stiffness:300,damping:30},opacity:{duration:.2}},t[21]=x):x=t[21];let S;t[22]===Symbol.for(`react.memo_cache_sentinel`)?(S={left:0,right:0},t[22]=S):S=t[22];let C=n[c],w=a||`object-cover`,T;t[23]===w?T=t[24]:(T=Z(`w-full h-full pointer-events-none`,w),t[23]=w,t[24]=T);let E=`Slide ${c+1}`,D;t[25]!==T||t[26]!==E||t[27]!==C?(D=(0,Q.jsx)(Tn,{src:C,className:T,alt:E}),t[25]=T,t[26]=E,t[27]=C,t[28]=D):D=t[28];let O;t[29]!==c||t[30]!==u||t[31]!==g||t[32]!==D?(O=(0,Q.jsx)(h.div,{custom:u,variants:v,initial:`enter`,animate:`center`,exit:`exit`,transition:x,drag:`x`,dragConstraints:S,dragElastic:1,onDragEnd:g,className:`absolute inset-0 w-full h-full`,children:D},c),t[29]=c,t[30]=u,t[31]=g,t[32]=D,t[33]=O):O=t[33];let k;t[34]!==u||t[35]!==O?(k=(0,Q.jsx)(y,{initial:!1,custom:u,mode:`popLayout`,children:O}),t[34]=u,t[35]=O,t[36]=k):k=t[36];let A;t[37]!==c||t[38]!==p?(A=c>0&&(0,Q.jsx)(`button`,{className:`absolute left-2 top-1/2 -translate-y-1/2 bg-black/50 text-white p-1.5 rounded-full opacity-0 group-hover:opacity-100 transition-opacity z-10 hover:bg-black/70 backdrop-blur-sm`,onClick:e=>{e.stopPropagation(),p(-1)},children:(0,Q.jsx)(M,{size:16})}),t[37]=c,t[38]=p,t[39]=A):A=t[39];let j;t[40]!==c||t[41]!==n.length||t[42]!==p?(j=c<n.length-1&&(0,Q.jsx)(`button`,{className:`absolute right-2 top-1/2 -translate-y-1/2 bg-black/50 text-white p-1.5 rounded-full opacity-0 group-hover:opacity-100 transition-opacity z-10 hover:bg-black/70 backdrop-blur-sm`,onClick:e=>{e.stopPropagation(),p(1)},children:(0,Q.jsx)(Pe,{size:16})}),t[40]=c,t[41]=n.length,t[42]=p,t[43]=j):j=t[43];let N;if(t[44]!==c||t[45]!==n){let e;t[47]===c?e=t[48]:(e=(e,t)=>(0,Q.jsx)(`div`,{className:Z(`w-1.5 h-1.5 rounded-full transition-all shadow-sm`,t===c?`bg-white scale-125`:`bg-white/40`)},t),t[47]=c,t[48]=e),N=n.map(e),t[44]=c,t[45]=n,t[46]=N}else N=t[46];let P;t[49]===N?P=t[50]:(P=(0,Q.jsx)(`div`,{className:`absolute bottom-4 left-0 right-0 flex justify-center gap-1.5 z-10 pointer-events-none`,children:N}),t[49]=N,t[50]=P);let F=c+1,I;t[51]!==n.length||t[52]!==F?(I=(0,Q.jsxs)(`div`,{className:`absolute top-4 right-4 bg-black/60 text-white text-xs px-2 py-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none z-10 backdrop-blur-sm`,children:[F,`/`,n.length]}),t[51]=n.length,t[52]=F,t[53]=I):I=t[53];let L;return t[54]!==o||t[55]!==k||t[56]!==A||t[57]!==j||t[58]!==P||t[59]!==I||t[60]!==b?(L=(0,Q.jsxs)(`div`,{className:b,onDoubleClick:o,children:[k,A,j,P,I]}),t[54]=o,t[55]=k,t[56]=A,t[57]=j,t[58]=P,t[59]=I,t[60]=b,t[61]=L):L=t[61],L};function On(e){return{x:e>0?`100%`:`-100%`,opacity:1}}function kn(e){return{zIndex:0,x:e<0?`100%`:`-100%`,opacity:1}}var An=O(),jn=()=>{let e=(0,An.c)(61),{isCreateModalOpen:t,setCreateModalOpen:n,showToast:r}=ot(),{user:i,profile:a}=ct(),o;e[0]===Symbol.for(`react.memo_cache_sentinel`)?(o=[],e[0]=o):o=e[0];let[s,c]=(0,X.useState)(o),l;e[1]===Symbol.for(`react.memo_cache_sentinel`)?(l=[],e[1]=l):l=e[1];let[u,d]=(0,X.useState)(l),[f,p]=(0,X.useState)(null),[m,h]=(0,X.useState)(``),[g,_]=(0,X.useState)(!1),[v,y]=(0,X.useState)(null),{mutate:b,isPending:x}=Kt(),{mutate:C,isPending:w}=nn(),{mutate:E,isPending:D}=un(),O=x||w||D,k;e[2]===Symbol.for(`react.memo_cache_sentinel`)?(k=async e=>{if(e&&e.length>0){c(e);let t=e[0],n=t.type.startsWith(`video/`);_(n),d(e.map(Mn)),n?(y(`reel`),p(await lt(t))):(y(`post`),p(null))}},e[2]=k):k=e[2];let A=k,j,M;e[3]!==m||e[4]!==b||e[5]!==C||e[6]!==E||e[7]!==v||e[8]!==s||e[9]!==a||e[10]!==n||e[11]!==r||e[12]!==f||e[13]!==i?(j=async()=>{s.length===0||!i||!a||(v===`reel`?C({file:s[0],thumbnail:f,caption:m,userId:i.id,username:a.username},{onSuccess:()=>{r(`Reel shared`),n(!1),M()},onError:()=>r(`Failed to share reel`)}):v===`story`?E({file:s[0],userId:i.id},{onSuccess:()=>{r(`Story shared`),n(!1),M()},onError:()=>r(`Failed to share story`)}):b({files:s,thumbnail:f,caption:m,userId:i.id,username:a.username},{onSuccess:()=>{r(`Post shared`),n(!1),M()},onError:()=>r(`Failed to share post`)}))},M=()=>{c([]),d([]),p(null),h(``),_(!1),y(null)},e[3]=m,e[4]=b,e[5]=C,e[6]=E,e[7]=v,e[8]=s,e[9]=a,e[10]=n,e[11]=r,e[12]=f,e[13]=i,e[14]=j,e[15]=M):(j=e[14],M=e[15]);let N;e[16]!==O||e[17]!==M||e[18]!==n?(N=e=>{e||(n(!1),O||M())},e[16]=O,e[17]=M,e[18]=n,e[19]=N):N=e[19];let P=N,F;e[20]===u.length?F=e[21]:(F=u.length>0&&(0,Q.jsx)(ht,{variant:`ghost`,size:`icon`,className:`-ml-2`,onClick:()=>{d([]),c([]),y(null)},children:(0,Q.jsx)(T,{className:`h-6 w-6`})}),e[20]=u.length,e[21]=F);let I;e[22]===F?I=e[23]:(I=(0,Q.jsx)(`div`,{className:`w-20 flex justify-start`,children:F}),e[22]=F,e[23]=I);let L=u.length>0?v===`reel`?`New Reel`:v===`story`?`New Story`:`New Post`:`Create New Post`,R;e[24]===L?R=e[25]:(R=(0,Q.jsx)(bn,{className:`font-semibold text-lg text-center flex-grow`,children:L}),e[24]=L,e[25]=R);let z;e[26]!==j||e[27]!==O||e[28]!==u.length?(z=u.length>0&&(0,Q.jsx)(ht,{variant:`ghost`,onClick:j,disabled:O,className:`text-blue-500 hover:text-blue-600 hover:bg-blue-500/10 font-semibold px-2`,children:O?(0,Q.jsx)(ie,{className:`h-5 w-5 animate-spin`}):`Share`}),e[26]=j,e[27]=O,e[28]=u.length,e[29]=z):z=e[29];let B;e[30]===z?B=e[31]:(B=(0,Q.jsx)(`div`,{className:`w-20 flex justify-end`,children:z}),e[30]=z,e[31]=B);let V;e[32]!==I||e[33]!==R||e[34]!==B?(V=(0,Q.jsxs)(yn,{className:`px-4 h-14 border-b flex flex-row items-center justify-between shrink-0 space-y-0`,children:[I,R,B]}),e[32]=I,e[33]=R,e[34]=B,e[35]=V):V=e[35];let H=u.length>0?`md:border-r border-border`:``,U;e[36]===H?U=e[37]:(U=Z(`flex-1 bg-black relative flex items-center justify-center overflow-hidden`,H),e[36]=H,e[37]=U);let W;e[38]!==g||e[39]!==u?(W=u.length>0?(0,Q.jsx)(`div`,{className:`relative w-full h-full flex items-center justify-center bg-[#1a1a1a]`,children:g?(0,Q.jsx)(`video`,{src:u[0],controls:!0,className:`max-h-full max-w-full object-contain`}):(0,Q.jsx)(Dn,{images:u,className:`w-full h-full bg-black`,aspectRatio:`max-h-full max-w-full`})}):(0,Q.jsx)(`div`,{className:`w-full h-full p-8 flex flex-col items-center justify-center bg-background`,children:(0,Q.jsx)(xn,{onFileSelect:A,multiple:!0})}),e[38]=g,e[39]=u,e[40]=W):W=e[40];let ee;e[41]!==U||e[42]!==W?(ee=(0,Q.jsx)(`div`,{className:U,children:W}),e[41]=U,e[42]=W,e[43]=ee):ee=e[43];let G;e[44]!==m||e[45]!==v||e[46]!==g||e[47]!==u.length||e[48]!==a?.avatar_url||e[49]!==a?.username?(G=u.length>0&&(0,Q.jsxs)(`div`,{className:`w-full md:w-[400px] flex flex-col bg-background`,children:[(0,Q.jsxs)(`div`,{className:`p-4 flex items-center gap-3`,children:[(0,Q.jsxs)(ut,{className:`w-10 h-10 border border-border`,children:[(0,Q.jsx)(dt,{src:a?.avatar_url||``}),(0,Q.jsx)(ft,{children:a?.username?.[0]?.toUpperCase()})]}),(0,Q.jsx)(`span`,{className:`font-semibold text-sm`,children:a?.username})]}),v===`story`?(0,Q.jsx)(`div`,{className:`flex-grow flex items-center justify-center p-8 text-center text-muted-foreground`,children:(0,Q.jsx)(`p`,{className:`text-sm`,children:`Stories are visible for 24 hours. Captions are not supported on stories yet.`})}):(0,Q.jsxs)(`div`,{className:`flex-grow flex flex-col overflow-y-auto`,children:[(0,Q.jsx)(`div`,{className:`px-4 pb-4`,children:(0,Q.jsx)(pn,{className:`w-full min-h-[120px] bg-transparent border-none focus-visible:ring-0 resize-none text-base p-1 placeholder:text-muted-foreground/50`,placeholder:`Write a caption...`,value:m,onChange:e=>h(e.target.value)})}),(0,Q.jsx)(`div`,{className:`h-px w-full bg-border`}),(0,Q.jsxs)(`div`,{className:`flex flex-col`,children:[(0,Q.jsxs)(`div`,{className:`px-4 py-3 flex items-center justify-between cursor-pointer hover:bg-accent/50 transition-colors border-b border-border/50`,children:[(0,Q.jsxs)(`div`,{className:`flex items-center gap-3 text-sm`,children:[(0,Q.jsx)(S,{size:20,className:`text-muted-foreground`}),(0,Q.jsx)(`span`,{children:`Tag People`})]}),(0,Q.jsx)(Pe,{size:16,className:`text-muted-foreground`})]}),(0,Q.jsxs)(`div`,{className:`px-4 py-3 flex items-center justify-between cursor-pointer hover:bg-accent/50 transition-colors border-b border-border/50`,children:[(0,Q.jsxs)(`div`,{className:`flex items-center gap-3 text-sm`,children:[(0,Q.jsx)(Me,{size:20,className:`text-muted-foreground`}),(0,Q.jsx)(`span`,{children:`Add Topics`})]}),(0,Q.jsx)(Pe,{size:16,className:`text-muted-foreground`})]})]})]}),(0,Q.jsx)(`div`,{className:`p-4 border-t border-border`,children:(0,Q.jsxs)(`div`,{className:`grid grid-cols-2 gap-2 bg-muted/50 p-1 rounded-lg`,children:[!g&&(0,Q.jsx)(`button`,{onClick:()=>y(`post`),className:Z(`text-sm font-semibold py-2 rounded-md transition-all`,v===`post`?`bg-background text-foreground shadow-sm`:`text-muted-foreground hover:text-foreground`),children:`Post`}),(0,Q.jsx)(`button`,{onClick:()=>y(g?`reel`:`story`),className:Z(`text-sm font-semibold py-2 rounded-md transition-all`,v===(g?`reel`:`story`)?`bg-background text-foreground shadow-sm`:`text-muted-foreground hover:text-foreground`),children:g?`Reel`:`Story`})]})})]}),e[44]=m,e[45]=v,e[46]=g,e[47]=u.length,e[48]=a?.avatar_url,e[49]=a?.username,e[50]=G):G=e[50];let te;e[51]!==ee||e[52]!==G?(te=(0,Q.jsxs)(`div`,{className:`flex-grow flex flex-col md:flex-row overflow-hidden`,children:[ee,G]}),e[51]=ee,e[52]=G,e[53]=te):te=e[53];let K;e[54]!==V||e[55]!==te?(K=(0,Q.jsxs)(vn,{className:`max-w-5xl h-[85vh] p-0 overflow-hidden flex flex-col gap-0 border-none sm:rounded-2xl`,children:[V,te]}),e[54]=V,e[55]=te,e[56]=K):K=e[56];let ne;return e[57]!==P||e[58]!==t||e[59]!==K?(ne=(0,Q.jsx)(hn,{open:t,onOpenChange:P,children:K}),e[57]=P,e[58]=t,e[59]=K,e[60]=ne):ne=e[60],ne};function Mn(e){return URL.createObjectURL(e)}var Nn=O();const Pn=()=>{let e=(0,Nn.c)(10),t=R(),{showToast:n,setCurrentUser:r,currentUser:i}=ot(),a;e[0]!==i||e[1]!==t||e[2]!==r||e[3]!==n?(a=e=>{n(`Profile updated`),r({...i,name:e?.full_name||``,bio:e?.bio||``,avatar:e?.avatar_url||``}),t.invalidateQueries({queryKey:[`profile`]}),e?.username&&t.invalidateQueries({queryKey:[`profile`,e.username]})},e[0]=i,e[1]=t,e[2]=r,e[3]=n,e[4]=a):a=e[4];let o;e[5]===n?o=e[6]:(o=e=>{console.error(`Update profile error:`,e),n(`Failed to update profile`)},e[5]=n,e[6]=o);let s;return e[7]!==a||e[8]!==o?(s={mutationFn:Fn,onSuccess:a,onError:o},e[7]=a,e[8]=o,e[9]=s):s=e[9],p(s)};async function Fn(e){let{userId:t,name:n,bio:r,avatar:i}=e,{data:a,error:o}=await $.from(`profiles`).update({full_name:n,bio:r,avatar_url:i}).eq(`id`,t).select().single();if(o)throw o;return a}var In=O();function Ln(e){let t=(0,In.c)(10),n,r,i;t[0]===e?(n=t[1],r=t[2],i=t[3]):({className:n,type:i,...r}=e,t[0]=e,t[1]=n,t[2]=r,t[3]=i);let a;t[4]===n?a=t[5]:(a=Z(`file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm`,`focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]`,`aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive`,n),t[4]=n,t[5]=a);let o;return t[6]!==r||t[7]!==a||t[8]!==i?(o=(0,Q.jsx)(`input`,{type:i,"data-slot":`input`,className:a,...r}),t[6]=r,t[7]=a,t[8]=i,t[9]=o):o=t[9],o}var Rn=O();function zn(e){let t=(0,Rn.c)(8),n,r;t[0]===e?(n=t[1],r=t[2]):({className:n,...r}=e,t[0]=e,t[1]=n,t[2]=r);let i;t[3]===n?i=t[4]:(i=Z(`flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50`,n),t[3]=n,t[4]=i);let a;return t[5]!==r||t[6]!==i?(a=(0,Q.jsx)(ae,{"data-slot":`label`,className:i,...r}),t[5]=r,t[6]=i,t[7]=a):a=t[7],a}var Bn=O(),Vn=je,Hn=X.createContext({}),Un=e=>{let t=(0,Bn.c)(9),n;t[0]===e?n=t[1]:({...n}=e,t[0]=e,t[1]=n);let r;t[2]===n.name?r=t[3]:(r={name:n.name},t[2]=n.name,t[3]=r);let i;t[4]===n?i=t[5]:(i=(0,Q.jsx)(W,{...n}),t[4]=n,t[5]=i);let a;return t[6]!==r||t[7]!==i?(a=(0,Q.jsx)(Hn.Provider,{value:r,children:i}),t[6]=r,t[7]=i,t[8]=a):a=t[8],a},Wn=()=>{let e=(0,Bn.c)(13),t=X.useContext(Hn),n=X.useContext(Gn),{getFieldState:r}=K(),i;e[0]===t.name?i=e[1]:(i={name:t.name},e[0]=t.name,e[1]=i);let a=Fe(i),o;e[2]!==t.name||e[3]!==a||e[4]!==r?(o=r(t.name,a),e[2]=t.name,e[3]=a,e[4]=r,e[5]=o):o=e[5];let s=o;if(!t)throw Error(`useFormField should be used within <FormField>`);let{id:c}=n,l=`${c}-form-item`,u=`${c}-form-item-description`,d=`${c}-form-item-message`,f;return e[6]!==t.name||e[7]!==s||e[8]!==c||e[9]!==l||e[10]!==u||e[11]!==d?(f={id:c,name:t.name,formItemId:l,formDescriptionId:u,formMessageId:d,...s},e[6]=t.name,e[7]=s,e[8]=c,e[9]=l,e[10]=u,e[11]=d,e[12]=f):f=e[12],f},Gn=X.createContext({});function Kn(e){let t=(0,Bn.c)(13),n,r;t[0]===e?(n=t[1],r=t[2]):({className:n,...r}=e,t[0]=e,t[1]=n,t[2]=r);let i=X.useId(),a;t[3]===i?a=t[4]:(a={id:i},t[3]=i,t[4]=a);let o;t[5]===n?o=t[6]:(o=Z(`grid gap-2`,n),t[5]=n,t[6]=o);let s;t[7]!==r||t[8]!==o?(s=(0,Q.jsx)(`div`,{"data-slot":`form-item`,className:o,...r}),t[7]=r,t[8]=o,t[9]=s):s=t[9];let c;return t[10]!==a||t[11]!==s?(c=(0,Q.jsx)(Gn.Provider,{value:a,children:s}),t[10]=a,t[11]=s,t[12]=c):c=t[12],c}function qn(e){let t=(0,Bn.c)(10),n,r;t[0]===e?(n=t[1],r=t[2]):({className:n,...r}=e,t[0]=e,t[1]=n,t[2]=r);let{error:i,formItemId:a}=Wn(),o=!!i,s;t[3]===n?s=t[4]:(s=Z(`data-[error=true]:text-destructive`,n),t[3]=n,t[4]=s);let c;return t[5]!==a||t[6]!==r||t[7]!==o||t[8]!==s?(c=(0,Q.jsx)(zn,{"data-slot":`form-label`,"data-error":o,className:s,htmlFor:a,...r}),t[5]=a,t[6]=r,t[7]=o,t[8]=s,t[9]=c):c=t[9],c}function Jn(e){let t=(0,Bn.c)(7),n;t[0]===e?n=t[1]:({...n}=e,t[0]=e,t[1]=n);let{error:r,formItemId:i,formDescriptionId:a,formMessageId:o}=Wn(),s=r?`${a} ${o}`:`${a}`,c=!!r,l;return t[2]!==i||t[3]!==n||t[4]!==s||t[5]!==c?(l=(0,Q.jsx)(b,{"data-slot":`form-control`,id:i,"aria-describedby":s,"aria-invalid":c,...n}),t[2]=i,t[3]=n,t[4]=s,t[5]=c,t[6]=l):l=t[6],l}function Yn(e){let t=(0,Bn.c)(10),n,r;t[0]===e?(n=t[1],r=t[2]):({className:n,...r}=e,t[0]=e,t[1]=n,t[2]=r);let{error:i,formMessageId:a}=Wn(),o=i?String(i?.message??``):r.children;if(!o)return null;let s;t[3]===n?s=t[4]:(s=Z(`text-destructive text-sm`,n),t[3]=n,t[4]=s);let c;return t[5]!==o||t[6]!==a||t[7]!==r||t[8]!==s?(c=(0,Q.jsx)(`p`,{"data-slot":`form-message`,id:a,className:s,...r,children:o}),t[5]=o,t[6]=a,t[7]=r,t[8]=s,t[9]=c):c=t[9],c}var Xn=O(),Zn=Ue({name:Ke().min(2,`Name must be at least 2 characters`).max(50),bio:Ke().max(160,`Bio must be less than 160 characters`).optional()}),Qn=()=>{let e=(0,Xn.c)(56),{currentUser:t,isEditProfileOpen:n,setEditProfileOpen:r}=ot(),{user:i}=ct(),{mutate:a,isPending:o}=Pn(),[s,c]=(0,X.useState)(t.avatar),l;e[0]===Symbol.for(`react.memo_cache_sentinel`)?(l=se(Zn),e[0]=l):l=e[0];let u=t.bio||``,d;e[1]!==t.name||e[2]!==u?(d={resolver:l,defaultValues:{name:t.name,bio:u}},e[1]=t.name,e[2]=u,e[3]=d):d=e[3];let f=Ie(d),p;e[4]===Symbol.for(`react.memo_cache_sentinel`)?(p=e=>{if(e.target.files&&e.target.files[0]){let t=new FileReader;t.onload=e=>c(e.target?.result),t.readAsDataURL(e.target.files[0])}},e[4]=p):p=e[4];let m=p,h;e[5]===r?h=e[6]:(h=()=>r(!1),e[5]=r,e[6]=h);let g=h,_;e[7]!==s||e[8]!==g||e[9]!==a||e[10]!==i?(_=e=>{i&&a({userId:i.id,name:e.name,bio:e.bio||``,avatar:s},{onSuccess:()=>{g()}})},e[7]=s,e[8]=g,e[9]=a,e[10]=i,e[11]=_):_=e[11];let v=_,y;e[12]===Symbol.for(`react.memo_cache_sentinel`)?(y=(0,Q.jsx)(yn,{className:`p-4 border-b`,children:(0,Q.jsx)(bn,{className:`text-center font-bold`,children:`Edit Profile`})}),e[12]=y):y=e[12];let b;e[13]===s?b=e[14]:(b=(0,Q.jsx)(dt,{src:s}),e[13]=s,e[14]=b);let x;e[15]===t.username?.[0]?x=e[16]:(x=t.username?.[0]?.toUpperCase()||`?`,e[15]=t.username?.[0],e[16]=x);let S;e[17]===x?S=e[18]:(S=(0,Q.jsx)(ft,{children:x}),e[17]=x,e[18]=S);let C;e[19]!==b||e[20]!==S?(C=(0,Q.jsxs)(ut,{className:`w-16 h-16`,children:[b,S]}),e[19]=b,e[20]=S,e[21]=C):C=e[21];let w;e[22]===t.username?w=e[23]:(w=(0,Q.jsx)(`div`,{className:`font-semibold text-lg`,children:t.username}),e[22]=t.username,e[23]=w);let T;e[24]===Symbol.for(`react.memo_cache_sentinel`)?(T=(0,Q.jsxs)(`label`,{className:`text-primary text-sm font-bold cursor-pointer hover:underline`,children:[`Change profile photo`,(0,Q.jsx)(`input`,{type:`file`,className:`hidden`,accept:`image/*`,onChange:m})]}),e[24]=T):T=e[24];let E;e[25]===w?E=e[26]:(E=(0,Q.jsxs)(`div`,{children:[w,T]}),e[25]=w,e[26]=E);let D;e[27]!==C||e[28]!==E?(D=(0,Q.jsxs)(`div`,{className:`flex items-center gap-4 p-4 rounded-lg bg-muted`,children:[C,E]}),e[27]=C,e[28]=E,e[29]=D):D=e[29];let O;e[30]!==f||e[31]!==v?(O=f.handleSubmit(v),e[30]=f,e[31]=v,e[32]=O):O=e[32];let k,A;e[33]===f.control?(k=e[34],A=e[35]):(k=(0,Q.jsx)(Un,{control:f.control,name:`name`,render:$n}),A=(0,Q.jsx)(Un,{control:f.control,name:`bio`,render:er}),e[33]=f.control,e[34]=k,e[35]=A);let j;e[36]===o?j=e[37]:(j=o?(0,Q.jsx)(ie,{className:`mr-2 h-4 w-4 animate-spin`}):`Save`,e[36]=o,e[37]=j);let M;e[38]!==o||e[39]!==j?(M=(0,Q.jsx)(ht,{type:`submit`,disabled:o,className:`w-full bg-[#006a4e] hover:bg-[#00523c] text-white font-bold`,children:j}),e[38]=o,e[39]=j,e[40]=M):M=e[40];let N;e[41]!==O||e[42]!==k||e[43]!==A||e[44]!==M?(N=(0,Q.jsxs)(`form`,{onSubmit:O,className:`space-y-4`,children:[k,A,M]}),e[41]=O,e[42]=k,e[43]=A,e[44]=M,e[45]=N):N=e[45];let P;e[46]!==f||e[47]!==N?(P=(0,Q.jsx)(Vn,{...f,children:N}),e[46]=f,e[47]=N,e[48]=P):P=e[48];let F;e[49]!==D||e[50]!==P?(F=(0,Q.jsxs)(vn,{className:`max-w-md p-0 overflow-hidden border-none sm:rounded-xl`,children:[y,(0,Q.jsxs)(`div`,{className:`p-6 flex flex-col gap-4 bg-background text-foreground`,children:[D,P]})]}),e[49]=D,e[50]=P,e[51]=F):F=e[51];let I;return e[52]!==n||e[53]!==r||e[54]!==F?(I=(0,Q.jsx)(hn,{open:n,onOpenChange:r,children:F}),e[52]=n,e[53]=r,e[54]=F,e[55]=I):I=e[55],I};function $n(e){let{field:t}=e;return(0,Q.jsxs)(Kn,{children:[(0,Q.jsx)(qn,{children:`Name`}),(0,Q.jsx)(Jn,{children:(0,Q.jsx)(Ln,{...t,className:`bg-transparent`})}),(0,Q.jsx)(Yn,{})]})}function er(e){let{field:t}=e;return(0,Q.jsxs)(Kn,{children:[(0,Q.jsx)(qn,{children:`Bio`}),(0,Q.jsx)(Jn,{children:(0,Q.jsx)(pn,{...t,className:`bg-transparent h-24 resize-none`})}),(0,Q.jsx)(Yn,{})]})}var tr=O(),nr=e=>{let t=(0,tr.c)(3),{className:n}=e,r=`inline-block ml-1 ${n}`,i;t[0]===Symbol.for(`react.memo_cache_sentinel`)?(i=(0,Q.jsxs)(`g`,{transform:`translate(1.4065934065934016 1.4065934065934016) scale(2.81 2.81)`,children:[(0,Q.jsx)(`path`,{d:`M 30.091 10.131 L 30.091 10.131 c 5.28 -13.046 23.695 -13.207 29.202 -0.255 l 0 0 l 0 0 c 12.959 -5.491 26.093 7.416 20.829 20.469 l 0 0 l 0 0 c 13.046 5.28 13.207 23.695 0.255 29.202 l 0 0 l 0 0 c 5.491 12.959 -7.416 26.093 -20.469 20.829 l 0 0 l 0 0 c -5.28 13.046 -23.695 13.207 -29.202 0.255 l 0 0 l 0 0 C 17.748 86.122 4.613 73.215 9.878 60.162 l 0 0 l 0 0 C -3.169 54.881 -3.33 36.467 9.623 30.96 l 0 0 l 0 0 C 4.131 18.001 17.038 4.866 30.091 10.131 L 30.091 10.131 z`,fill:`#0096F1`}),(0,Q.jsx)(`polygon`,{points:`39.66,63.79 23.36,47.76 28.97,42.05 39.3,52.21 59.6,29.58 65.56,34.93`,fill:`#FFFFFF`})]}),t[0]=i):i=t[0];let a;return t[1]===r?a=t[2]:(a=(0,Q.jsx)(`svg`,{width:`16`,height:`16`,viewBox:`0 0 256 256`,xmlns:`http://www.w3.org/2000/svg`,className:r,children:i}),t[1]=r,t[2]=a),a};Ge();var rr=O(),ir=e=>{let n=(0,rr.c)(43),{src:r,poster:i,className:a,videoClassName:o,autoPlay:s,controls:c,loop:l,muted:u,onEnded:d,onClick:f}=e,p=s===void 0?!0:s,m=c===void 0?!0:c,h=l===void 0?!0:l,g=u===void 0?!0:u,_=(0,X.useRef)(null),[y,b]=(0,X.useState)(!1),[x,S]=(0,X.useState)(g),[C,w]=(0,X.useState)(!1),T;n[0]===Symbol.for(`react.memo_cache_sentinel`)?(T={threshold:.6},n[0]=T):T=n[0];let{ref:E,inView:O}=pe(T),k;n[1]===E?k=n[2]:(k=e=>{_.current=e,E(e)},n[1]=E,n[2]=k);let A=k,j;n[3]!==p||n[4]!==O?(j=()=>{if(_.current)if(p&&O){let e=_.current.play();e!==void 0&&e.catch(ar)}else p&&!O&&_.current.pause()},n[3]=p,n[4]=O,n[5]=j):j=n[5];let M;n[6]!==p||n[7]!==O||n[8]!==r?(M=[O,p,r],n[6]=p,n[7]=O,n[8]=r,n[9]=M):M=n[9],(0,X.useEffect)(j,M);let N;n[10]===f?N=n[11]:(N=e=>{e?.stopPropagation(),_.current&&(_.current.paused?_.current.play():_.current.pause()),f&&f()},n[10]=f,n[11]=N);let P=N,F;n[12]===x?F=n[13]:(F=e=>{e.stopPropagation(),_.current&&(_.current.muted=!x,S(!x))},n[12]=x,n[13]=F);let I=F,L;n[14]===a?L=n[15]:(L=Z(`relative w-full h-full bg-black group`,a),n[14]=a,n[15]=L);let R=o||`object-cover`,z;n[16]===R?z=n[17]:(z=Z(`w-full h-full`,R),n[16]=R,n[17]=z);let B,V,H;n[18]===Symbol.for(`react.memo_cache_sentinel`)?(B=()=>w(!0),V=()=>b(!0),H=()=>b(!1),n[18]=B,n[19]=V,n[20]=H):(B=n[18],V=n[19],H=n[20]);let U;n[21]===d?U=n[22]:(U=()=>{d&&d()},n[21]=d,n[22]=U);let W;n[23]!==x||n[24]!==h||n[25]!==i||n[26]!==A||n[27]!==r||n[28]!==z||n[29]!==U||n[30]!==P?(W=(0,Q.jsx)(`video`,{ref:A,src:r,poster:i,className:z,loop:h,muted:x,playsInline:!0,onLoadedData:B,onPlay:V,onPause:H,onEnded:U,onClick:P}),n[23]=x,n[24]=h,n[25]=i,n[26]=A,n[27]=r,n[28]=z,n[29]=U,n[30]=P,n[31]=W):W=n[31];let ee;n[32]!==m||n[33]!==C||n[34]!==x||n[35]!==y||n[36]!==I||n[37]!==P?(ee=m&&(0,Q.jsxs)(Q.Fragment,{children:[!y&&C&&(0,Q.jsx)(`div`,{className:`absolute inset-0 flex items-center justify-center bg-black/20 cursor-pointer z-10`,onClick:P,children:(0,Q.jsx)(`div`,{className:`bg-black/50 p-4 rounded-full backdrop-blur-sm`,children:(0,Q.jsx)(t,{className:`w-8 h-8 text-white fill-white ml-1`})})}),(0,Q.jsx)(`button`,{onClick:I,className:`absolute bottom-4 right-4 z-20 bg-black/50 p-2 rounded-full text-white hover:bg-black/70 transition-colors backdrop-blur-sm`,children:x?(0,Q.jsx)(v,{size:20}):(0,Q.jsx)(D,{size:20})})]}),n[32]=m,n[33]=C,n[34]=x,n[35]=y,n[36]=I,n[37]=P,n[38]=ee):ee=n[38];let G;return n[39]!==L||n[40]!==W||n[41]!==ee?(G=(0,Q.jsxs)(`div`,{className:L,children:[W,ee]}),n[39]=L,n[40]=W,n[41]=ee,n[42]=G):G=n[42],G};function ar(e){console.log(`Autoplay blocked:`,e)}var or=O(),sr=e(qe(),1),cr=e(Be(),1);sr.default.extend(cr.default),sr.default.locale(`en`);var lr=()=>{let e=(0,or.c)(118),{viewingStory:t,setViewingStory:r,showToast:i}=ot(),{user:a}=ct(),o=n(),{data:s}=sn(a?.id),c;e[0]===s?c=e[1]:(c=s===void 0?[]:s,e[0]=s,e[1]=c);let l=c,u;e[2]===t?u=e[3]:(u=e=>e.id===t,e[2]=t,e[3]=u);let d=l.findIndex(u),[f,p]=(0,X.useState)(-1),[g,_]=(0,X.useState)(0),[v,b]=(0,X.useState)(!1);d!==-1&&f===-1&&p(d);let x=l[f],S;bb0:{if(!x){S=!1;break bb0}let t=x.img,n;if(e[4]!==t){let r;e[6]===Symbol.for(`react.memo_cache_sentinel`)?(r=/\.(mp4|webm|ogg|mov)$/i,e[6]=r):r=e[6],n=t.match(r),e[4]=t,e[5]=n}else n=e[5];S=n!==null}let C=S,w;e[7]!==f||e[8]!==r||e[9]!==l.length?(w=()=>{f<l.length-1?(p(ur),_(0),b(!1)):r(null)},e[7]=f,e[8]=r,e[9]=l.length,e[10]=w):w=e[10];let T=w,E;e[11]===f?E=e[12]:(E=()=>{f>0&&(p(dr),_(0),b(!1))},e[11]=f,e[12]=E);let D=E,O,k;if(e[13]!==f||e[14]!==T||e[15]!==C||e[16]!==t?(O=()=>{if(t===null||f===-1||C)return;let e=setInterval(()=>{_(e=>e>=100?(T(),0):e+1)},50);return()=>clearInterval(e)},k=[f,t,T,C],e[13]=f,e[14]=T,e[15]=C,e[16]=t,e[17]=O,e[18]=k):(O=e[17],k=e[18]),(0,X.useEffect)(O,k),t===null||f===-1||l.length===0||!x)return null;let A;e[19]===r?A=e[20]:(A=()=>r(null),e[19]=r,e[20]=A);let j=A,N,P,F;e[21]===Symbol.for(`react.memo_cache_sentinel`)?(F={opacity:0,scale:.9},N={opacity:1,scale:1},P={opacity:0,scale:.9},e[21]=N,e[22]=P,e[23]=F):(N=e[21],P=e[22],F=e[23]);let I;e[24]===Symbol.for(`react.memo_cache_sentinel`)?(I=(0,Q.jsx)(m,{size:32}),e[24]=I):I=e[24];let L;e[25]===j?L=e[26]:(L=(0,Q.jsx)(ht,{variant:`ghost`,size:`icon`,className:`absolute top-4 right-4 z-50 text-white hover:bg-white/10 hover:text-white`,onClick:j,children:I}),e[25]=j,e[26]=L);let R;if(e[27]!==f||e[28]!==C||e[29]!==v||e[30]!==g||e[31]!==l){let t;e[33]!==f||e[34]!==C||e[35]!==v||e[36]!==g?(t=(e,t)=>(0,Q.jsx)(`div`,{className:`h-1 bg-white/30 flex-1 rounded-full overflow-hidden`,children:(0,Q.jsx)(h.div,{className:`h-full bg-white origin-left`,initial:{scaleX:0},animate:{scaleX:t<f?1:t===f?C?v?1:0:g/100:0},transition:C&&t===f?{duration:15,ease:`linear`}:{type:`tween`,ease:`linear`}})},t),e[33]=f,e[34]=C,e[35]=v,e[36]=g,e[37]=t):t=e[37],R=l.map(t),e[27]=f,e[28]=C,e[29]=v,e[30]=g,e[31]=l,e[32]=R}else R=e[32];let B;e[38]===R?B=e[39]:(B=(0,Q.jsx)(`div`,{className:`absolute top-4 left-0 right-0 flex gap-1 px-2 z-20`,children:R}),e[38]=R,e[39]=B);let V;e[40]!==x.username||e[41]!==o||e[42]!==r?(V=e=>{e.stopPropagation(),r(null),o(`/profile/${x.username}`)},e[40]=x.username,e[41]=o,e[42]=r,e[43]=V):V=e[43];let H=x.userAvatar||x.img,U;e[44]===H?U=e[45]:(U=(0,Q.jsx)(dt,{src:H}),e[44]=H,e[45]=U);let W;e[46]===x.username?.[0]?W=e[47]:(W=x.username?.[0]?.toUpperCase()||`?`,e[46]=x.username?.[0],e[47]=W);let G;e[48]===W?G=e[49]:(G=(0,Q.jsx)(ft,{children:W}),e[48]=W,e[49]=G);let te;e[50]!==V||e[51]!==U||e[52]!==G?(te=(0,Q.jsxs)(ut,{className:`w-8 h-8 border border-white cursor-pointer`,onClick:V,children:[U,G]}),e[50]=V,e[51]=U,e[52]=G,e[53]=te):te=e[53];let K;e[54]!==x.username||e[55]!==o||e[56]!==r?(K=e=>{e.stopPropagation(),r(null),o(`/profile/${x.username}`)},e[54]=x.username,e[55]=o,e[56]=r,e[57]=K):K=e[57];let ne;e[58]!==x.username||e[59]!==K?(ne=(0,Q.jsx)(`span`,{className:`font-semibold text-sm cursor-pointer hover:underline`,onClick:K,children:x.username}),e[58]=x.username,e[59]=K,e[60]=ne):ne=e[60];let q;e[61]===x.isVerified?q=e[62]:(q=x.isVerified&&(0,Q.jsx)(nr,{}),e[61]=x.isVerified,e[62]=q);let J;e[63]!==ne||e[64]!==q?(J=(0,Q.jsxs)(`div`,{className:`flex items-center`,children:[ne,q]}),e[63]=ne,e[64]=q,e[65]=J):J=e[65];let Y;e[66]===x.createdAt?Y=e[67]:(Y=x.createdAt?(0,sr.default)(x.createdAt).fromNow(!0):``,e[66]=x.createdAt,e[67]=Y);let re;e[68]===Y?re=e[69]:(re=(0,Q.jsx)(`span`,{className:`text-white/70 text-xs`,children:Y}),e[68]=Y,e[69]=re);let ie;e[70]!==te||e[71]!==J||e[72]!==re?(ie=(0,Q.jsxs)(`div`,{className:`absolute top-8 left-4 flex items-center gap-3 z-20 text-white`,children:[te,J,re]}),e[70]=te,e[71]=J,e[72]=re,e[73]=ie):ie=e[73];let ae,oe,se;e[74]===Symbol.for(`react.memo_cache_sentinel`)?(ae={opacity:0,x:20},oe={opacity:1,x:0},se={opacity:0,x:-20},e[74]=ae,e[75]=oe,e[76]=se):(ae=e[74],oe=e[75],se=e[76]);let ce;e[77]!==x.img||e[78]!==T||e[79]!==C?(ce=C?(0,Q.jsx)(ir,{src:x.img,className:`max-h-full max-w-full`,autoPlay:!0,controls:!1,muted:!1,loop:!1,onEnded:T,onClick:fr}):(0,Q.jsx)(`img`,{src:x.img,className:`w-full h-full object-contain`,alt:`story`,loading:`lazy`}),e[77]=x.img,e[78]=T,e[79]=C,e[80]=ce):ce=e[80];let le;e[81]!==x.id||e[82]!==ce?(le=(0,Q.jsx)(y,{mode:`wait`,children:(0,Q.jsx)(h.div,{initial:ae,animate:oe,exit:se,className:`w-full h-full flex items-center justify-center`,children:ce},x.id)}),e[81]=x.id,e[82]=ce,e[83]=le):le=e[83];let ue;e[84]===D?ue=e[85]:(ue=(0,Q.jsx)(`div`,{className:`absolute inset-y-0 left-0 w-1/3 z-10`,onClick:D}),e[84]=D,e[85]=ue);let de;e[86]===T?de=e[87]:(de=(0,Q.jsx)(`div`,{className:`absolute inset-y-0 right-0 w-1/3 z-10`,onClick:T}),e[86]=T,e[87]=de);let fe;e[88]!==le||e[89]!==ue||e[90]!==de?(fe=(0,Q.jsxs)(`div`,{className:`flex-1 relative flex items-center justify-center bg-gray-900`,children:[le,ue,de]}),e[88]=le,e[89]=ue,e[90]=de,e[91]=fe):fe=e[91];let pe=`Reply to ${x.username}...`,me;e[92]===pe?me=e[93]:(me=(0,Q.jsx)(`div`,{className:`flex-1 relative`,children:(0,Q.jsx)(Ln,{type:`text`,placeholder:pe,className:`w-full bg-transparent border-white/50 rounded-full py-6 px-4 text-white text-sm placeholder:text-white/70 focus-visible:ring-0 focus-visible:border-white`})}),e[92]=pe,e[93]=me);let he;e[94]===i?he=e[95]:(he=(0,Q.jsx)(ee,{size:28,className:`text-white cursor-pointer hover:scale-110 transition-transform`,onClick:()=>i(`Liked story`)}),e[94]=i,e[95]=he);let ge;e[96]===Symbol.for(`react.memo_cache_sentinel`)?(ge=(0,Q.jsx)(z,{size:28,className:`text-white cursor-pointer hover:scale-110 transition-transform`}),e[96]=ge):ge=e[96];let _e;e[97]!==me||e[98]!==he?(_e=(0,Q.jsxs)(`div`,{className:`absolute bottom-0 w-full p-4 flex items-center gap-4 z-20 bg-gradient-to-t from-black/50 to-transparent`,children:[me,he,ge]}),e[97]=me,e[98]=he,e[99]=_e):_e=e[99];let ve;e[100]!==B||e[101]!==ie||e[102]!==fe||e[103]!==_e?(ve=(0,Q.jsxs)(`div`,{className:`relative w-full md:w-[400px] h-full md:h-[90vh] bg-black md:rounded-lg overflow-hidden flex flex-col`,children:[B,ie,fe,_e]}),e[100]=B,e[101]=ie,e[102]=fe,e[103]=_e,e[104]=ve):ve=e[104];let ye=f===0,be;e[105]===Symbol.for(`react.memo_cache_sentinel`)?(be=(0,Q.jsx)(M,{size:48}),e[105]=be):be=e[105];let xe;e[106]!==D||e[107]!==ye?(xe=(0,Q.jsx)(`button`,{className:`hidden md:block absolute left-4 text-white/50 hover:text-white`,onClick:D,disabled:ye,children:be}),e[106]=D,e[107]=ye,e[108]=xe):xe=e[108];let Se=f===l.length-1,Ce;e[109]===Symbol.for(`react.memo_cache_sentinel`)?(Ce=(0,Q.jsx)(Pe,{size:48}),e[109]=Ce):Ce=e[109];let we;e[110]!==T||e[111]!==Se?(we=(0,Q.jsx)(`button`,{className:`hidden md:block absolute right-4 text-white/50 hover:text-white`,onClick:T,disabled:Se,children:Ce}),e[110]=T,e[111]=Se,e[112]=we):we=e[112];let Te;return e[113]!==L||e[114]!==ve||e[115]!==xe||e[116]!==we?(Te=(0,Q.jsxs)(h.div,{initial:F,animate:N,exit:P,className:`fixed inset-0 z-[200] bg-black flex items-center justify-center`,children:[L,ve,xe,we]}),e[113]=L,e[114]=ve,e[115]=xe,e[116]=we,e[117]=Te):Te=e[117],Te};function ur(e){return e+1}function dr(e){return e-1}function fr(){}var pr=O();const mr=()=>{let e=(0,pr.c)(2),t=R(),n;return e[0]===t?n=e[1]:(n={mutationFn:hr,onMutate:async e=>{let{targetId:n,type:r,hasLiked:i}=e,a=r===`post`?Ft:Yt;await t.cancelQueries({queryKey:a});let o=t.getQueryData(a);return t.setQueryData(a,e=>{if(!e)return e;if(r===`post`&&typeof e==`object`&&e&&`pages`in e){let t=e;return{...t,pages:t.pages.map(e=>e.map(e=>{if(e.id===n){let t=Number(e.likes);return{...e,hasLiked:!i,likes:i?Math.max(0,t-1):t+1}}return e}))}}return r===`reel`&&Array.isArray(e)?e.map(e=>{if(e.id===n){let t=Number(e.likes);return{...e,hasLiked:!i,likes:i?Math.max(0,t-1):t+1}}return e}):e}),{previousData:o,queryKey:a}},onError:(e,n,r)=>{r?.previousData&&t.setQueryData(r.queryKey,r.previousData),console.error(e)},onSettled:(e,n,r)=>{let{type:i}=r,a=i===`post`?Ft:Yt;t.invalidateQueries({queryKey:a})}},e[0]=t,e[1]=n),p(n)};async function hr(e){let{targetId:t,type:n,userId:r,hasLiked:i}=e,a=n===`post`?{user_id:r,post_id:t}:{user_id:r,reel_id:t};if(i){let{error:e}=await $.from(`likes`).delete().match(a);if(e)throw e}else{let{error:e}=await $.from(`likes`).insert(a);if(e)throw e}}var gr=O(),_r=e(qe(),1);const vr=()=>{let e=(0,gr.c)(11),t=R(),{profile:n}=ct(),r;e[0]!==n?.avatar_url||e[1]!==n?.username||e[2]!==t?(r=async e=>{let{targetId:r,type:i,text:a,userId:o,audioBlob:s,parentId:c}=e,l=[`comments`,i,r],u=i===`post`?Ft:Yt;await t.cancelQueries({queryKey:l}),await t.cancelQueries({queryKey:u});let d=t.getQueryData(l),f=t.getQueryData(u),p={id:`temp-${(0,_r.default)().valueOf()}`,created_at:(0,_r.default)().toISOString(),text:a,user_id:o,post_id:i===`post`?r:void 0,reel_id:i===`reel`?r:void 0,audioUrl:s?URL.createObjectURL(s):void 0,parent_id:c,likes_count:0,hasLiked:!1,user:{username:n?.username||`You`,avatar_url:n?.avatar_url||``,isVerified:!1}};return t.setQueryData(l,e=>[p,...e===void 0?[]:e]),t.setQueryData(u,e=>{if(!e)return e;if(i===`post`&&e.pages){let t=e;return{...t,pages:t.pages.map(e=>e.map(e=>e.id===r?{...e,comments:Number(e.comments)+1}:e))}}return i===`reel`&&Array.isArray(e)?e.map(e=>e.id===r?{...e,comments:Number(e.comments)+1}:e):e}),{previousComments:d,previousFeed:f,commentsKey:l,feedKey:u}},e[0]=n?.avatar_url,e[1]=n?.username,e[2]=t,e[3]=r):r=e[3];let i,a;e[4]===t?(i=e[5],a=e[6]):(i=(e,n,r)=>{let i=r;i?.previousComments&&t.setQueryData(i.commentsKey,i.previousComments),i?.previousFeed&&t.setQueryData(i.feedKey,i.previousFeed)},a=(e,n)=>{let r=n.type===`post`?Ft:Yt;t.invalidateQueries({queryKey:r}),t.invalidateQueries({queryKey:[`comments`,n.type,n.targetId]})},e[4]=t,e[5]=i,e[6]=a);let o;return e[7]!==r||e[8]!==i||e[9]!==a?(o={mutationFn:yr,onMutate:r,onError:i,onSuccess:a},e[7]=r,e[8]=i,e[9]=a,e[10]=o):o=e[10],p(o)};async function yr(e){let{targetId:t,type:n,text:r,userId:i,audioBlob:a,parentId:o}=e,s=null;if(a){let e=`${i}/${Date.now()}.webm`,{error:t}=await $.storage.from(`audio-messages`).upload(e,a);if(t)throw t;let{data:n}=$.storage.from(`audio-messages`).getPublicUrl(e);s=n.publicUrl}let{data:c,error:l}=await $.from(`comments`).insert({user_id:i,post_id:n===`post`?t:null,reel_id:n===`reel`?t:null,text:r,audio_url:s,parent_id:o}).select(`
          *,
          user:profiles(username, avatar_url, is_verified)
        `).single();if(l)throw l;let u=c;return{id:u.id,created_at:u.created_at,text:u.text,user_id:u.user_id,post_id:u.post_id,reel_id:u.reel_id,parent_id:u.parent_id,likes_count:0,hasLiked:!1,audioUrl:u.audio_url,user:{username:u.user?.username,avatar_url:u.user?.avatar_url,isVerified:u.user?.is_verified}}}var br=O();const xr=()=>{let e=(0,br.c)(2),t=R(),n;return e[0]===t?n=e[1]:(n={mutationFn:Sr,onSuccess:()=>{t.invalidateQueries({queryKey:Ft}),t.invalidateQueries({queryKey:[`savedPosts`]})}},e[0]=t,e[1]=n),p(n)};async function Sr(e){let{postId:t,userId:n,hasSaved:r}=e;if(r){let{error:e}=await $.from(`saves`).delete().match({user_id:n,post_id:t});if(e)throw e}else{let{error:e}=await $.from(`saves`).insert({user_id:n,post_id:t});if(e)throw e}}var Cr=O();function wr(e){let t=(0,Cr.c)(12),n,r,i,a;t[0]===e?(n=t[1],r=t[2],i=t[3],a=t[4]):({className:n,orientation:i,decorative:a,...r}=e,t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=a);let o=i===void 0?`horizontal`:i,s=a===void 0?!0:a,c;t[5]===n?c=t[6]:(c=Z(`bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px`,n),t[5]=n,t[6]=c);let l;return t[7]!==s||t[8]!==o||t[9]!==r||t[10]!==c?(l=(0,Q.jsx)(J,{"data-slot":`separator`,decorative:s,orientation:o,className:c,...r}),t[7]=s,t[8]=o,t[9]=r,t[10]=c,t[11]=l):l=t[11],l}var Tr=O();function Er(e){let t=(0,Tr.c)(14),n,r,i;t[0]===e?(n=t[1],r=t[2],i=t[3]):({className:r,children:n,...i}=e,t[0]=e,t[1]=n,t[2]=r,t[3]=i);let a;t[4]===r?a=t[5]:(a=Z(`relative`,r),t[4]=r,t[5]=a);let o;t[6]===n?o=t[7]:(o=(0,Q.jsx)(ke,{"data-slot":`scroll-area-viewport`,className:`focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1`,children:n}),t[6]=n,t[7]=o);let s,c;t[8]===Symbol.for(`react.memo_cache_sentinel`)?(s=(0,Q.jsx)(Dr,{}),c=(0,Q.jsx)(_e,{}),t[8]=s,t[9]=c):(s=t[8],c=t[9]);let l;return t[10]!==i||t[11]!==a||t[12]!==o?(l=(0,Q.jsxs)(Te,{"data-slot":`scroll-area`,className:a,...i,children:[o,s,c]}),t[10]=i,t[11]=a,t[12]=o,t[13]=l):l=t[13],l}function Dr(e){let t=(0,Tr.c)(13),n,r,i;t[0]===e?(n=t[1],r=t[2],i=t[3]):({className:n,orientation:i,...r}=e,t[0]=e,t[1]=n,t[2]=r,t[3]=i);let a=i===void 0?`vertical`:i,o=a===`vertical`&&`h-full w-2.5 border-l border-l-transparent`,s=a===`horizontal`&&`h-2.5 flex-col border-t border-t-transparent`,c;t[4]!==n||t[5]!==o||t[6]!==s?(c=Z(`flex touch-none p-px transition-colors select-none`,o,s,n),t[4]=n,t[5]=o,t[6]=s,t[7]=c):c=t[7];let l;t[8]===Symbol.for(`react.memo_cache_sentinel`)?(l=(0,Q.jsx)(fe,{"data-slot":`scroll-area-thumb`,className:`bg-border relative flex-1 rounded-full`}),t[8]=l):l=t[8];let u;return t[9]!==a||t[10]!==r||t[11]!==c?(u=(0,Q.jsx)(q,{"data-slot":`scroll-area-scrollbar`,orientation:a,className:c,...r,children:l}),t[9]=a,t[10]=r,t[11]=c,t[12]=u):u=t[12],u}var Or=O(),kr=e=>{let n=(0,Or.c)(27),{onRecordingComplete:r,onCancel:i}=e,[a,o]=(0,X.useState)(!1),[s,c]=(0,X.useState)(0),[l,u]=(0,X.useState)(null),[d,p]=(0,X.useState)(!1),[m,g]=(0,X.useState)(0),_=(0,X.useRef)(null),v;n[0]===Symbol.for(`react.memo_cache_sentinel`)?(v=[],n[0]=v):v=n[0];let y=(0,X.useRef)(v),b=(0,X.useRef)(null),x=(0,X.useRef)(null),S;n[1]===Symbol.for(`react.memo_cache_sentinel`)?(S=()=>{b.current&&clearInterval(b.current),_.current&&_.current.stream.getTracks().forEach(Ar)},n[1]=S):S=n[1];let C=S,w;n[2]===i?w=n[3]:(w=async()=>{try{let e=await navigator.mediaDevices.getUserMedia({audio:!0}),t=new MediaRecorder(e);_.current=t,y.current=[],t.ondataavailable=e=>{e.data.size>0&&y.current.push(e.data)},t.onstop=()=>{u(new Blob(y.current,{type:`audio/webm`})),C()},t.start(),o(!0),b.current=setInterval(()=>{c(jr)},1e3)}catch(e){let t=e;console.error(`Error accessing microphone:`,t),i()}},n[2]=i,n[3]=w);let T=w,E,D;n[4]===T?(E=n[5],D=n[6]):(E=()=>{let e=setTimeout(()=>{T()},0);return()=>{clearTimeout(e),C()}},D=[T,C],n[4]=T,n[5]=E,n[6]=D),(0,X.useEffect)(E,D);let O;n[7]===a?O=n[8]:(O=()=>{_.current&&a&&(_.current.stop(),o(!1))},n[7]=a,n[8]=O);let k=O,A=Mr,j;n[9]!==l||n[10]!==d?(j=()=>{if(l){if(!x.current){let e=URL.createObjectURL(l);x.current=new Audio(e),x.current.onended=()=>p(!1),x.current.ontimeupdate=()=>{g(x.current?.currentTime||0)}}d?x.current.pause():x.current.play(),p(!d)}},n[9]=l,n[10]=d,n[11]=j):j=n[11];let M=j,N;n[12]!==l||n[13]!==r?(N=()=>{l&&r(l)},n[12]=l,n[13]=r,n[14]=N):N=n[14];let P=N,F,I,R;n[15]===Symbol.for(`react.memo_cache_sentinel`)?(R={opacity:0,y:10},F={opacity:1,y:0},I={opacity:0,y:10},n[15]=F,n[16]=I,n[17]=R):(F=n[15],I=n[16],R=n[17]);let B;return n[18]!==l||n[19]!==M||n[20]!==P||n[21]!==d||n[22]!==i||n[23]!==m||n[24]!==s||n[25]!==k?(B=(0,Q.jsx)(h.div,{initial:R,animate:F,exit:I,className:`flex items-center gap-2 w-full bg-zinc-100 dark:bg-zinc-800 p-2 rounded-full`,children:l?(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(ht,{size:`icon`,variant:`ghost`,className:`h-8 w-8 text-zinc-500 hover:text-red-500`,onClick:i,children:(0,Q.jsx)(f,{size:18})}),(0,Q.jsxs)(`div`,{className:`flex-1 flex items-center gap-2`,children:[(0,Q.jsx)(ht,{size:`icon`,variant:`ghost`,className:`h-8 w-8`,onClick:M,children:d?(0,Q.jsx)(Y,{size:18}):(0,Q.jsx)(t,{size:18})}),(0,Q.jsx)(`div`,{className:`h-1 flex-1 bg-zinc-300 dark:bg-zinc-700 rounded-full overflow-hidden`,children:(0,Q.jsx)(`div`,{className:`h-full bg-blue-500 transition-all duration-100`,style:{width:`${m/s*100}%`}})}),(0,Q.jsx)(`span`,{className:`text-xs font-mono text-zinc-500 w-10`,children:A(s)})]}),(0,Q.jsx)(ht,{size:`icon`,className:`h-8 w-8 bg-blue-500 hover:bg-blue-600 rounded-full`,onClick:P,children:(0,Q.jsx)(z,{size:16,className:`text-white`})})]}):(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsxs)(`div`,{className:`flex-1 flex items-center gap-2 px-3`,children:[(0,Q.jsx)(`div`,{className:`w-2 h-2 rounded-full bg-red-500 animate-pulse`}),(0,Q.jsx)(`span`,{className:`text-sm font-mono text-red-500`,children:A(s)}),(0,Q.jsx)(`span`,{className:`text-xs text-zinc-500`,children:`Recording...`})]}),(0,Q.jsx)(ht,{size:`icon`,variant:`ghost`,className:`h-8 w-8 text-red-500 hover:text-red-600 hover:bg-red-100 dark:hover:bg-red-900/20`,onClick:k,children:(0,Q.jsx)(L,{size:16,fill:`currentColor`})})]})}),n[18]=l,n[19]=M,n[20]=P,n[21]=d,n[22]=i,n[23]=m,n[24]=s,n[25]=k,n[26]=B):B=n[26],B};function Ar(e){return e.stop()}function jr(e){return e+1}function Mr(e){return`${Math.floor(e/60)}:${(e%60).toString().padStart(2,`0`)}`}var Nr=O();const Pr=(e,t)=>{let n=(0,Nr.c)(12),{user:r}=ct(),i=r?.id,a;n[0]!==i||n[1]!==e||n[2]!==t?(a=[`comments`,t,e,i],n[0]=i,n[1]=e,n[2]=t,n[3]=a):a=n[3];let o;n[4]!==e||n[5]!==t||n[6]!==r?(o=async()=>{let n=t===`post`?`post_id`:`reel_id`,{data:i,error:a}=await $.from(`comments`).select(`
          *,
          profiles:user_id (
            username,
            avatar_url,
            is_verified
          )
        `).eq(n,e).order(`created_at`,{ascending:!1});if(a)throw a;if(!i)return[];let o=i,s=new Set;if(r){let e=o.map(Fr);if(e.length>0){let{data:t}=await $.from(`comment_likes`).select(`comment_id`).eq(`user_id`,r.id).in(`comment_id`,e);t&&t.forEach(e=>s.add(e.comment_id))}}return o.map(e=>{let t=e.audio_url||void 0;return t&&t.includes(`/storage/v1/object/audio-messages/`)&&!t.includes(`/storage/v1/object/public/`)&&(t=t.replace(`/storage/v1/object/audio-messages/`,`/storage/v1/object/public/audio-messages/`)),{id:e.id,created_at:e.created_at,text:e.text,user_id:e.user_id,post_id:e.post_id||void 0,reel_id:e.reel_id||void 0,audioUrl:t,parent_id:e.parent_id,likes_count:e.likes_count||0,hasLiked:s.has(e.id),user:{username:e.profiles?.username||`Guest`,avatar_url:e.profiles?.avatar_url||`https://api.dicebear.com/9.x/avataaars/svg?seed=guest`,isVerified:e.profiles?.is_verified||!1}}})},n[4]=e,n[5]=t,n[6]=r,n[7]=o):o=n[7];let s=!!e,c;return n[8]!==a||n[9]!==o||n[10]!==s?(c={queryKey:a,queryFn:o,enabled:s},n[8]=a,n[9]=o,n[10]=s,n[11]=c):c=n[11],P(c)};function Fr(e){return e.id}var Ir=O();const Lr=()=>{let e=(0,Ir.c)(12),t=R(),{user:n}=ct(),r;e[0]===n?r=e[1]:(r=async e=>{let{commentId:t,hasLiked:r}=e;if(!n)throw Error(`Not authenticated`);if(r){let{error:e}=await $.from(`comment_likes`).delete().match({user_id:n.id,comment_id:t});if(e)throw e}else{let{error:e}=await $.from(`comment_likes`).insert({user_id:n.id,comment_id:t});if(e)throw e}},e[0]=n,e[1]=r);let i,a,o;e[2]!==t||e[3]!==n?.id?(i=async e=>{let{commentId:r,hasLiked:i,targetId:a,type:o}=e;await t.cancelQueries({queryKey:[`comments`,o,a,n?.id]});let s=t.getQueryData([`comments`,o,a,n?.id]);return t.setQueryData([`comments`,o,a,n?.id],e=>e&&e.map(e=>e.id===r?{...e,hasLiked:!i,likes_count:i?e.likes_count-1:e.likes_count+1}:e)),{previousComments:s}},a=(e,r,i)=>{i?.previousComments&&t.setQueryData([`comments`,r.type,r.targetId,n?.id],i.previousComments)},o=(e,r,i)=>{t.invalidateQueries({queryKey:[`comments`,i.type,i.targetId,n?.id]})},e[2]=t,e[3]=n?.id,e[4]=i,e[5]=a,e[6]=o):(i=e[4],a=e[5],o=e[6]);let s;return e[7]!==r||e[8]!==i||e[9]!==a||e[10]!==o?(s={mutationFn:r,onMutate:i,onError:a,onSettled:o},e[7]=r,e[8]=i,e[9]=a,e[10]=o,e[11]=s):s=e[11],p(s)};var Rr=O(),zr=e=>{let n=(0,Rr.c)(13),{src:r}=e,[i,a]=(0,X.useState)(!1),o=X.useRef(null),[s,c]=(0,X.useState)(0),l;n[0]!==i||n[1]!==r?(l=()=>{o.current||(o.current=new Audio(r),o.current.onended=()=>{a(!1),c(0)},o.current.ontimeupdate=()=>{o.current&&c(o.current.currentTime/o.current.duration*100||0)}),i?o.current.pause():o.current.play(),a(!i)},n[0]=i,n[1]=r,n[2]=l):l=n[2];let u=l,d;n[3]===i?d=n[4]:(d=i?(0,Q.jsx)(Y,{size:14}):(0,Q.jsx)(t,{size:14}),n[3]=i,n[4]=d);let f;n[5]!==d||n[6]!==u?(f=(0,Q.jsx)(ht,{variant:`ghost`,size:`icon`,className:`h-6 w-6 shrink-0`,onClick:u,children:d}),n[5]=d,n[6]=u,n[7]=f):f=n[7];let p=`${s}%`,m;n[8]===p?m=n[9]:(m=(0,Q.jsx)(`div`,{className:`h-1 flex-grow bg-secondary rounded-full overflow-hidden`,children:(0,Q.jsx)(`div`,{className:`h-full bg-primary rounded-full transition-all duration-100`,style:{width:p}})}),n[8]=p,n[9]=m);let h;return n[10]!==f||n[11]!==m?(h=(0,Q.jsxs)(`div`,{className:`flex items-center gap-2 bg-muted rounded-full px-3 py-1 mt-1 w-fit min-w-[150px]`,children:[f,m]}),n[10]=f,n[11]=m,n[12]=h):h=n[12],h},Br=O(),Vr=e(qe(),1);const Hr=e=>{let t=(0,Br.c)(77),{comment:n,replies:r,depth:i,onReply:a,targetId:o,type:s}=e,c=i===void 0?0:i,{showToast:l}=ot(),{user:u}=ct(),{mutate:d}=Lr(),[f,p]=(0,X.useState)(!1),m=c>0,h;t[0]!==n.hasLiked||t[1]!==n.id||t[2]!==l||t[3]!==o||t[4]!==d||t[5]!==s||t[6]!==u?(h=()=>{if(!u){l(`Log in to like comments`);return}d({commentId:n.id,hasLiked:n.hasLiked,targetId:o,type:s})},t[0]=n.hasLiked,t[1]=n.id,t[2]=l,t[3]=o,t[4]=d,t[5]=s,t[6]=u,t[7]=h):h=t[7];let g=h,_=m&&`ml-8 md:ml-12`,v;t[8]===_?v=t[9]:(v=Z(`flex gap-3 mb-4`,_),t[8]=_,t[9]=v);let y;t[10]===n.user.avatar_url?y=t[11]:(y=(0,Q.jsx)(dt,{src:n.user.avatar_url}),t[10]=n.user.avatar_url,t[11]=y);let b;t[12]===n.user.username[0]?b=t[13]:(b=n.user.username[0]?.toUpperCase(),t[12]=n.user.username[0],t[13]=b);let x;t[14]===b?x=t[15]:(x=(0,Q.jsx)(ft,{children:b}),t[14]=b,t[15]=x);let S;t[16]!==y||t[17]!==x?(S=(0,Q.jsxs)(ut,{className:`w-8 h-8 shrink-0`,children:[y,x]}),t[16]=y,t[17]=x,t[18]=S):S=t[18];let C;t[19]===n.user.username?C=t[20]:(C=(0,Q.jsx)(`span`,{className:`font-semibold text-sm`,children:n.user.username}),t[19]=n.user.username,t[20]=C);let w;t[21]===n.user.isVerified?w=t[22]:(w=n.user.isVerified&&(0,Q.jsx)(nr,{}),t[21]=n.user.isVerified,t[22]=w);let T;t[23]===n.created_at?T=t[24]:(T=(0,Vr.default)(n.created_at).fromNow(!0),t[23]=n.created_at,t[24]=T);let E;t[25]===T?E=t[26]:(E=(0,Q.jsx)(`span`,{className:`text-xs text-muted-foreground ml-1`,children:T}),t[25]=T,t[26]=E);let D;t[27]!==w||t[28]!==E||t[29]!==C?(D=(0,Q.jsxs)(`div`,{className:`flex items-center gap-1`,children:[C,w,E]}),t[27]=w,t[28]=E,t[29]=C,t[30]=D):D=t[30];let O;t[31]!==n.audioUrl||t[32]!==n.text?(O=n.audioUrl?(0,Q.jsx)(`div`,{className:`mt-1`,children:(0,Q.jsx)(zr,{src:n.audioUrl})}):(0,Q.jsx)(`p`,{className:`text-sm dark:text-gray-200 leading-normal whitespace-pre-wrap break-words`,children:n.text}),t[31]=n.audioUrl,t[32]=n.text,t[33]=O):O=t[33];let k;t[34]!==n||t[35]!==a?(k=(0,Q.jsx)(`button`,{onClick:()=>a(n),className:`text-xs font-semibold text-muted-foreground hover:text-foreground transition-colors`,children:`Reply`}),t[34]=n,t[35]=a,t[36]=k):k=t[36];let A;t[37]!==r.length||t[38]!==f?(A=r.length>0&&(0,Q.jsxs)(`button`,{onClick:()=>p(!f),className:`text-xs font-semibold text-muted-foreground hover:text-foreground transition-colors flex items-center gap-1`,children:[(0,Q.jsx)(`div`,{className:`w-6 h-[1px] bg-muted-foreground`}),f?`Hide replies`:`View ${r.length} replies`]}),t[37]=r.length,t[38]=f,t[39]=A):A=t[39];let j;t[40]!==k||t[41]!==A?(j=(0,Q.jsxs)(`div`,{className:`flex items-center gap-4 mt-1`,children:[k,A]}),t[40]=k,t[41]=A,t[42]=j):j=t[42];let M;t[43]!==D||t[44]!==O||t[45]!==j?(M=(0,Q.jsxs)(`div`,{className:`flex flex-col`,children:[D,O,j]}),t[43]=D,t[44]=O,t[45]=j,t[46]=M):M=t[46];let N;t[47]!==c||t[48]!==a||t[49]!==r||t[50]!==f||t[51]!==o||t[52]!==s?(N=f&&r.length>0&&(0,Q.jsx)(`div`,{className:`mt-4`,children:r.map(e=>(0,Q.jsx)(Hr,{comment:e,replies:e.replies||[],depth:c+1,onReply:a,targetId:o,type:s},e.id))}),t[47]=c,t[48]=a,t[49]=r,t[50]=f,t[51]=o,t[52]=s,t[53]=N):N=t[53];let P;t[54]!==M||t[55]!==N?(P=(0,Q.jsxs)(`div`,{className:`flex-1 min-w-0`,children:[M,N]}),t[54]=M,t[55]=N,t[56]=P):P=t[56];let F=n.hasLiked?`text-red-500`:`text-muted-foreground hover:text-muted-foreground/80`,I;t[57]===F?I=t[58]:(I=Z(`transition-colors`,F),t[57]=F,t[58]=I);let L=n.hasLiked&&`fill-current`,R;t[59]===L?R=t[60]:(R=Z(`w-3 h-3`,L),t[59]=L,t[60]=R);let z;t[61]===R?z=t[62]:(z=(0,Q.jsx)(ee,{className:R}),t[61]=R,t[62]=z);let B;t[63]!==g||t[64]!==I||t[65]!==z?(B=(0,Q.jsx)(`button`,{onClick:g,className:I,children:z}),t[63]=g,t[64]=I,t[65]=z,t[66]=B):B=t[66];let V;t[67]===n.likes_count?V=t[68]:(V=n.likes_count>0&&(0,Q.jsx)(`span`,{className:`text-[10px] text-muted-foreground`,children:n.likes_count}),t[67]=n.likes_count,t[68]=V);let H;t[69]!==B||t[70]!==V?(H=(0,Q.jsxs)(`div`,{className:`flex flex-col items-center gap-0.5 pt-1`,children:[B,V]}),t[69]=B,t[70]=V,t[71]=H):H=t[71];let U;return t[72]!==P||t[73]!==H||t[74]!==v||t[75]!==S?(U=(0,Q.jsxs)(`div`,{className:v,children:[S,P,H]}),t[72]=P,t[73]=H,t[74]=v,t[75]=S,t[76]=U):U=t[76],U};var Ur=O();const Wr=e=>{let t=(0,Ur.c)(12),{targetId:n,type:r,onReply:i}=e,{data:a,isLoading:o}=Pr(n,r),s;t[0]===a?s=t[1]:(s=a===void 0?[]:a,t[0]=a,t[1]=s);let c=s,l;bb0:{if(!c){let e;t[2]===Symbol.for(`react.memo_cache_sentinel`)?(e=[],t[2]=e):e=t[2],l=e;break bb0}let e;if(t[3]!==c){let n=new Map;e=[],c.forEach(e=>{n.set(e.id,{...e,replies:[]})}),c.forEach(t=>{let r=n.get(t.id);t.parent_id&&n.has(t.parent_id)?n.get(t.parent_id).replies.push(r):e.push(r)}),t[3]=c,t[4]=e}else e=t[4];l=e}let u=l;if(o){let e;return t[5]===Symbol.for(`react.memo_cache_sentinel`)?(e=(0,Q.jsx)(`div`,{className:`p-4 space-y-4`,children:[1,2,3].map(Gr)}),t[5]=e):e=t[5],e}if(c.length===0){let e;return t[6]===Symbol.for(`react.memo_cache_sentinel`)?(e=(0,Q.jsxs)(`div`,{className:`flex flex-col items-center justify-center py-12 text-center`,children:[(0,Q.jsx)(`div`,{className:`text-2xl mb-2`,children:``}),(0,Q.jsx)(`h3`,{className:`font-semibold text-lg`,children:`No comments yet.`}),(0,Q.jsx)(`p`,{className:`text-muted-foreground text-sm`,children:`Start the conversation.`})]}),t[6]=e):e=t[6],e}let d;return t[7]!==i||t[8]!==u||t[9]!==n||t[10]!==r?(d=(0,Q.jsx)(`div`,{className:`p-4 pb-20 md:pb-4`,children:u.map(e=>(0,Q.jsx)(Hr,{comment:e,replies:e.replies||[],onReply:i,targetId:n,type:r},e.id))}),t[7]=i,t[8]=u,t[9]=n,t[10]=r,t[11]=d):d=t[11],d};function Gr(e){return(0,Q.jsxs)(`div`,{className:`flex gap-3`,children:[(0,Q.jsx)(Cn,{className:`w-8 h-8 rounded-full`}),(0,Q.jsxs)(`div`,{className:`flex-1 space-y-2`,children:[(0,Q.jsx)(Cn,{className:`h-4 w-32`}),(0,Q.jsx)(Cn,{className:`h-3 w-full`})]})]},e)}var Kr=O(),qr=e(qe(),1),Jr=e(Be(),1);Ge(),qr.default.extend(Jr.default),qr.default.locale(`en`);var Yr=()=>{let e=(0,Kr.c)(184),{viewingPost:t,viewingReel:r,showToast:i,savedPostIds:a,setViewingPost:o,setViewingReel:s}=ot(),{mutate:c}=xr(),l=n(),{user:u}=ct(),{mutate:d}=mr(),{mutate:f,isPending:p}=vr(),[h,g]=(0,X.useState)(``),[_,v]=(0,X.useState)(!1),[y,b]=(0,X.useState)(!1),[x,S]=(0,X.useState)(null),C=X.useRef(null),w=X.useRef(null),T=t||r,E,D;e[0]===Symbol.for(`react.memo_cache_sentinel`)?(E=()=>{let e=e=>{C.current&&!C.current.contains(e.target)&&v(!1)};return document.addEventListener(`mousedown`,e),()=>document.removeEventListener(`mousedown`,e)},D=[],e[0]=E,e[1]=D):(E=e[0],D=e[1]),X.useEffect(E,D);let O;e[2]===Symbol.for(`react.memo_cache_sentinel`)?(O=e=>{g(t=>t+e.emoji)},e[2]=O):O=e[2];let k=O,A=!!r,j=A?`reel`:`post`,M=T?String(T.id):``,N;bb0:{if(!T){let t;e[3]===Symbol.for(`react.memo_cache_sentinel`)?(t=[],e[3]=t):t=e[3],N=t;break bb0}if(A){let t=T,n;e[4]===t.src?n=e[5]:(n=[t.src],e[4]=t.src,e[5]=n),N=n;break bb0}let t=T,n=t.content?.src;if(!n){let n=t.content?.poster||``,r;e[6]===n?r=e[7]:(r=[n],e[6]=n,e[7]=r),N=r;break bb0}try{if(n.startsWith(`[`)){let t;e[8]===n?t=e[9]:(t=JSON.parse(n),e[8]=n,e[9]=t),N=t;break bb0}let t;e[10]===n?t=e[11]:(t=[n],e[10]=n,e[11]=t),N=t}catch{let t;e[12]===n?t=e[13]:(t=[n],e[12]=n,e[13]=t),N=t}}let P=N;if(!T)return null;let F;e[14]!==T.id||e[15]!==a?(F=a.has(T.id),e[14]=T.id,e[15]=a,e[16]=F):F=e[16];let I=F,L=T.hasLiked||!1,R;e[17]!==T.id||e[18]!==L||e[19]!==i||e[20]!==d||e[21]!==j||e[22]!==u?(R=()=>{if(!u){i(`Log in to like`);return}d({targetId:String(T.id),type:j,userId:u.id,hasLiked:L})},e[17]=T.id,e[18]=L,e[19]=i,e[20]=d,e[21]=j,e[22]=u,e[23]=R):R=e[23];let B=R,V;e[24]===Symbol.for(`react.memo_cache_sentinel`)?(V=e=>{S(e),w.current?.focus()},e[24]=V):V=e[24];let H=V,U;e[25]!==T.id||e[26]!==f||e[27]!==h||e[28]!==x?.id||e[29]!==i||e[30]!==j||e[31]!==u?(U=(e,t)=>{if(e&&e.preventDefault(),!u){i(`Log in to comment`);return}!t&&!h.trim()||f({targetId:String(T.id),type:j,text:t?`Voice Message`:h,userId:u.id,audioBlob:t,parentId:x?.id},{onSuccess:()=>{i(`Comment added`),g(``),b(!1),S(null)},onError:()=>i(`Failed to add comment`)})},e[25]=T.id,e[26]=f,e[27]=h,e[28]=x?.id,e[29]=i,e[30]=j,e[31]=u,e[32]=U):U=e[32];let W=U,G;e[33]!==o||e[34]!==s||e[35]!==t||e[36]!==r?(G=()=>{t&&o(null),r&&s(null),S(null)},e[33]=o,e[34]=s,e[35]=t,e[36]=r,e[37]=G):G=e[37];let te=G,K;e[38]!==l||e[39]!==te?(K=e=>{te(),l(`/profile/${e.username}`)},e[38]=l,e[39]=te,e[40]=K):K=e[40];let q=K,J;e[41]===te?J=e[42]:(J=e=>!e&&te(),e[41]=te,e[42]=J);let Y;e[43]===T.user.username?Y=e[44]:(Y=(0,Q.jsxs)(bn,{className:`sr-only`,children:[`Post by `,T.user.username]}),e[43]=T.user.username,e[44]=Y);let ae;e[45]!==T||e[46]!==A||e[47]!==P?(ae=(0,Q.jsx)(`div`,{className:`hidden md:flex flex-1 bg-black items-center justify-center h-full border-r border-border relative group`,children:A||T.content.type===`video`?(0,Q.jsx)(ir,{src:P[0],poster:T.content?.poster,className:`max-h-full max-w-full`,videoClassName:`object-contain`,autoPlay:!0,controls:!0}):(0,Q.jsx)(Dn,{images:P,className:`w-full h-full bg-black`,imageClassName:`object-contain`,aspectRatio:`max-h-full max-w-full`})}),e[45]=T,e[46]=A,e[47]=P,e[48]=ae):ae=e[48];let oe;e[49]===Symbol.for(`react.memo_cache_sentinel`)?(oe=(0,Q.jsx)(`div`,{className:`md:hidden w-full text-center font-bold text-sm`,children:`Comments`}),e[49]=oe):oe=e[49];let se;e[50]!==T.user||e[51]!==q?(se=()=>q(T.user),e[50]=T.user,e[51]=q,e[52]=se):se=e[52];let ce;e[53]===T.user.avatar?ce=e[54]:(ce=(0,Q.jsx)(dt,{src:T.user.avatar}),e[53]=T.user.avatar,e[54]=ce);let le;e[55]===T.user.username[0]?le=e[56]:(le=T.user.username?.[0]?.toUpperCase()||`?`,e[55]=T.user.username[0],e[56]=le);let de;e[57]===le?de=e[58]:(de=(0,Q.jsx)(ft,{children:le}),e[57]=le,e[58]=de);let fe;e[59]!==ce||e[60]!==de?(fe=(0,Q.jsxs)(ut,{className:`w-8 h-8 border border-border`,children:[ce,de]}),e[59]=ce,e[60]=de,e[61]=fe):fe=e[61];let pe;e[62]===T.user.username?pe=e[63]:(pe=(0,Q.jsx)(`span`,{className:`font-semibold text-sm hover:opacity-70`,children:T.user.username}),e[62]=T.user.username,e[63]=pe);let me;e[64]===T.user.isVerified?me=e[65]:(me=T.user.isVerified&&(0,Q.jsx)(nr,{}),e[64]=T.user.isVerified,e[65]=me);let he;e[66]!==pe||e[67]!==me?(he=(0,Q.jsxs)(`div`,{className:`flex items-center`,children:[pe,me]}),e[66]=pe,e[67]=me,e[68]=he):he=e[68];let ge;e[69]!==se||e[70]!==fe||e[71]!==he?(ge=(0,Q.jsxs)(`div`,{className:`hidden md:flex items-center gap-3 cursor-pointer`,onClick:se,children:[fe,he]}),e[69]=se,e[70]=fe,e[71]=he,e[72]=ge):ge=e[72];let _e;e[73]===Symbol.for(`react.memo_cache_sentinel`)?(_e=(0,Q.jsx)(ne,{size:20,className:`hidden md:block cursor-pointer hover:opacity-70`}),e[73]=_e):_e=e[73];let be;e[74]===ge?be=e[75]:(be=(0,Q.jsxs)(`div`,{className:`p-4 flex items-center justify-between shrink-0`,children:[oe,ge,_e]}),e[74]=ge,e[75]=be);let Se;e[76]===Symbol.for(`react.memo_cache_sentinel`)?(Se=(0,Q.jsx)(wr,{}),e[76]=Se):Se=e[76];let Ce;e[77]!==T.user||e[78]!==q?(Ce=()=>q(T.user),e[77]=T.user,e[78]=q,e[79]=Ce):Ce=e[79];let we;e[80]===T.user.avatar?we=e[81]:(we=(0,Q.jsx)(dt,{src:T.user.avatar}),e[80]=T.user.avatar,e[81]=we);let Te;e[82]===T.user.username[0]?Te=e[83]:(Te=T.user.username[0].toUpperCase(),e[82]=T.user.username[0],e[83]=Te);let De;e[84]===Te?De=e[85]:(De=(0,Q.jsx)(ft,{children:Te}),e[84]=Te,e[85]=De);let Oe;e[86]!==Ce||e[87]!==we||e[88]!==De?(Oe=(0,Q.jsxs)(ut,{className:`w-8 h-8 cursor-pointer flex-shrink-0`,onClick:Ce,children:[we,De]}),e[86]=Ce,e[87]=we,e[88]=De,e[89]=Oe):Oe=e[89];let ke;e[90]!==T.user||e[91]!==q?(ke=()=>q(T.user),e[90]=T.user,e[91]=q,e[92]=ke):ke=e[92];let Ae;e[93]!==T.user.username||e[94]!==ke?(Ae=(0,Q.jsx)(`span`,{className:`font-semibold mr-2 cursor-pointer`,onClick:ke,children:T.user.username}),e[93]=T.user.username,e[94]=ke,e[95]=Ae):Ae=e[95];let je;e[96]===T.user.isVerified?je=e[97]:(je=T.user.isVerified&&(0,Q.jsx)(nr,{}),e[96]=T.user.isVerified,e[97]=je);let Me;e[98]!==Ae||e[99]!==je?(Me=(0,Q.jsxs)(`div`,{className:`flex items-center`,children:[Ae,je]}),e[98]=Ae,e[99]=je,e[100]=Me):Me=e[100];let Ne;e[101]===T.caption?Ne=e[102]:(Ne=(0,Q.jsx)(`span`,{className:`whitespace-pre-wrap`,children:T.caption}),e[101]=T.caption,e[102]=Ne);let Pe;e[103]===T?Pe=e[104]:(Pe=`createdAt`in T&&T.createdAt?(0,qr.default)(T.createdAt).fromNow():`time`in T?T.time:``,e[103]=T,e[104]=Pe);let Fe;e[105]===Pe?Fe=e[106]:(Fe=(0,Q.jsx)(`div`,{className:`text-xs text-muted-foreground mt-1`,children:Pe}),e[105]=Pe,e[106]=Fe);let Ie;e[107]!==Me||e[108]!==Ne||e[109]!==Fe?(Ie=(0,Q.jsxs)(`div`,{className:`text-sm`,children:[Me,Ne,Fe]}),e[107]=Me,e[108]=Ne,e[109]=Fe,e[110]=Ie):Ie=e[110];let Le;e[111]!==Oe||e[112]!==Ie?(Le=(0,Q.jsxs)(`div`,{className:`flex gap-3`,children:[Oe,Ie]}),e[111]=Oe,e[112]=Ie,e[113]=Le):Le=e[113];let Re;e[114]!==M||e[115]!==j?(Re=(0,Q.jsx)(Wr,{targetId:M,type:j,onReply:H}),e[114]=M,e[115]=j,e[116]=Re):Re=e[116];let ze;e[117]!==Le||e[118]!==Re?(ze=(0,Q.jsx)(`div`,{className:`flex-1 min-h-0 overflow-hidden`,children:(0,Q.jsx)(Er,{className:`h-full w-full`,children:(0,Q.jsxs)(`div`,{className:`p-4 space-y-4`,children:[Le,Re]})})}),e[117]=Le,e[118]=Re,e[119]=ze):ze=e[119];let Be;e[120]===Symbol.for(`react.memo_cache_sentinel`)?(Be=(0,Q.jsx)(wr,{}),e[120]=Be):Be=e[120];let Ve;e[121]===_?Ve=e[122]:(Ve=_&&(0,Q.jsx)(`div`,{ref:C,className:`absolute bottom-full left-0 z-50 shadow-2xl mb-2`,children:(0,Q.jsx)(ye,{theme:document.documentElement.classList.contains(`dark`)?re.DARK:re.LIGHT,onEmojiClick:k,lazyLoadEmojis:!0,skinTonesDisabled:!0,searchDisabled:!1,width:300,height:400})}),e[121]=_,e[122]=Ve);let He=`cursor-pointer hover:opacity-70 transition-transform active:scale-90 ${L?`fill-[#f42a41] text-[#f42a41]`:``}`,Ue;e[123]!==B||e[124]!==He?(Ue=(0,Q.jsx)(ee,{size:24,className:He,onClick:B}),e[123]=B,e[124]=He,e[125]=Ue):Ue=e[125];let We;e[126]===Symbol.for(`react.memo_cache_sentinel`)?(We=(0,Q.jsx)(Ee,{size:24,className:`-scale-x-100 cursor-pointer hover:opacity-70`,onClick:()=>w.current?.focus()}),e[126]=We):We=e[126];let Ge;e[127]===i?Ge=e[128]:(Ge=(0,Q.jsx)(z,{size:24,className:`cursor-pointer hover:opacity-70`,onClick:()=>i(`Shared`)}),e[127]=i,e[128]=Ge);let Ke;e[129]!==Ue||e[130]!==Ge?(Ke=(0,Q.jsxs)(`div`,{className:`flex items-center gap-4`,children:[Ue,We,Ge]}),e[129]=Ue,e[130]=Ge,e[131]=Ke):Ke=e[131];let qe=`cursor-pointer hover:opacity-70 ${I?`fill-current`:``}`,Je;e[132]!==T||e[133]!==I||e[134]!==c||e[135]!==u?(Je=()=>{u&&T&&c({postId:String(T.id),userId:u.id,hasSaved:I})},e[132]=T,e[133]=I,e[134]=c,e[135]=u,e[136]=Je):Je=e[136];let Ye;e[137]!==qe||e[138]!==Je?(Ye=(0,Q.jsx)(ue,{size:24,className:qe,onClick:Je}),e[137]=qe,e[138]=Je,e[139]=Ye):Ye=e[139];let Xe;e[140]!==Ke||e[141]!==Ye?(Xe=(0,Q.jsxs)(`div`,{className:`flex items-center justify-between mb-2`,children:[Ke,Ye]}),e[140]=Ke,e[141]=Ye,e[142]=Xe):Xe=e[142];let Ze=T.likes+` likes`,Qe;e[143]===Ze?Qe=e[144]:(Qe=(0,Q.jsx)(`span`,{className:`font-semibold text-sm`,children:Ze}),e[143]=Ze,e[144]=Qe);let $e;e[145]===T?$e=e[146]:($e=`createdAt`in T&&T.createdAt?(0,qr.default)(T.createdAt).fromNow():`time`in T?T.time:``,e[145]=T,e[146]=$e);let et;e[147]===$e?et=e[148]:(et=(0,Q.jsx)(`span`,{className:`text-[10px] text-muted-foreground uppercase`,children:$e}),e[147]=$e,e[148]=et);let tt;e[149]!==Qe||e[150]!==et?(tt=(0,Q.jsxs)(`div`,{className:`flex flex-col mb-2`,children:[Qe,et]}),e[149]=Qe,e[150]=et,e[151]=tt):tt=e[151];let nt;e[152]===y?nt=e[153]:(nt=!y&&(0,Q.jsx)(`div`,{className:`flex gap-4 mt-2 mb-1 overflow-x-auto scrollbar-hide py-1`,children:[``,``,``,``,``,``,``,``].map(e=>(0,Q.jsx)(`span`,{className:`text-xl cursor-pointer hover:scale-125 transition-transform`,onClick:()=>g(t=>t+e),children:e},e))}),e[152]=y,e[153]=nt);let rt;e[154]===x?rt=e[155]:(rt=x&&(0,Q.jsxs)(`div`,{className:`flex items-center gap-2 mr-2 bg-primary/10 px-2 py-0.5 rounded text-xs text-primary whitespace-nowrap`,children:[(0,Q.jsxs)(`span`,{children:[`@`,x.user.username]}),(0,Q.jsx)(`button`,{onClick:()=>S(null),children:(0,Q.jsx)(m,{className:`w-3 h-3`})})]}),e[154]=x,e[155]=rt);let it;e[156]!==W||e[157]!==p||e[158]!==h||e[159]!==_||e[160]!==y?(it=y?(0,Q.jsx)(kr,{onRecordingComplete:e=>W(void 0,e),onCancel:()=>b(!1)}):(0,Q.jsxs)(`form`,{onSubmit:e=>W(e),className:`flex items-center gap-2 w-full relative`,children:[(0,Q.jsx)(xe,{size:20,className:`cursor-pointer transition-colors flex-shrink-0 ${_?`text-primary`:`text-muted-foreground hover:text-foreground`}`,onClick:()=>v(!_)}),(0,Q.jsx)(`input`,{ref:w,type:`text`,placeholder:`Add a comment...`,className:`bg-transparent text-sm w-full outline-none text-foreground`,value:h,onChange:e=>g(e.target.value),onFocus:()=>v(!1),disabled:p}),!h&&(0,Q.jsx)(ve,{size:20,className:`text-muted-foreground cursor-pointer hover:text-foreground flex-shrink-0`,onClick:()=>b(!0)}),(0,Q.jsx)(`button`,{type:`submit`,className:`text-primary text-sm font-semibold disabled:opacity-50 hover:text-primary/80 flex-shrink-0`,disabled:!h||p,children:p?(0,Q.jsx)(ie,{className:`h-4 w-4 animate-spin`}):`Post`})]}),e[156]=W,e[157]=p,e[158]=h,e[159]=_,e[160]=y,e[161]=it):it=e[161];let at;e[162]!==rt||e[163]!==it?(at=(0,Q.jsxs)(`div`,{className:`flex bg-muted rounded-full px-3 py-1.5 focus-within:ring-1 ring-primary/50 items-center justify-between border border-transparent transition-all`,children:[rt,it]}),e[162]=rt,e[163]=it,e[164]=at):at=e[164];let st;e[165]!==Ve||e[166]!==Xe||e[167]!==tt||e[168]!==nt||e[169]!==at?(st=(0,Q.jsxs)(`div`,{className:`px-4 py-3 relative shrink-0`,children:[Ve,Xe,tt,nt,at]}),e[165]=Ve,e[166]=Xe,e[167]=tt,e[168]=nt,e[169]=at,e[170]=st):st=e[170];let Z;e[171]!==be||e[172]!==ze||e[173]!==st?(Z=(0,Q.jsxs)(`div`,{className:`w-full md:w-[400px] flex flex-col h-full overflow-hidden`,children:[be,Se,ze,Be,st]}),e[171]=be,e[172]=ze,e[173]=st,e[174]=Z):Z=e[174];let lt;e[175]!==ae||e[176]!==Z?(lt=(0,Q.jsxs)(`div`,{className:`flex flex-col md:flex-row h-full w-full bg-background`,children:[ae,Z]}),e[175]=ae,e[176]=Z,e[177]=lt):lt=e[177];let pt;e[178]!==Y||e[179]!==lt?(pt=(0,Q.jsxs)(vn,{className:`max-w-5xl h-[95vh] md:h-[650px] md:max-h-[90vh] p-0 overflow-hidden border-none sm:rounded-lg`,children:[Y,lt]}),e[178]=Y,e[179]=lt,e[180]=pt):pt=e[180];let mt;return e[181]!==J||e[182]!==pt?(mt=(0,Q.jsx)(hn,{open:!0,onOpenChange:J,children:pt}),e[181]=J,e[182]=pt,e[183]=mt):mt=e[183],mt},Xr=O(),Zr=e=>{let t=(0,Xr.c)(6),{children:n}=e,r,i,a,o;t[0]===Symbol.for(`react.memo_cache_sentinel`)?(r={opacity:0},i={opacity:1},a={opacity:0},o={duration:.15,ease:`easeOut`},t[0]=r,t[1]=i,t[2]=a,t[3]=o):(r=t[0],i=t[1],a=t[2],o=t[3]);let s;return t[4]===n?s=t[5]:(s=(0,Q.jsx)(h.div,{initial:r,animate:i,exit:a,transition:o,className:`w-full flex justify-center`,children:n}),t[4]=n,t[5]=s),s},Qr=O();function $r(){let e=(0,Qr.c)(4),t;e[0]===Symbol.for(`react.memo_cache_sentinel`)?(t=(0,Q.jsxs)(`div`,{className:`mb-8 mt-4 flex items-center gap-2 px-2`,children:[(0,Q.jsx)(Cn,{className:`w-8 h-8 rounded-md shrink-0`}),(0,Q.jsx)(Cn,{className:`h-6 w-32 hidden lg:block`})]}),e[0]=t):t=e[0];let n;e[1]===Symbol.for(`react.memo_cache_sentinel`)?(n=(0,Q.jsxs)(`div`,{className:`hidden md:flex flex-col w-[72px] lg:w-[245px] h-screen fixed border-r border-border p-4 gap-4 z-50 bg-background`,children:[t,(0,Q.jsx)(`div`,{className:`flex flex-col gap-2`,children:Array.from({length:6}).map(ri)})]}),e[1]=n):n=e[1];let r;e[2]===Symbol.for(`react.memo_cache_sentinel`)?(r=(0,Q.jsx)(`div`,{className:`md:hidden fixed bottom-0 left-0 right-0 h-16 border-t border-border bg-background flex justify-around items-center px-4 z-50`,children:Array.from({length:5}).map(ni)}),e[2]=r):r=e[2];let i;return e[3]===Symbol.for(`react.memo_cache_sentinel`)?(i=(0,Q.jsxs)(`div`,{className:`min-h-screen flex flex-col md:flex-row bg-background`,children:[n,r,(0,Q.jsx)(`main`,{className:`flex-grow md:ml-[72px] lg:ml-[245px] flex justify-center pt-4 md:pt-8 pb-20 md:pb-0`,children:(0,Q.jsxs)(`div`,{className:`w-full max-w-[470px] flex flex-col gap-6 px-4 md:px-0`,children:[(0,Q.jsx)(`div`,{className:`flex gap-4 overflow-hidden`,children:Array.from({length:6}).map(ti)}),Array.from({length:2}).map(ei)]})})]}),e[3]=i):i=e[3],i}function ei(e,t){return(0,Q.jsxs)(`div`,{className:`w-full rounded-xl overflow-hidden border border-border bg-card shadow-sm`,children:[(0,Q.jsxs)(`div`,{className:`p-3 flex items-center gap-3`,children:[(0,Q.jsx)(Cn,{className:`w-8 h-8 rounded-full`}),(0,Q.jsxs)(`div`,{className:`space-y-2`,children:[(0,Q.jsx)(Cn,{className:`w-24 h-3`}),(0,Q.jsx)(Cn,{className:`w-16 h-2`})]})]}),(0,Q.jsx)(Cn,{className:`w-full aspect-square`}),(0,Q.jsxs)(`div`,{className:`p-3 space-y-3`,children:[(0,Q.jsx)(Cn,{className:`w-full h-4`}),(0,Q.jsx)(Cn,{className:`w-3/4 h-4`})]})]},t)}function ti(e,t){return(0,Q.jsxs)(`div`,{className:`flex flex-col items-center gap-2 shrink-0`,children:[(0,Q.jsx)(Cn,{className:`w-16 h-16 rounded-full border-2 border-background`}),(0,Q.jsx)(Cn,{className:`w-12 h-2`})]},t)}function ni(e,t){return(0,Q.jsx)(Cn,{className:`w-6 h-6 rounded-full`},t)}function ri(e,t){return(0,Q.jsxs)(`div`,{className:`flex items-center gap-4 px-2 py-3`,children:[(0,Q.jsx)(Cn,{className:`w-6 h-6 rounded-md shrink-0`}),(0,Q.jsx)(Cn,{className:`h-4 w-24 hidden lg:block`})]},t)}var ii=O(),ai=e(qe(),1);const oi=[`notifications`],si=e=>{let t=(0,ii.c)(5),n=!!e,r;t[0]===e?r=t[1]:(r=async()=>{let{data:t,error:n}=await $.from(`notifications`).select(`
          id,
          created_at,
          type,
          post_id,
          reel_id,
          actor_id,
          actor:profiles!actor_id (username, avatar_url, is_verified)
        `).eq(`user_id`,e).order(`created_at`,{ascending:!1});if(n)throw n;return(t||[]).map(ci)},t[0]=e,t[1]=r);let i;return t[2]!==n||t[3]!==r?(i={queryKey:oi,enabled:n,queryFn:r},t[2]=n,t[3]=r,t[4]=i):i=t[4],P(i)};function ci(e){let t=`interacted with you.`;return e.type===`follow`?t=`started following you.`:e.type===`like`?t=`liked your `+(e.reel_id?`reel.`:`post.`):e.type===`comment`?t=`commented on your `+(e.reel_id?`reel.`:`post.`):e.type===`mention`&&(t=`mentioned you in a `+(e.reel_id?`reel.`:`post.`)),{id:e.id,created_at:e.created_at,type:e.type,user:{id:e.actor_id||``,username:e.actor?.username||`Unknown`,name:e.actor?.username||`Unknown`,avatar:e.actor?.avatar_url||``,isVerified:e.actor?.is_verified||!1},text:t,time:(0,ai.default)(e.created_at).fromNow(),isFollowing:!1,post_id:e.post_id||void 0,reel_id:e.reel_id||void 0}}var li=O(),ui=e=>{let t=(0,li.c)(7),n;t[0]===e?n=t[1]:({...n}=e,t[0]=e,t[1]=n);let{theme:r}=G(),i=r===void 0?`system`:r,a,s;t[2]===Symbol.for(`react.memo_cache_sentinel`)?(a={success:(0,Q.jsx)(o,{className:`size-4`}),info:(0,Q.jsx)(be,{className:`size-4`}),warning:(0,Q.jsx)(F,{className:`size-4`}),error:(0,Q.jsx)(we,{className:`size-4`}),loading:(0,Q.jsx)(ie,{className:`size-4 animate-spin`})},s={"--normal-bg":`var(--popover)`,"--normal-text":`var(--popover-foreground)`,"--normal-border":`var(--border)`,"--border-radius":`var(--radius)`},t[2]=a,t[3]=s):(a=t[2],s=t[3]);let c;return t[4]!==n||t[5]!==i?(c=(0,Q.jsx)(x,{theme:i,className:`toaster group`,icons:a,style:s,...n}),t[4]=n,t[5]=i,t[6]=c):c=t[6],c},di=O(),fi=e(qe(),1),pi=(0,X.lazy)(()=>De(()=>import(`./HomeView-pPfbhNLk.js`),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]))),mi=(0,X.lazy)(()=>De(()=>import(`./ProfileView-urzjDVUv.js`),__vite__mapDeps([10,1,2,3,4,5,11,9]))),hi=(0,X.lazy)(()=>De(()=>import(`./MessagesView-D3WcrZr-.js`),__vite__mapDeps([12,1,2,3,4,5,11]))),gi=(0,X.lazy)(()=>De(()=>import(`./ReelsView-Bt885gki.js`),__vite__mapDeps([13,1,2,3,4,5,7,8,9]))),_i=(0,X.lazy)(()=>De(()=>import(`./NotificationsView-CVW2VwXZ.js`),__vite__mapDeps([14,1,2,3,4,5,9,8]))),vi=(0,X.lazy)(()=>De(()=>import(`./ExploreView-Bfz4Vwfp.js`),__vite__mapDeps([15,1,2,3,4,5]))),yi=(0,X.lazy)(()=>De(()=>import(`./AuthView-Bc6Hr8sa.js`),__vite__mapDeps([16,1,2,3,4]))),bi=(0,X.lazy)(()=>De(()=>import(`./PostView-BlhW58mL.js`),__vite__mapDeps([17,1,2,3,4,5,6,7,8])));function xi(){let e=(0,di.c)(43),{theme:t,viewingStory:n,setCurrentUser:r,setUnreadNotificationsCount:i,showToast:a}=ot(),{user:o,profile:s,loading:c}=ct(),l=E(),u=R();Mt();let{data:d}=si(o?.id),f;e[0]===d?f=e[1]:(f=d===void 0?[]:d,e[0]=d,e[1]=f);let p=f,m=l.pathname.startsWith(`/reels/`)&&l.pathname.split(`/`).length===3||l.pathname.startsWith(`/post/`)&&l.pathname.split(`/`).length===3,h,g;e[2]===t?(h=e[3],g=e[4]):(h=()=>{t===`dark`?document.documentElement.classList.add(`dark`):document.documentElement.classList.remove(`dark`)},g=[t],e[2]=t,e[3]=h,e[4]=g),(0,X.useEffect)(h,g);let _,v;e[5]!==u||e[6]!==a||e[7]!==o?(_=()=>{if(!o)return;let e=$.channel(`notifications_realtime_${o.id}`).on(`postgres_changes`,{event:`INSERT`,schema:`public`,table:`notifications`,filter:`user_id=eq.${o.id}`},e=>{console.log(`New notification:`,e),u.invalidateQueries({queryKey:oi}),a(`New notification received`)}).subscribe();return()=>{$.removeChannel(e)}},v=[o,u,a],e[5]=u,e[6]=a,e[7]=o,e[8]=_,e[9]=v):(_=e[8],v=e[9]),(0,X.useEffect)(_,v);let b,x;e[10]!==p||e[11]!==i?(b=()=>{let e=localStorage.getItem(`lastNotificationReadTime`),t=e?(0,fi.default)(e):(0,fi.default)(0);i(p.filter(e=>e.created_at&&(0,fi.default)(e.created_at).isAfter(t)).length)},x=[p,i],e[10]=p,e[11]=i,e[12]=b,e[13]=x):(b=e[12],x=e[13]),(0,X.useEffect)(b,x),kt();let S,C;if(e[14]!==s||e[15]!==r||e[16]!==o?(S=()=>{s&&o&&r({id:o.id,username:s.username,name:s.full_name||o.email||`User`,avatar:s.avatar_url||`https://api.dicebear.com/9.x/avataaars/svg?seed=default`,bio:s.bio||``,isVerified:s.is_verified||!1,stats:{posts:0,followers:0,following:0}})},C=[s,o,r],e[14]=s,e[15]=r,e[16]=o,e[17]=S,e[18]=C):(S=e[17],C=e[18]),(0,X.useEffect)(S,C),c){let t;return e[19]===Symbol.for(`react.memo_cache_sentinel`)?(t=(0,Q.jsx)(`div`,{className:`min-h-screen flex items-center justify-center bg-background`,children:(0,Q.jsx)(`img`,{src:`/icon.png`,className:`w-20 h-20 animate-pulse`,alt:`Loading`})}),e[19]=t):t=e[19],t}if(!o&&!m){let t;return e[20]===Symbol.for(`react.memo_cache_sentinel`)?(t=(0,Q.jsx)(X.Suspense,{fallback:(0,Q.jsx)(`div`,{className:`min-h-screen flex items-center justify-center bg-background`,children:(0,Q.jsx)(`img`,{src:`/icon.png`,className:`w-20 h-20 animate-pulse`,alt:`Loading`})}),children:(0,Q.jsx)(yi,{})}),e[20]=t):t=e[20],t}let w,T,D,O;e[21]===Symbol.for(`react.memo_cache_sentinel`)?(w=(0,Q.jsx)(ui,{}),T=(0,Q.jsx)(jn,{}),D=(0,Q.jsx)(Qn,{}),O=(0,Q.jsx)(Yr,{}),e[21]=w,e[22]=T,e[23]=D,e[24]=O):(w=e[21],T=e[22],D=e[23],O=e[24]);let k;e[25]===n?k=e[26]:(k=n!==null&&(0,Q.jsx)(lr,{}),e[25]=n,e[26]=k);let A;e[27]===k?A=e[28]:(A=(0,Q.jsx)(y,{children:k}),e[27]=k,e[28]=A);let j;e[29]===Symbol.for(`react.memo_cache_sentinel`)?(j=(0,Q.jsx)($r,{}),e[29]=j):j=e[29];let M;e[30]===Symbol.for(`react.memo_cache_sentinel`)?(M=(0,Q.jsx)(Dt,{}),e[30]=M):M=e[30];let N;e[31]===Symbol.for(`react.memo_cache_sentinel`)?(N=(0,Q.jsx)(B,{path:`/`,element:(0,Q.jsx)(Zr,{children:(0,Q.jsx)(pi,{})})}),e[31]=N):N=e[31];let P;e[32]===Symbol.for(`react.memo_cache_sentinel`)?(P=(0,Q.jsx)(B,{path:`/explore`,element:(0,Q.jsx)(Zr,{children:(0,Q.jsx)(vi,{})})}),e[32]=P):P=e[32];let F;e[33]===Symbol.for(`react.memo_cache_sentinel`)?(F=(0,Q.jsx)(B,{path:`/post/:id`,element:(0,Q.jsx)(Zr,{children:(0,Q.jsx)(bi,{})})}),e[33]=F):F=e[33];let I;e[34]===Symbol.for(`react.memo_cache_sentinel`)?(I=(0,Q.jsx)(B,{path:`/reels/:id?`,element:(0,Q.jsx)(Zr,{children:(0,Q.jsx)(gi,{})})}),e[34]=I):I=e[34];let L;e[35]===Symbol.for(`react.memo_cache_sentinel`)?(L=(0,Q.jsx)(B,{path:`/messages/:username?`,element:(0,Q.jsx)(Zr,{children:(0,Q.jsx)(hi,{})})}),e[35]=L):L=e[35];let z;e[36]===Symbol.for(`react.memo_cache_sentinel`)?(z=(0,Q.jsx)(B,{path:`/notifications`,element:(0,Q.jsx)(Zr,{children:(0,Q.jsx)(_i,{})})}),e[36]=z):z=e[36];let V;e[37]===Symbol.for(`react.memo_cache_sentinel`)?(V=(0,Q.jsxs)(B,{element:M,children:[N,P,F,I,L,z,(0,Q.jsx)(B,{path:`/profile/:username`,element:(0,Q.jsx)(Zr,{children:(0,Q.jsx)(mi,{})})})]}),e[37]=V):V=e[37];let H;e[38]===l?H=e[39]:(H=(0,Q.jsx)(y,{mode:`wait`,children:(0,Q.jsx)(X.Suspense,{fallback:j,children:(0,Q.jsx)(U,{location:l,children:V},l.pathname)})}),e[38]=l,e[39]=H);let W;return e[40]!==A||e[41]!==H?(W=(0,Q.jsxs)(Q.Fragment,{children:[w,T,D,O,A,H]}),e[40]=A,e[41]=H,e[42]=W):W=e[42],W}const Si=({children:e})=>{let[t,n]=(0,X.useState)(null),[r,i]=(0,X.useState)(null),[a,o]=(0,X.useState)(null),[s,c]=(0,X.useState)(!0);(0,X.useEffect)(()=>{$.auth.getSession().then(({data:{session:e}})=>{n(e),i(e?.user??null),e?.user?l(e.user.id):c(!1)});let{data:{subscription:e}}=$.auth.onAuthStateChange((e,t)=>{n(t),i(t?.user??null),t?.user?l(t.user.id):(o(null),c(!1))});return()=>e.unsubscribe()},[]);let l=async e=>{try{let{data:t,error:n}=await $.from(`profiles`).select(`*`).eq(`id`,e).single();n?console.error(`Error fetching profile:`,n):o(t)}finally{c(!1)}};return(0,Q.jsx)(st.Provider,{value:{session:t,user:r,profile:a,loading:s,signIn:async(e,t)=>{let{data:n,error:r}=await $.auth.signInWithPassword({email:e,password:t});return{data:n,error:r}},signUp:async(e,t,n)=>{let{data:r,error:i}=await $.auth.signUp({email:e,password:t,options:{data:n}});return{data:r,error:i}},signOut:async()=>{await $.auth.signOut()},resetPassword:async e=>{let{data:t,error:n}=await $.auth.resetPasswordForEmail(e,{redirectTo:`${window.location.origin}/?reset=true`});return{data:t,error:n}},updatePassword:async e=>{let{data:t,error:n}=await $.auth.updateUser({password:e});return{data:t,error:n}}},children:!s&&e})};var Ci=new Xe({defaultOptions:{queries:{staleTime:1e3*60*5,gcTime:1e3*60*60*24,retry:1}}}),wi=Ze({storage:window.localStorage});(0,$e.createRoot)(document.getElementById(`root`)).render((0,Q.jsx)(X.StrictMode,{children:(0,Q.jsxs)(i,{client:Ci,persistOptions:{persister:wi},children:[(0,Q.jsx)(_,{children:(0,Q.jsx)(Si,{children:(0,Q.jsx)(xi,{})})}),(0,Q.jsx)(Re,{initialIsOpen:!1})]})}));export{ht as A,sn as C,Ft as D,Ht as E,ct as F,ot as I,ft as M,dt as N,It as O,Z as P,bn as S,Vt as T,Tn as _,vr as a,vn as b,nr as c,Un as d,Kn as f,Dn as g,Ln as h,xr as i,ut as j,$ as k,Vn as l,Yn as m,zr as n,mr as o,qn as p,kr as r,ir as s,si as t,Jn as u,Cn as v,Xt as w,yn as x,hn as y};