import{n as e,t}from"./ShareModal-C1a9Nw_2.js";import{A as n,D as r,E as i,F as a,I as o,L as s,M as c,O as l,P as u,S as ee,T as d,_ as te,a as f,d as p,f as ne,i as re,p as ie,r as m,u as h,x as g,y as ae}from"./index-DEFGyGlS.js";import"./useGetSuggestedUsers-C2OGKj5H.js";import{t as _}from"./useFollowUser-CYnz0rCP.js";var v=d(`music-2`,[[`circle`,{cx:`8`,cy:`18`,r:`4`,key:`1fc0mg`}],[`path`,{d:`M12 18V2l7 4`,key:`g04rme`}]]),oe=d(`play`,[[`path`,{d:`M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z`,key:`10ikf1`}]]),se=d(`volume-2`,[[`path`,{d:`M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z`,key:`uqj9uw`}],[`path`,{d:`M16 9a5 5 0 0 1 0 6`,key:`1q6k2b`}],[`path`,{d:`M19.364 18.364a9 9 0 0 0 0-12.728`,key:`ijwkga`}]]),ce=d(`volume-x`,[[`path`,{d:`M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z`,key:`uqj9uw`}],[`line`,{x1:`22`,x2:`16`,y1:`9`,y2:`15`,key:`1ewh16`}],[`line`,{x1:`16`,x2:`22`,y1:`9`,y2:`15`,key:`5ykzw1`}]]),le=l(),y=s(o(),1),b=c(),ue=n=>{let a=(0,le.c)(131),{reel:o,showToast:s,theme:c,onUserClick:l,glassModal:u}=n,{setViewingReel:d}=ie(),{user:f}=ne(),{mutate:h}=m(),{mutate:ue}=_(),[fe,pe]=(0,y.useState)(!1),[x,me]=(0,y.useState)(!0),[S,he]=(0,y.useState)(!0),[ge,_e]=(0,y.useState)(!1),[ve,ye]=(0,y.useState)(!1),be=(0,y.useRef)(null),C=(0,y.useRef)(null),w=`${window.location.origin}/reels/${o.id}`,xe=o.hasLiked||!1,Se;a[0]!==xe||a[1]!==o.id||a[2]!==s||a[3]!==h||a[4]!==f?(Se=()=>{if(!f){s(`লাইক করতে লগ ইন করুন`);return}h({targetId:o.id,type:`reel`,userId:f.id,hasLiked:xe})},a[0]=xe,a[1]=o.id,a[2]=s,a[3]=h,a[4]=f,a[5]=Se):Se=a[5];let T=Se,Ce;a[6]!==ue||a[7]!==o.user.isFollowing||a[8]!==o.user.username||a[9]!==o.userId||a[10]!==s||a[11]!==f?(Ce=()=>{if(!f){s(`ফলো করতে লগ ইন করুন`);return}o.userId&&ue({targetUserId:o.userId,currentUserId:f.id,isFollowing:o.user.isFollowing||!1,targetUsername:o.user.username},{onSuccess:()=>s(`ফলো করা হয়েছে`),onError:()=>s(`ফলো করতে সমস্যা হয়েছে`)})},a[6]=ue,a[7]=o.user.isFollowing,a[8]=o.user.username,a[9]=o.userId,a[10]=s,a[11]=f,a[12]=Ce):Ce=a[12];let we=Ce,Te;a[13]===S?Te=a[14]:(Te=()=>{C.current&&(S?(C.current.pause(),he(!1)):(C.current.play(),he(!0)))},a[13]=S,a[14]=Te);let Ee=Te,De,Oe;a[15]===Symbol.for(`react.memo_cache_sentinel`)?(De=()=>{let e=new IntersectionObserver(e=>{let[t]=e;t.isIntersecting?(C.current?.play().catch(de),he(!0),me(!1)):(C.current?.pause(),he(!1),me(!0))},{threshold:.6});return be.current&&e.observe(be.current),()=>e.disconnect()},Oe=[],a[15]=De,a[16]=Oe):(De=a[15],Oe=a[16]),(0,y.useEffect)(De,Oe);let ke;a[17]===T?ke=a[18]:(ke=()=>{T(),pe(!0),setTimeout(()=>pe(!1),1e3)},a[17]=T,a[18]=ke);let Ae=ke,je,Me,Ne,Pe;a[19]===Symbol.for(`react.memo_cache_sentinel`)?(Me={opacity:0,scale:.95},Ne={opacity:1,scale:1},Pe={once:!0},je={duration:.5},a[19]=je,a[20]=Me,a[21]=Ne,a[22]=Pe):(je=a[19],Me=a[20],Ne=a[21],Pe=a[22]);let E;a[23]!==u||a[24]!==ge||a[25]!==w||a[26]!==s||a[27]!==c?(E=ge&&(0,b.jsx)(e,{onClose:()=>_e(!1),showToast:s,theme:c,glassModal:u,shareUrl:w}),a[23]=u,a[24]=ge,a[25]=w,a[26]=s,a[27]=c,a[28]=E):E=a[28];let D;a[29]!==u||a[30]!==ve||a[31]!==w||a[32]!==s||a[33]!==c?(D=ve&&(0,b.jsx)(t,{onClose:()=>ye(!1),theme:c,showToast:s,glassModal:u,shareUrl:w}),a[29]=u,a[30]=ve,a[31]=w,a[32]=s,a[33]=c,a[34]=D):D=a[34];let O;a[35]!==x||a[36]!==o.src||a[37]!==Ee?(O=o.src?(0,b.jsx)(`video`,{ref:C,src:o.src,className:`w-full h-full object-cover`,loop:!0,muted:x,onClick:Ee}):(0,b.jsx)(p,{src:o.src,className:`w-full h-full`,onClick:()=>me(!x),alt:`reel`}),a[35]=x,a[36]=o.src,a[37]=Ee,a[38]=O):O=a[38];let k;a[39]===S?k=a[40]:(k=!S&&(0,b.jsx)(`div`,{className:`absolute inset-0 flex items-center justify-center pointer-events-none z-20`,children:(0,b.jsx)(`div`,{className:`bg-black/40 p-5 rounded-full backdrop-blur-sm`,children:(0,b.jsx)(oe,{className:`text-white w-10 h-10 fill-white`})})}),a[39]=S,a[40]=k);let A;a[41]===x?A=a[42]:(A=(0,b.jsx)(`div`,{className:`absolute top-4 right-4 bg-black/50 p-2 rounded-full cursor-pointer transition-opacity hover:bg-black/70 z-30`,onClick:e=>{e.stopPropagation(),me(!x)},children:x?(0,b.jsx)(ce,{className:`text-white w-5 h-5`}):(0,b.jsx)(se,{className:`text-white w-5 h-5`})}),a[41]=x,a[42]=A);let j;a[43]===fe?j=a[44]:(j=fe&&(0,b.jsx)(i.div,{initial:{scale:0,opacity:0},animate:{scale:1.2,opacity:1},exit:{scale:0,opacity:0},className:`absolute inset-0 flex items-center justify-center pointer-events-none z-10`,children:(0,b.jsx)(g,{size:100,className:`text-white fill-white drop-shadow-lg`})}),a[43]=fe,a[44]=j);let M;a[45]===j?M=a[46]:(M=(0,b.jsx)(r,{children:j}),a[45]=j,a[46]=M);let N;a[47]!==l||a[48]!==o.user?(N=()=>l(o.user),a[47]=l,a[48]=o.user,a[49]=N):N=a[49];let P;a[50]===o.user.avatar?P=a[51]:(P=(0,b.jsx)(`div`,{className:`w-8 h-8 rounded-full border border-white/50 overflow-hidden cursor-pointer`,children:(0,b.jsx)(p,{src:o.user.avatar,className:`w-full h-full`,alt:`reel user`})}),a[50]=o.user.avatar,a[51]=P);let F;a[52]===o.user.username?F=a[53]:(F=(0,b.jsx)(`span`,{className:`font-semibold text-sm shadow-black drop-shadow-md text-white cursor-pointer hover:opacity-70 transition-opacity`,children:o.user.username}),a[52]=o.user.username,a[53]=F);let I;a[54]===o.user.isVerified?I=a[55]:(I=o.user.isVerified&&(0,b.jsx)(re,{}),a[54]=o.user.isVerified,a[55]=I);let Fe,Ie;a[56]===Symbol.for(`react.memo_cache_sentinel`)?(Fe={scale:1.05},Ie={scale:.95},a[56]=Fe,a[57]=Ie):(Fe=a[56],Ie=a[57]);let Le=`border border-white/30 rounded-lg px-3 py-1 text-xs font-semibold backdrop-blur-sm transition-colors ${o.user.isFollowing?`bg-white/20 text-white`:`text-white hover:bg-white/10`}`,L;a[58]===we?L=a[59]:(L=e=>{e.stopPropagation(),we()},a[58]=we,a[59]=L);let Re=o.user.isFollowing?`ফলো করছেন`:`ফলো`,R;a[60]!==Le||a[61]!==L||a[62]!==Re?(R=(0,b.jsx)(i.button,{whileHover:Fe,whileTap:Ie,className:Le,onClick:L,children:Re}),a[60]=Le,a[61]=L,a[62]=Re,a[63]=R):R=a[63];let z;a[64]!==N||a[65]!==P||a[66]!==F||a[67]!==I||a[68]!==R?(z=(0,b.jsxs)(`div`,{className:`flex items-center gap-3 mb-3`,onClick:N,children:[P,F,I,R]}),a[64]=N,a[65]=P,a[66]=F,a[67]=I,a[68]=R,a[69]=z):z=a[69];let ze;a[70]===Symbol.for(`react.memo_cache_sentinel`)?(ze=(0,b.jsx)(`span`,{className:`text-zinc-300 cursor-pointer font-semibold hover:text-white`,children:`আরও`}),a[70]=ze):ze=a[70];let B;a[71]===o.caption?B=a[72]:(B=(0,b.jsxs)(`div`,{className:`text-sm mb-3 line-clamp-2 drop-shadow-md text-white`,children:[o.caption,` `,ze]}),a[71]=o.caption,a[72]=B);let Be;a[73]===Symbol.for(`react.memo_cache_sentinel`)?(Be=(0,b.jsx)(v,{size:12}),a[73]=Be):Be=a[73];let V;a[74]===o.audio?V=a[75]:(V=(0,b.jsxs)(`div`,{className:`flex items-center gap-2 text-xs drop-shadow-md text-white opacity-80`,children:[Be,(0,b.jsx)(`div`,{className:`truncate w-40`,children:o.audio})]}),a[74]=o.audio,a[75]=V);let H;a[76]!==z||a[77]!==B||a[78]!==V?(H=(0,b.jsxs)(`div`,{className:`absolute bottom-0 left-0 w-full p-4 bg-gradient-to-t from-black/80 to-transparent pt-20 pb-20 md:pb-4`,children:[z,B,V]}),a[76]=z,a[77]=B,a[78]=V,a[79]=H):H=a[79];let Ve,He;a[80]===Symbol.for(`react.memo_cache_sentinel`)?(Ve={scale:1.1},He={scale:.9},a[80]=Ve,a[81]=He):(Ve=a[80],He=a[81]);let Ue=`cursor-pointer transition-colors ${xe?`fill-[#f42a41] text-[#f42a41]`:``}`,U;a[82]!==T||a[83]!==Ue?(U=(0,b.jsx)(i.div,{whileHover:Ve,whileTap:He,children:(0,b.jsx)(g,{size:28,strokeWidth:1.5,className:Ue,onClick:T})}),a[82]=T,a[83]=Ue,a[84]=U):U=a[84];let W;a[85]===o.likes?W=a[86]:(W=(0,b.jsx)(`span`,{className:`text-xs font-semibold drop-shadow-md`,children:o.likes}),a[85]=o.likes,a[86]=W);let G;a[87]!==U||a[88]!==W?(G=(0,b.jsxs)(`div`,{className:`flex flex-col items-center gap-1`,children:[U,W]}),a[87]=U,a[88]=W,a[89]=G):G=a[89];let We,Ge;a[90]===Symbol.for(`react.memo_cache_sentinel`)?(We={scale:1.1},Ge={scale:.9},a[90]=We,a[91]=Ge):(We=a[90],Ge=a[91]);let K;a[92]!==o||a[93]!==d?(K=(0,b.jsx)(i.div,{whileHover:We,whileTap:Ge,children:(0,b.jsx)(ae,{size:28,strokeWidth:1.5,className:`-scale-x-100 drop-shadow-lg cursor-pointer hover:opacity-80`,onClick:()=>d(o)})}),a[92]=o,a[93]=d,a[94]=K):K=a[94];let q;a[95]===o.comments?q=a[96]:(q=(0,b.jsx)(`span`,{className:`text-xs font-semibold drop-shadow-md`,children:o.comments}),a[95]=o.comments,a[96]=q);let J;a[97]!==K||a[98]!==q?(J=(0,b.jsxs)(`div`,{className:`flex flex-col items-center gap-1`,children:[K,q]}),a[97]=K,a[98]=q,a[99]=J):J=a[99];let Ke,qe;a[100]===Symbol.for(`react.memo_cache_sentinel`)?(Ke={scale:1.1},qe={scale:.9},a[100]=Ke,a[101]=qe):(Ke=a[100],qe=a[101]);let Je;a[102]===Symbol.for(`react.memo_cache_sentinel`)?(Je=(0,b.jsx)(i.div,{whileHover:Ke,whileTap:qe,children:(0,b.jsx)(te,{size:28,strokeWidth:1.5,className:`cursor-pointer hover:opacity-80`,onClick:()=>ye(!0)})}),a[102]=Je):Je=a[102];let Ye,Xe;a[103]===Symbol.for(`react.memo_cache_sentinel`)?(Ye={scale:1.1},Xe={scale:.9},a[103]=Ye,a[104]=Xe):(Ye=a[103],Xe=a[104]);let Ze;a[105]===Symbol.for(`react.memo_cache_sentinel`)?(Ze=(0,b.jsx)(i.div,{whileHover:Ye,whileTap:Xe,children:(0,b.jsx)(ee,{size:28,strokeWidth:1.5,className:`cursor-pointer hover:opacity-80`,onClick:()=>_e(!0)})}),a[105]=Ze):Ze=a[105];let Qe;a[106]===Symbol.for(`react.memo_cache_sentinel`)?(Qe={scale:1.1},a[106]=Qe):Qe=a[106];let Y;a[107]!==l||a[108]!==o.user?(Y=()=>l(o.user),a[107]=l,a[108]=o.user,a[109]=Y):Y=a[109];let X;a[110]===o.user.avatar?X=a[111]:(X=(0,b.jsx)(p,{src:o.user.avatar,className:`w-full h-full`,alt:`user thumb`}),a[110]=o.user.avatar,a[111]=X);let Z;a[112]!==Y||a[113]!==X?(Z=(0,b.jsx)(i.div,{whileHover:Qe,className:`w-6 h-6 border-2 border-white rounded-md overflow-hidden mt-2 cursor-pointer`,onClick:Y,children:X}),a[112]=Y,a[113]=X,a[114]=Z):Z=a[114];let Q;a[115]!==G||a[116]!==J||a[117]!==Z?(Q=(0,b.jsxs)(`div`,{className:`absolute bottom-20 md:bottom-4 right-2 flex flex-col items-center gap-6 md:gap-4 text-white pb-safe`,children:[G,J,Je,Ze,Z]}),a[115]=G,a[116]=J,a[117]=Z,a[118]=Q):Q=a[118];let $;a[119]!==Ae||a[120]!==O||a[121]!==k||a[122]!==A||a[123]!==M||a[124]!==H||a[125]!==Q?($=(0,b.jsxs)(`div`,{ref:be,className:`relative h-full md:h-[95vh] w-full md:w-[400px] bg-zinc-900 md:rounded-lg overflow-hidden border-zinc-800 md:border group shadow-2xl`,onDoubleClick:Ae,children:[O,k,A,M,H,Q]}),a[119]=Ae,a[120]=O,a[121]=k,a[122]=A,a[123]=M,a[124]=H,a[125]=Q,a[126]=$):$=a[126];let $e;return a[127]!==E||a[128]!==D||a[129]!==$?($e=(0,b.jsxs)(i.div,{initial:Me,whileInView:Ne,viewport:Pe,transition:je,className:`h-full w-full flex justify-center items-center snap-start relative md:pt-0`,children:[E,D,$]}),a[127]=E,a[128]=D,a[129]=$,a[130]=$e):$e=a[130],$e};function de(){}var fe=l();const pe=e=>[`reel`,e],x=(e,t)=>{let r=(0,fe.c)(9),i=e||``,a;r[0]===i?a=r[1]:(a=pe(i),r[0]=i,r[1]=a);let o=!!e,s;r[2]!==t||r[3]!==e?(s=async()=>{if(!e)throw Error(`Reel ID required`);let{data:n,error:r}=await h.from(`reels`).select(`
          *,
          profiles (username, full_name, avatar_url, is_verified),
          likes (count),
          comments (count)
        `).eq(`id`,e).single();if(r)throw r;let i=n,a=!1,o=!1;if(t){let{count:n}=await h.from(`likes`).select(`*`,{count:`exact`,head:!0}).eq(`reel_id`,e).eq(`user_id`,t);a=!!n&&n>0;let{count:r}=await h.from(`follows`).select(`*`,{count:`exact`,head:!0}).eq(`follower_id`,t).eq(`following_id`,i.user_id);o=!!r&&r>0}return{id:i.id,userId:i.user_id,user:{id:i.user_id,username:i.profiles?.username||`Unknown`,name:i.profiles?.full_name||`Unknown`,avatar:i.profiles?.avatar_url||``,isVerified:i.profiles?.is_verified||!1,isFollowing:o},src:i.video_url,likes:i.likes?.[0]?.count||0,comments:i.comments?.[0]?.count||0,caption:i.caption||``,audio:i.audio_track_name||`Original Audio`,hasLiked:a}},r[2]=t,r[3]=e,r[4]=s):s=r[4];let c;return r[5]!==a||r[6]!==o||r[7]!==s?(c={queryKey:a,enabled:o,queryFn:s},r[5]=a,r[6]=o,r[7]=s,r[8]=c):c=r[8],n(c)};var me=l(),S=()=>{let e=(0,me.c)(24),{theme:t,showToast:n}=ie(),{user:r}=ne(),i=u(),{id:o}=a(),s=t===`dark`?`bg-[#121212]/90 backdrop-blur-2xl border border-white/10`:`bg-white/90 backdrop-blur-2xl border border-black/10`,{data:c,isLoading:l}=x(o,r?.id),{data:ee,isLoading:d}=f(r?.id),te;e[0]===ee?te=e[1]:(te=ee===void 0?[]:ee,e[0]=ee,e[1]=te);let p=te,re;e[2]===i?re=e[3]:(re=e=>{i(`/profile/${e.username}`)},e[2]=i,e[3]=re);let m=re,h=o?l:d,g;e[4]!==p||e[5]!==o||e[6]!==c?(g=o?c?[c]:[]:p,e[4]=p,e[5]=o,e[6]=c,e[7]=g):g=e[7];let ae=g;if(h){let t;return e[8]===Symbol.for(`react.memo_cache_sentinel`)?(t=(0,b.jsx)(`div`,{className:`h-screen w-full flex items-center justify-center bg-black text-white`,children:`Loading reel...`}),e[8]=t):t=e[8],t}if(ae.length===0){let t=o?`Reel not found`:`No reels yet`,n;return e[9]===t?n=e[10]:(n=(0,b.jsx)(`div`,{className:`h-screen w-full flex items-center justify-center bg-black text-white`,children:t}),e[9]=t,e[10]=n),n}let _;if(e[11]!==ae||e[12]!==s||e[13]!==m||e[14]!==n||e[15]!==t){let r;e[17]!==s||e[18]!==m||e[19]!==n||e[20]!==t?(r=e=>(0,b.jsx)(ue,{reel:e,showToast:n,theme:t,onUserClick:m,glassModal:s},e.id),e[17]=s,e[18]=m,e[19]=n,e[20]=t,e[21]=r):r=e[21],_=ae.map(r),e[11]=ae,e[12]=s,e[13]=m,e[14]=n,e[15]=t,e[16]=_}else _=e[16];let v;return e[22]===_?v=e[23]:(v=(0,b.jsx)(`div`,{className:`h-screen w-full flex justify-center bg-black overflow-y-scroll snap-y snap-mandatory scrollbar-hide`,children:(0,b.jsx)(`div`,{className:`w-full md:w-[400px] h-full`,children:_})}),e[22]=_,e[23]=v),v};export{S as default};