import{D as e,I as t,L as n,M as r,O as i,P as a,T as o,_ as s,b as c,d as l,i as ee,m as te,p as u,u as d,v as f}from"./index-ih4mhM6H.js";import{t as p}from"./dist-C4jSNsCl.js";var m=n(t(),1),h=e();const g=[`explorePosts`],_=()=>{let e=(0,h.c)(1),t;return e[0]===Symbol.for(`react.memo_cache_sentinel`)?(t={queryKey:g,queryFn:y,initialPageParam:0,getNextPageParam:b},e[0]=t):t=e[0],i(t)};function v(e){return{id:e.id,content:{type:`image`,src:e.image_url},likes:e.likes[0]?.count||0,comments:e.comments[0]?.count||0}}async function y(e){let{pageParam:t}=e,n=(t===void 0?0:t)*15,r=n+14,{data:i,error:a}=await d.from(`posts`).select(`
          *,
          likes (count),
          comments (count)
        `).order(`created_at`,{ascending:!1}).range(n,r);if(a)throw a;return i.map(v)}function b(e,t){return e.length===15?t.length:void 0}var x=e(),S=r(),C=()=>{let e=(0,x.c)(44),{theme:t,setViewingPost:n}=u(),r=a(),[i,h]=(0,m.useState)(``),g;e[0]===Symbol.for(`react.memo_cache_sentinel`)?(g=[],e[0]=g):g=e[0];let[v,y]=(0,m.useState)(g),[b,C]=(0,m.useState)(!1),T;e[1]===Symbol.for(`react.memo_cache_sentinel`)?(T={rootMargin:`1200px`},e[1]=T):T=e[1];let{ref:E,inView:D}=p(T),{data:O,isLoading:k,fetchNextPage:A,hasNextPage:j,isFetchingNextPage:M}=_(),N,P;e[2]!==A||e[3]!==j||e[4]!==D?(N=()=>{D&&j&&A()},P=[D,j,A],e[2]=A,e[3]=j,e[4]=D,e[5]=N,e[6]=P):(N=e[5],P=e[6]),(0,m.useEffect)(N,P);let F,I;e[7]===i?(F=e[8],I=e[9]):(F=()=>{let e=setTimeout(async()=>{if(i.trim().length>0){C(!0);let{data:e}=await d.from(`profiles`).select(`username, full_name, avatar_url, is_verified`).ilike(`username`,`%${i}%`).limit(10);e&&y(e.map(w)),C(!1)}else y([])},300);return()=>clearTimeout(e)},I=[i],e[7]=i,e[8]=F,e[9]=I),(0,m.useEffect)(F,I);let L;e[10]===Symbol.for(`react.memo_cache_sentinel`)?(L={opacity:0},e[10]=L):L=e[10];let R;e[11]===Symbol.for(`react.memo_cache_sentinel`)?(R={hidden:L,visible:{opacity:1,transition:{staggerChildren:.05}}},e[11]=R):R=e[11];let z=R,B;e[12]===Symbol.for(`react.memo_cache_sentinel`)?(B={hidden:{opacity:0,scale:.9},visible:{opacity:1,scale:1}},e[12]=B):B=e[12];let V=B,H=`mb-4 sticky top-0 z-30 py-2 ${t===`dark`?`bg-black`:`bg-white`}`,U=`flex items-center gap-2 px-3 py-2 rounded-lg ${t===`dark`?`bg-[#262626]`:`bg-gray-100`}`,W=t===`dark`?`text-[#8e8e8e]`:`text-gray-500`,G;e[13]===W?G=e[14]:(G=(0,S.jsx)(s,{size:18,className:W}),e[13]=W,e[14]=G);let K;e[15]===Symbol.for(`react.memo_cache_sentinel`)?(K=e=>h(e.target.value),e[15]=K):K=e[15];let q=`bg-transparent border-none outline-none text-sm w-full ${t===`dark`?`text-white`:`text-black`}`,J;e[16]!==i||e[17]!==q?(J=(0,S.jsx)(`input`,{type:`text`,placeholder:`অনুসন্ধান`,value:i,onChange:K,className:q}),e[16]=i,e[17]=q,e[18]=J):J=e[18];let Y;e[19]===i?Y=e[20]:(Y=i&&(0,S.jsx)(te,{size:18,className:`cursor-pointer`,onClick:()=>h(``)}),e[19]=i,e[20]=Y);let X;e[21]!==U||e[22]!==G||e[23]!==J||e[24]!==Y?(X=(0,S.jsxs)(`div`,{className:U,children:[G,J,Y]}),e[21]=U,e[22]=G,e[23]=J,e[24]=Y,e[25]=X):X=e[25];let Z;e[26]!==X||e[27]!==H?(Z=(0,S.jsx)(`div`,{className:H,children:X}),e[26]=X,e[27]=H,e[28]=Z):Z=e[28];let Q;e[29]!==O?.pages||e[30]!==j||e[31]!==M||e[32]!==k||e[33]!==b||e[34]!==r||e[35]!==E||e[36]!==i||e[37]!==v||e[38]!==n||e[39]!==t?(Q=i?(0,S.jsxs)(`div`,{className:`flex flex-col gap-2`,children:[b&&(0,S.jsx)(`div`,{className:`p-4 text-center`,children:`Searching...`}),!b&&v.length===0&&(0,S.jsx)(`div`,{className:`p-4 text-center text-gray-500`,children:`কোনো ফলাফল পাওয়া যায়নি`}),v.map(e=>(0,S.jsxs)(`div`,{onClick:()=>r(`/profile/${e.username}`),className:`flex items-center gap-3 p-2 rounded-lg cursor-pointer ${t===`dark`?`hover:bg-white/10`:`hover:bg-gray-100`}`,children:[(0,S.jsx)(l,{src:e.avatar,width:100,className:`w-10 h-10 rounded-full`,alt:e.username}),(0,S.jsxs)(`div`,{className:`flex flex-col`,children:[(0,S.jsxs)(`div`,{className:`flex items-center gap-1`,children:[(0,S.jsx)(`span`,{className:`font-semibold text-sm`,children:e.username}),e.isVerified&&(0,S.jsx)(ee,{})]}),(0,S.jsx)(`span`,{className:`text-xs text-gray-500`,children:e.name})]})]},e.username))]}):(0,S.jsxs)(S.Fragment,{children:[k?(0,S.jsx)(`div`,{className:`p-10 text-center`,children:`Loading explore...`}):(0,S.jsx)(o.div,{variants:z,initial:`hidden`,animate:`visible`,className:`grid grid-cols-3 gap-1 md:gap-4`,children:O?.pages.map((e,t)=>(0,S.jsx)(m.Fragment,{children:e.map(e=>(0,S.jsxs)(o.div,{variants:V,whileHover:{scale:.98},className:`relative aspect-square group cursor-pointer overflow-hidden`,onClick:()=>n(e),children:[(0,S.jsx)(l,{src:e.content.src||e.content.poster,width:400,className:`w-full h-full transition-transform duration-300 group-hover:scale-110`,alt:`explore`}),(0,S.jsxs)(`div`,{className:`absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 flex items-center justify-center gap-4 text-white font-bold transition-opacity duration-200 z-20`,children:[(0,S.jsxs)(`div`,{className:`flex items-center gap-1`,children:[(0,S.jsx)(c,{fill:`white`,size:16}),` `,e.likes]}),(0,S.jsxs)(`div`,{className:`flex items-center gap-1`,children:[(0,S.jsx)(f,{fill:`white`,size:16,className:`-scale-x-100`}),` `,e.comments]})]})]},e.id))},t))}),(0,S.jsx)(`div`,{ref:E,className:`h-10 text-center py-4 text-gray-500`,children:M?`আরও লোড হচ্ছে...`:j?`নিচে দেখুন`:``})]}),e[29]=O?.pages,e[30]=j,e[31]=M,e[32]=k,e[33]=b,e[34]=r,e[35]=E,e[36]=i,e[37]=v,e[38]=n,e[39]=t,e[40]=Q):Q=e[40];let $;return e[41]!==Z||e[42]!==Q?($=(0,S.jsxs)(`div`,{className:`w-full max-w-[935px] py-4 px-2`,children:[Z,Q]}),e[41]=Z,e[42]=Q,e[43]=$):$=e[43],$};function w(e){return{username:e.username,name:e.full_name||e.username,avatar:e.avatar_url||``,isVerified:e.is_verified||!1}}export{C as default};