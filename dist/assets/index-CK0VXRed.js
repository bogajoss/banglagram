const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/HomeView-BE8i3gip.js","assets/libs-1HhmK8mh.js","assets/rolldown-runtime-DDUpfMIz.js","assets/vendor-DzZPmAFc.js","assets/tanstack-CEdTVUeY.js","assets/supabase-Bn9f_lp1.js","assets/PostItem-Cqlek8Ke.js","assets/ShareModal-osKiZsEI.js","assets/useGetSuggestedUsers-DnvNYSPX.js","assets/useFollowUser-DM8bL9si.js","assets/ProfileView-CXVFOv3l.js","assets/MessagesView-bc7Di6CU.js","assets/ReelsView-x3sSInIC.js","assets/NotificationsView-DG3pBfIo.js","assets/ExploreView-B7N-nKv6.js","assets/AuthView-B_a6XjDR.js","assets/PostView-DsGbIxLs.js"])))=>i.map(i=>d[i]);
import{a as e}from"./rolldown-runtime-DDUpfMIz.js";import{$ as t,$t as n,A as r,At as i,C as a,D as o,Dt as s,E as c,F as l,Ft as u,G as d,Gt as f,H as p,Ht as m,I as h,J as g,Jt as _,K as v,Kt as y,Lt as b,M as x,N as S,O as C,Ot as w,P as T,Q as E,Qt as D,Rt as O,S as k,St as A,T as j,Tt as M,U as N,Ut as P,V as F,Vt as I,W as L,Wt as R,Xt as z,Y as B,Yt as V,Zt as H,_ as U,_t as W,at as ee,b as G,bt as te,dt as ne,en as K,et as re,ft as ie,g as q,h as J,ht as ae,in as oe,it as se,j as ce,k as le,kt as ue,lt as de,nn as fe,nt as pe,on as me,ot as he,qt as ge,rn as _e,rt as ve,sn as ye,st as be,tn as xe,ut as Se,v as Ce,vt as we,w as Te,wt as Ee,x as De,xt as Oe,y as ke,yt as Ae,z as je,zt as Me}from"./vendor-DzZPmAFc.js";import{M as Ne,_r as Pe,fr as Fe,gr as Ie,hn as Le,hr as Re,k as ze,mn as Be,mr as Ve,pn as He,pr as Ue}from"./libs-1HhmK8mh.js";import{i as We,t as Ge}from"./tanstack-CEdTVUeY.js";import{t as Ke}from"./supabase-Bn9f_lp1.js";(function(){let e=document.createElement(`link`).relList;if(e&&e.supports&&e.supports(`modulepreload`))return;for(let e of document.querySelectorAll(`link[rel="modulepreload"]`))n(e);new MutationObserver(e=>{for(let t of e)if(t.type===`childList`)for(let e of t.addedNodes)e.tagName===`LINK`&&e.rel===`modulepreload`&&n(e)}).observe(document,{childList:!0,subtree:!0});function t(e){let t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin===`use-credentials`?t.credentials=`include`:e.crossOrigin===`anonymous`?t.credentials=`omit`:t.credentials=`same-origin`,t}function n(e){if(e.ep)return;e.ep=!0;let n=t(e);fetch(e.href,n)}})();var qe=me(),Y=e(ye(),1),Je=e(Ie(),1),Ye=e(Re(),1),Xe=e(Ve(),1),Ze=e(Ue(),1),Qe=e(Fe(),1);Je.default.extend(Ye.default),Je.default.extend(Xe.default),Je.default.extend(Ze.default),Je.default.extend(Qe.default);var $e=P();const et=l((e,t)=>({currentUser:{id:``,username:``,name:``,avatar:``,stats:{posts:0,followers:0,following:0}},stories:[],posts:[],savedPostIds:new Set,followedUsers:new Set,theme:`dark`,toastMessage:null,isCreateModalOpen:!1,isEditProfileOpen:!1,viewingStory:null,viewingPost:null,viewingReel:null,isSidebarExpanded:!0,unreadNotificationsCount:0,unreadMessagesCount:0,setUnreadNotificationsCount:t=>e({unreadNotificationsCount:t}),setUnreadMessagesCount:t=>e({unreadMessagesCount:t}),toggleSidebar:()=>e(e=>({isSidebarExpanded:!e.isSidebarExpanded})),toggleTheme:()=>e(e=>({theme:e.theme===`dark`?`light`:`dark`})),setToastMessage:t=>e({toastMessage:t}),showToast:e=>{T(e)},setCreateModalOpen:t=>e({isCreateModalOpen:t}),setEditProfileOpen:t=>e({isEditProfileOpen:t}),setViewingStory:t=>e({viewingStory:t}),setViewingPost:t=>e({viewingPost:t}),setViewingReel:t=>e({viewingReel:t}),setCurrentUser:t=>e({currentUser:t}),addStory:n=>e(e=>{let r={id:String(Date.now()),username:e.currentUser.username,img:n,isUser:!0};return t().showToast(`Story added`),{stories:[r,...e.stories.filter(e=>!e.isUser)]}})})),tt=(0,Y.createContext)(void 0),nt=()=>{let e=(0,Y.useContext)(tt);if(e===void 0)throw Error(`useAuth must be used within an AuthProvider`);return e};function X(...e){return Be(Le(e))}var Z=e(z(),1);function rt(e){let t=(0,$e.c)(8),n,r;t[0]===e?(n=t[1],r=t[2]):({className:n,...r}=e,t[0]=e,t[1]=n,t[2]=r);let i;t[3]===n?i=t[4]:(i=X(`relative flex size-8 shrink-0 overflow-hidden rounded-full`,n),t[3]=n,t[4]=i);let a;return t[5]!==r||t[6]!==i?(a=(0,Z.jsx)(ce,{"data-slot":`avatar`,className:i,...r}),t[5]=r,t[6]=i,t[7]=a):a=t[7],a}function it(e){let t=(0,$e.c)(8),n,i;t[0]===e?(n=t[1],i=t[2]):({className:n,...i}=e,t[0]=e,t[1]=n,t[2]=i);let a;t[3]===n?a=t[4]:(a=X(`aspect-square size-full`,n),t[3]=n,t[4]=a);let o;return t[5]!==i||t[6]!==a?(o=(0,Z.jsx)(r,{"data-slot":`avatar-image`,className:a,...i}),t[5]=i,t[6]=a,t[7]=o):o=t[7],o}function at(e){let t=(0,$e.c)(8),n,r;t[0]===e?(n=t[1],r=t[2]):({className:n,...r}=e,t[0]=e,t[1]=n,t[2]=r);let i;t[3]===n?i=t[4]:(i=X(`bg-muted flex size-full items-center justify-center rounded-full`,n),t[3]=n,t[4]=i);let a;return t[5]!==r||t[6]!==i?(a=(0,Z.jsx)(le,{"data-slot":`avatar-fallback`,className:i,...r}),t[5]=r,t[6]=i,t[7]=a):a=t[7],a}var ot=P(),st=He(`inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive`,{variants:{variant:{default:`bg-primary text-primary-foreground hover:bg-primary/90`,destructive:`bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60`,outline:`border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50`,secondary:`bg-secondary text-secondary-foreground hover:bg-secondary/80`,ghost:`hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50`,link:`text-primary underline-offset-4 hover:underline`},size:{default:`h-9 px-4 py-2 has-[>svg]:px-3`,sm:`h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5`,lg:`h-10 rounded-md px-6 has-[>svg]:px-4`,icon:`size-9`,"icon-sm":`size-8`,"icon-lg":`size-10`}},defaultVariants:{variant:`default`,size:`default`}});function Q(e){let t=(0,ot.c)(16),n,r,i,a,o;t[0]===e?(n=t[1],r=t[2],i=t[3],a=t[4],o=t[5]):({className:n,variant:i,size:a,asChild:o,...r}=e,t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=a,t[5]=o);let s=i===void 0?`default`:i,c=a===void 0?`default`:a,l=o!==void 0&&o?x:`button`,u;t[6]!==n||t[7]!==c||t[8]!==s?(u=X(st({variant:s,size:c,className:n})),t[6]=n,t[7]=c,t[8]=s,t[9]=u):u=t[9];let d;return t[10]!==l||t[11]!==r||t[12]!==c||t[13]!==u||t[14]!==s?(d=(0,Z.jsx)(l,{"data-slot":`button`,"data-variant":s,"data-size":c,className:u,...r}),t[10]=l,t[11]=r,t[12]=c,t[13]=u,t[14]=s,t[15]=d):d=t[15],d}var ct=P(),lt=()=>{let e=(0,ct.c)(97),{theme:r,toggleTheme:i,currentUser:a,setCreateModalOpen:o,isSidebarExpanded:c,toggleSidebar:l,unreadNotificationsCount:u,unreadMessagesCount:d}=et(),{signOut:f}=nt(),p,m,h,g;e[0]===Symbol.for(`react.memo_cache_sentinel`)?(p={icon:(0,Z.jsx)(te,{size:24}),label:`Home`,path:`/`},m={icon:(0,Z.jsx)(t,{size:24}),label:`Explore`,path:`/explore`},h={icon:(0,Z.jsx)(s,{size:24}),label:`Reels`,path:`/reels`},g=(0,Z.jsx)(ie,{size:24}),e[0]=p,e[1]=m,e[2]=h,e[3]=g):(p=e[0],m=e[1],h=e[2],g=e[3]);let _=d>0?d>99?`99+`:d:void 0,y;e[4]===_?y=e[5]:(y={icon:g,label:`Messages`,path:`/messages`,badge:_},e[4]=_,e[5]=y);let b;e[6]===Symbol.for(`react.memo_cache_sentinel`)?(b=(0,Z.jsx)(Oe,{size:24}),e[6]=b):b=e[6];let x=u>0?u>99?`99+`:u:void 0,S;e[7]===x?S=e[8]:(S={icon:b,label:`Notifications`,path:`/notifications`,badge:x},e[7]=x,e[8]=S);let C;e[9]!==y||e[10]!==S?(C=[p,m,h,y,S],e[9]=y,e[10]=S,e[11]=C):C=e[11];let w=C,T=`hidden md:flex flex-col ${c?`w-[245px]`:`w-[72px]`} h-screen fixed border-r border-border p-4 pb-5 justify-between z-50 transition-all duration-300 bg-background text-foreground`,E=`mb-8 mt-4 ${c?`px-2`:`flex justify-center`}`,O;e[12]===c?O=e[13]:(O=c?(0,Z.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,Z.jsx)(`img`,{src:`/icon.png`,alt:`Logo`,className:`w-8 h-8 object-contain`}),(0,Z.jsx)(`h1`,{className:`text-xl font-bold tracking-tight text-[#006a4e]`,children:`SysMed`})]}):(0,Z.jsx)(D,{to:`/`,className:`flex justify-center items-center`,children:(0,Z.jsx)(`img`,{src:`/icon.png`,alt:`SysMed`,className:`w-8 h-8 object-contain`})}),e[12]=c,e[13]=O);let k;e[14]!==E||e[15]!==O?(k=(0,Z.jsx)(`div`,{className:E,children:O}),e[14]=E,e[15]=O,e[16]=k):k=e[16];let A;e[17]!==c||e[18]!==w?(A=w.map((e,t)=>(0,Z.jsx)(n,{to:e.path,className:ut,children:t=>{let{isActive:n}=t;return(0,Z.jsxs)(I.div,{whileTap:{scale:.98},className:`flex items-center ${c?`gap-4 px-3`:`justify-center`} py-3 rounded-lg hover:bg-muted`,children:[(0,Z.jsxs)(`div`,{className:`relative`,children:[(0,Z.jsx)(`div`,{className:n?`text-[#006a4e]`:``,children:e.icon}),e.badge&&(0,Z.jsx)(`div`,{className:`absolute -top-2 -right-2 bg-[#f42a41] text-white text-[10px] font-bold h-4 min-w-[16px] px-1 flex items-center justify-center rounded-full border-2 border-black`,children:e.badge})]}),c&&(0,Z.jsx)(`span`,{className:`text-base truncate`,children:e.label===`Home`?`Home`:e.label===`Explore`?`Explore`:e.label===`Reels`?`Reels`:e.label===`Messages`?`Messages`:e.label===`Notifications`?`Notifications`:e.label})]})}},t)),e[17]=c,e[18]=w,e[19]=A):A=e[19];let j;e[20]===o?j=e[21]:(j=()=>o(!0),e[20]=o,e[21]=j);let M=!c&&`justify-center px-0`,N;e[22]===M?N=e[23]:(N=X(`flex items-center justify-start w-full gap-4 px-3 py-6 rounded-lg transition-colors cursor-pointer group hover:bg-muted`,M),e[22]=M,e[23]=N);let P;e[24]===Symbol.for(`react.memo_cache_sentinel`)?(P={scale:.98},e[24]=P):P=e[24];let F;e[25]===Symbol.for(`react.memo_cache_sentinel`)?(F=(0,Z.jsx)(`div`,{className:`relative`,children:(0,Z.jsx)(v,{size:24})}),e[25]=F):F=e[25];let R;e[26]===c?R=e[27]:(R=c&&(0,Z.jsx)(`span`,{className:`text-base truncate ml-2 font-normal`,children:`Create`}),e[26]=c,e[27]=R);let z;e[28]===R?z=e[29]:(z=(0,Z.jsxs)(I.div,{whileTap:P,className:`w-full h-full flex items-center`,children:[F,R]}),e[28]=R,e[29]=z);let B;e[30]!==j||e[31]!==N||e[32]!==z?(B=(0,Z.jsx)(Q,{variant:`ghost`,onClick:j,className:N,asChild:!0,children:z}),e[30]=j,e[31]=N,e[32]=z,e[33]=B):B=e[33];let V=`/profile/${a.username}`,H;e[34]!==a.avatar||e[35]!==a.username?.[0]||e[36]!==c?(H=e=>{let{isActive:t}=e;return(0,Z.jsxs)(I.div,{whileTap:{scale:.98},className:`flex items-center ${c?`gap-4 px-3`:`justify-center`} py-3 rounded-lg hover:bg-muted`,children:[(0,Z.jsxs)(rt,{className:X(`w-6 h-6`,t&&`border-2 border-[#006a4e]`),children:[(0,Z.jsx)(it,{src:a.avatar}),(0,Z.jsx)(at,{children:a.username?.[0]?.toUpperCase()||`?`})]}),c&&(0,Z.jsx)(`span`,{className:`text-base truncate`,children:`Profile`})]})},e[34]=a.avatar,e[35]=a.username?.[0],e[36]=c,e[37]=H):H=e[37];let U;e[38]!==V||e[39]!==H?(U=(0,Z.jsx)(n,{to:V,className:dt,children:H}),e[38]=V,e[39]=H,e[40]=U):U=e[40];let W;e[41]!==A||e[42]!==B||e[43]!==U?(W=(0,Z.jsxs)(`div`,{className:`flex flex-col gap-2`,children:[A,B,U]}),e[41]=A,e[42]=B,e[43]=U,e[44]=W):W=e[44];let G;e[45]!==k||e[46]!==W?(G=(0,Z.jsxs)(`div`,{children:[k,W]}),e[45]=k,e[46]=W,e[47]=G):G=e[47];let ne=!c&&`justify-center px-0`,K;e[48]===ne?K=e[49]:(K=X(`flex items-center justify-start w-full gap-4 px-3 py-6 rounded-lg transition-colors cursor-pointer group hover:bg-muted`,ne),e[48]=ne,e[49]=K);let re;e[50]===Symbol.for(`react.memo_cache_sentinel`)?(re={scale:.98},e[50]=re):re=e[50];let q;e[51]===r?q=e[52]:(q=r===`dark`?(0,Z.jsx)(L,{size:24}):(0,Z.jsx)(de,{size:24}),e[51]=r,e[52]=q);let J;e[53]===c?J=e[54]:(J=c&&(0,Z.jsx)(`span`,{className:`text-base ml-4 font-normal`,children:`Switch Appearance`}),e[53]=c,e[54]=J);let oe;e[55]!==q||e[56]!==J?(oe=(0,Z.jsxs)(I.div,{whileTap:re,className:`w-full h-full flex items-center`,children:[q,J]}),e[55]=q,e[56]=J,e[57]=oe):oe=e[57];let se;e[58]!==K||e[59]!==oe||e[60]!==i?(se=(0,Z.jsx)(Q,{variant:`ghost`,onClick:i,className:K,asChild:!0,children:oe}),e[58]=K,e[59]=oe,e[60]=i,e[61]=se):se=e[61];let ce=!c&&`justify-center px-0`,le;e[62]===ce?le=e[63]:(le=X(`flex items-center justify-start w-full gap-4 px-3 py-6 rounded-lg transition-colors cursor-pointer group hover:bg-muted`,ce),e[62]=ce,e[63]=le);let ue;e[64]===Symbol.for(`react.memo_cache_sentinel`)?(ue={scale:.98},e[64]=ue):ue=e[64];let fe,pe;e[65]===c?(fe=e[66],pe=e[67]):(fe=c?(0,Z.jsx)(he,{size:24}):(0,Z.jsx)(ee,{size:24}),pe=c&&(0,Z.jsx)(`span`,{className:`text-base ml-4 font-normal`,children:`Collapse`}),e[65]=c,e[66]=fe,e[67]=pe);let me;e[68]!==fe||e[69]!==pe?(me=(0,Z.jsxs)(I.div,{whileTap:ue,className:`w-full h-full flex items-center`,children:[fe,pe]}),e[68]=fe,e[69]=pe,e[70]=me):me=e[70];let ge;e[71]!==le||e[72]!==me||e[73]!==l?(ge=(0,Z.jsx)(Q,{variant:`ghost`,onClick:l,className:le,asChild:!0,children:me}),e[71]=le,e[72]=me,e[73]=l,e[74]=ge):ge=e[74];let _e;e[75]===f?_e=e[76]:(_e=()=>f(),e[75]=f,e[76]=_e);let ve=!c&&`justify-center px-0`,ye;e[77]===ve?ye=e[78]:(ye=X(`flex items-center justify-start w-full gap-4 px-3 py-6 rounded-lg transition-colors cursor-pointer group hover:bg-muted text-destructive hover:text-destructive/80`,ve),e[77]=ve,e[78]=ye);let be;e[79]===Symbol.for(`react.memo_cache_sentinel`)?(be={scale:.98},e[79]=be):be=e[79];let xe;e[80]===Symbol.for(`react.memo_cache_sentinel`)?(xe=(0,Z.jsx)(ae,{size:24}),e[80]=xe):xe=e[80];let Se;e[81]===c?Se=e[82]:(Se=c&&(0,Z.jsx)(`span`,{className:`text-base ml-4 font-normal`,children:`Log Out`}),e[81]=c,e[82]=Se);let Ce;e[83]===Se?Ce=e[84]:(Ce=(0,Z.jsxs)(I.div,{whileTap:be,className:`w-full h-full flex items-center`,children:[xe,Se]}),e[83]=Se,e[84]=Ce);let we;e[85]!==_e||e[86]!==ye||e[87]!==Ce?(we=(0,Z.jsx)(Q,{variant:`ghost`,onClick:_e,className:ye,asChild:!0,children:Ce}),e[85]=_e,e[86]=ye,e[87]=Ce,e[88]=we):we=e[88];let Te;e[89]!==se||e[90]!==ge||e[91]!==we?(Te=(0,Z.jsxs)(`div`,{className:`flex flex-col gap-2`,children:[se,ge,we]}),e[89]=se,e[90]=ge,e[91]=we,e[92]=Te):Te=e[92];let Ee;return e[93]!==T||e[94]!==G||e[95]!==Te?(Ee=(0,Z.jsxs)(`div`,{className:T,children:[G,Te]}),e[93]=T,e[94]=G,e[95]=Te,e[96]=Ee):Ee=e[96],Ee};function ut(e){let{isActive:t}=e;return`block rounded-lg transition-colors cursor-pointer group ${t?`font-bold`:``}`}function dt(e){let{isActive:t}=e;return`block rounded-lg transition-colors cursor-pointer group ${t?`font-bold`:``}`}var ft=P(),pt=()=>{let e=(0,ft.c)(19),{currentUser:r,setCreateModalOpen:i}=et(),a;e[0]===Symbol.for(`react.memo_cache_sentinel`)?(a=[{icon:(0,Z.jsx)(te,{size:24}),label:`Home`,path:`/`},{icon:(0,Z.jsx)(t,{size:24}),label:`Explore`,path:`/explore`},{icon:(0,Z.jsx)(s,{size:24}),label:`Reels`,path:`/reels`}],e[0]=a):a=e[0];let o=a,c;e[1]===Symbol.for(`react.memo_cache_sentinel`)?(c=o.map(ht),e[1]=c):c=e[1];let l;e[2]===Symbol.for(`react.memo_cache_sentinel`)?(l={scale:.8},e[2]=l):l=e[2];let u;e[3]===i?u=e[4]:(u=()=>i(!0),e[3]=i,e[4]=u);let d;e[5]===Symbol.for(`react.memo_cache_sentinel`)?(d=(0,Z.jsx)(v,{size:24}),e[5]=d):d=e[5];let f;e[6]===u?f=e[7]:(f=(0,Z.jsx)(I.div,{whileTap:l,className:`p-3`,onClick:u,children:d}),e[6]=u,e[7]=f);let p;e[8]===Symbol.for(`react.memo_cache_sentinel`)?(p={scale:.8},e[8]=p):p=e[8];let m;e[9]===Symbol.for(`react.memo_cache_sentinel`)?(m=(0,Z.jsx)(n,{to:`/messages`,className:gt,children:(0,Z.jsx)(I.div,{whileTap:p,className:`p-3`,children:(0,Z.jsx)(ie,{size:24})})}),e[9]=m):m=e[9];let h=`/profile/${r.username}`,g;e[10]!==r.avatar||e[11]!==r.username?.[0]?(g=e=>{let{isActive:t}=e;return(0,Z.jsx)(I.div,{whileTap:{scale:.8},className:`p-3`,children:(0,Z.jsxs)(rt,{className:X(`w-6 h-6`,t&&`border-2 border-[#006a4e]`),children:[(0,Z.jsx)(it,{src:r.avatar}),(0,Z.jsx)(at,{children:r.username?.[0]?.toUpperCase()||`?`})]})})},e[10]=r.avatar,e[11]=r.username?.[0],e[12]=g):g=e[12];let _;e[13]!==h||e[14]!==g?(_=(0,Z.jsx)(n,{to:h,className:_t,children:g}),e[13]=h,e[14]=g,e[15]=_):_=e[15];let y;return e[16]!==_||e[17]!==f?(y=(0,Z.jsxs)(`div`,{className:`md:hidden fixed bottom-0 left-0 right-0 border-t border-border flex justify-around items-center h-12 z-50 px-2 pb-safe bg-background/90 text-foreground backdrop-blur-md bg-opacity-90`,children:[c,f,m,_]}),e[16]=_,e[17]=f,e[18]=y):y=e[18],y};function mt(e){let{isActive:t}=e;return`block ${t?`text-[#006a4e]`:``}`}function ht(e,t){return(0,Z.jsx)(n,{to:e.path,className:mt,children:(0,Z.jsx)(I.div,{whileTap:{scale:.8},className:`p-3`,children:e.icon})},t)}function gt(e){let{isActive:t}=e;return`block ${t?`text-[#006a4e]`:``}`}function _t(e){let{isActive:t}=e;return`block ${t?`text-[#006a4e]`:``}`}var vt=P(),yt=()=>{let e=(0,vt.c)(14),{isSidebarExpanded:t}=et(),{user:n}=nt(),r=_e(),i;e[0]===r.pathname?i=e[1]:(i=r.pathname.startsWith(`/messages`),e[0]=r.pathname,e[1]=i);let a=i,o;e[2]===r.pathname?o=e[3]:(o=r.pathname.startsWith(`/reels`),e[2]=r.pathname,e[3]=o);let s=o,c;e[4]!==a||e[5]!==s||e[6]!==n?(c=n?(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(lt,{}),!a&&!s&&(0,Z.jsx)(pt,{})]}):(0,Z.jsx)(`div`,{className:`fixed top-4 right-4 z-[60]`,children:(0,Z.jsx)(D,{to:`/`,className:`bg-[#006a4e] text-white px-4 py-2 rounded-lg font-semibold text-sm shadow-lg hover:bg-[#00523c] transition-colors`,children:`Log In`})}),e[4]=a,e[5]=s,e[6]=n,e[7]=c):c=e[7];let l=`flex-grow ${n?t?`md:ml-[245px]`:`md:ml-[72px]`:``} flex justify-center transition-all duration-300 ${n&&!a&&!s?`pb-14 md:pb-0`:``}`,u;e[8]===Symbol.for(`react.memo_cache_sentinel`)?(u=(0,Z.jsx)(K,{}),e[8]=u):u=e[8];let d;e[9]===l?d=e[10]:(d=(0,Z.jsx)(`main`,{className:l,children:u}),e[9]=l,e[10]=d);let f;return e[11]!==c||e[12]!==d?(f=(0,Z.jsxs)(`div`,{className:`min-h-screen font-['Hind_Siliguri'] flex flex-col md:flex-row transition-colors duration-300 bg-background text-foreground`,children:[c,d]}),e[11]=c,e[12]=d,e[13]=f):f=e[13],f};const $=Ke(`https://uyffyqlgyjieayivgvhg.supabase.co`,`sb_publishable_WFDkcqORIdT_6pMJSoxjQg_EMHEKNfb`);var bt=P();const xt=()=>{let e=(0,bt.c)(12),{user:t}=nt(),n;e[0]===t?n=e[1]:(n=async()=>{if(t)try{let e=new Date().toISOString();await $.from(`profiles`).update({last_seen:e,is_online:!0}).eq(`id`,t.id)}catch(e){let t=e;console.error(`Error updating last seen:`,t)}},e[0]=t,e[1]=n);let r=n,i;e[2]===t?i=e[3]:(i=async()=>{if(t)try{let e=new Date().toISOString();await $.from(`profiles`).update({last_seen:e,is_online:!1}).eq(`id`,t.id)}catch(e){let t=e;console.error(`Error updating offline status:`,t)}},e[2]=t,e[3]=i);let a=i,o,s;e[4]!==r||e[5]!==a||e[6]!==t?(o=()=>{if(!t)return;r();let e=setInterval(r,3e4),n=()=>{document.hidden?a():r()},i=()=>{a()};return document.addEventListener(`visibilitychange`,n),window.addEventListener(`beforeunload`,i),()=>{clearInterval(e),document.removeEventListener(`visibilitychange`,n),window.removeEventListener(`beforeunload`,i)}},s=[t,r,a],e[4]=r,e[5]=a,e[6]=t,e[7]=o,e[8]=s):(o=e[7],s=e[8]),(0,Y.useEffect)(o,s);let c;return e[9]!==r||e[10]!==a?(c={updateLastSeen:r,updateOfflineStatus:a},e[9]=r,e[10]=a,e[11]=c):c=e[11],c};var St=P(),Ct=e(Ie(),1);const wt=[`feed`],Tt=e=>{let t=(0,St.c)(2),n;return t[0]===e?n=t[1]:(n={queryKey:wt,queryFn:async t=>{let{pageParam:n}=t,r=n===void 0?0:n,{data:i,error:a}=await $.rpc(`get_feed`,{current_user_id:e,limit_count:10,offset_count:r*10});if(a)throw a;return(i||[]).map(Et)},initialPageParam:0,getNextPageParam:Dt},t[0]=e,t[1]=n),y(n)};function Et(e){return{id:e.id,user:{id:e.user_id,username:e.username,name:e.full_name||e.username,avatar:e.avatar_url||``,isVerified:e.is_verified||!1},content:{type:`image`,src:e.image_url},likes:e.likes_count||0,caption:e.caption||``,comments:e.comments_count||0,time:(0,Ct.default)(e.created_at).fromNow(),createdAt:e.created_at,isVerified:e.is_verified||!1,hasLiked:e.has_liked,hasSaved:e.has_saved}}function Dt(e,t){return e.length===10?t.length:void 0}var Ot=P(),kt=e(Ie(),1);const At=e=>[`profile`,e],jt=(e,t)=>{let n=(0,Ot.c)(9),r=e||``,i;n[0]===r?i=n[1]:(i=At(r),n[0]=r,n[1]=i);let a=!!e,o;n[2]!==t||n[3]!==e?(o=async()=>{if(!e)throw Error(`Username required`);let{data:n,error:r}=await $.from(`profiles`).select(`id, username, full_name, avatar_url, bio, is_verified`).eq(`username`,e).single();if(r)throw r;let i=n,{count:a}=await $.from(`posts`).select(`*`,{count:`exact`,head:!0}).eq(`user_id`,i.id),{count:o}=await $.from(`follows`).select(`*`,{count:`exact`,head:!0}).eq(`following_id`,i.id),{count:s}=await $.from(`follows`).select(`*`,{count:`exact`,head:!0}).eq(`follower_id`,i.id),{data:c}=await $.from(`posts`).select(`
           id,
           image_url,
           caption,
           created_at,
           likes (count),
           comments (count)
        `).eq(`user_id`,i.id).order(`created_at`,{ascending:!1}),l=c||[],u=new Set;if(t&&l.length>0){let e=l.map(Mt),{data:n}=await $.from(`likes`).select(`post_id`).eq(`user_id`,t).in(`post_id`,e);n&&n.forEach(e=>u.add(e.post_id||``))}let d=!1;if(t&&t!==i.id){let{count:e}=await $.from(`follows`).select(`*`,{count:`exact`,head:!0}).match({follower_id:t,following_id:i.id});d=!!e&&e>0}let f=l.map(e=>{let t=e.likes,n=e.comments;return{id:e.id,user:{id:i.id,username:i.username,name:i.full_name||i.username,avatar:i.avatar_url||``,isVerified:i.is_verified||!1},content:{type:`image`,src:e.image_url},likes:t[0]?.count||0,caption:e.caption||``,comments:n[0]?.count||0,time:(0,kt.default)(e.created_at).fromNow(),isVerified:i.is_verified||!1,hasLiked:u.has(e.id)}});return{user:{id:i.id,username:i.username,name:i.full_name||``,avatar:i.avatar_url||``,bio:i.bio||``,isVerified:i.is_verified||!1,stats:{posts:a||0,followers:o||0,following:s||0},isFollowing:d},posts:f}},n[2]=t,n[3]=e,n[4]=o):o=n[4];let s;return n[5]!==i||n[6]!==a||n[7]!==o?(s={queryKey:i,enabled:a,queryFn:o},n[5]=i,n[6]=a,n[7]=o,n[8]=s):s=n[8],_(s)};function Mt(e){return e.id}var Nt=P(),Pt=e(Ie(),1);const Ft=()=>{let e=(0,Nt.c)(2),t=V(),n;return e[0]===t?n=e[1]:(n={mutationFn:It,onSuccess:(e,n)=>{t.invalidateQueries({queryKey:wt}),t.invalidateQueries({queryKey:At(n.username)})}},e[0]=t,e[1]=n),ge(n)};async function It(e){let{file:t,caption:n,userId:r}=e,i=t.name.split(`.`).pop(),a=`${r}/${(0,Pt.default)().valueOf()}.${i}`,{error:o}=await $.storage.from(`posts`).upload(a,t,{cacheControl:`3600`,upsert:!1,contentType:t.type});if(o)throw o;let{data:s}=$.storage.from(`posts`).getPublicUrl(a),{publicUrl:c}=s,{data:l,error:u}=await $.from(`posts`).insert({user_id:r,caption:n,image_url:c}).select().single();if(u)throw u;return l}var Lt=P();const Rt=[`reels`],zt=e=>{let t=(0,Lt.c)(2),n;return t[0]===e?n=t[1]:(n={queryKey:Rt,initialPageParam:0,queryFn:async t=>{let{pageParam:n}=t,r=(n===void 0?0:n)*5,i=r+4,{data:a,error:o}=await $.from(`reels`).select(`
          *,
          profiles (username, full_name, avatar_url, is_verified),
          likes (count),
          comments (count)
        `).order(`created_at`,{ascending:!1}).range(r,i);if(o)throw o;let s=a||[],c=s.map(Bt),l=new Set,u=Array.from(new Set(s.map(Vt))),d=new Set;if(e){if(c.length>0){let{data:t}=await $.from(`likes`).select(`reel_id`).eq(`user_id`,e).in(`reel_id`,c);t&&t.forEach(e=>l.add(e.reel_id||``))}if(u.length>0){let{data:t}=await $.from(`follows`).select(`following_id`).eq(`follower_id`,e).in(`following_id`,u);t&&t.forEach(e=>d.add(e.following_id))}}return s.map(e=>({id:e.id,userId:e.user_id,user:{id:e.user_id,username:e.profiles?.username||`Unknown`,name:e.profiles?.full_name||`Unknown`,avatar:e.profiles?.avatar_url||``,isVerified:e.profiles?.is_verified||!1,isFollowing:d.has(e.user_id)},src:e.video_url,likes:e.likes?.[0]?.count||0,comments:e.comments?.[0]?.count||0,caption:e.caption||``,audio:e.audio_track_name||`Original Audio`,hasLiked:l.has(e.id)}))},getNextPageParam:Ht},t[0]=e,t[1]=n),y(n)};function Bt(e){return e.id}function Vt(e){return e.user_id}function Ht(e,t){return e.length===5?t.length:void 0}var Ut=P(),Wt=e(Ie(),1);const Gt=()=>{let e=(0,Ut.c)(2),t=V(),n;return e[0]===t?n=e[1]:(n={mutationFn:Kt,onSuccess:()=>{t.invalidateQueries({queryKey:Rt})}},e[0]=t,e[1]=n),ge(n)};async function Kt(e){let{file:t,caption:n,userId:r}=e,i=t.name.split(`.`).pop(),a=`${r}/${(0,Wt.default)().valueOf()}.${i}`,{error:o}=await $.storage.from(`reels`).upload(a,t,{cacheControl:`3600`,upsert:!1,contentType:t.type});if(o)throw o;let{data:s}=$.storage.from(`reels`).getPublicUrl(a),{publicUrl:c}=s,{data:l,error:u}=await $.from(`reels`).insert({user_id:r,caption:n,video_url:c}).select().single();if(u)throw u;return l}var qt=P();const Jt=[`stories`],Yt=e=>{let t=(0,qt.c)(2),n;return t[0]===e?n=t[1]:(n={queryKey:Jt,queryFn:async()=>{let{data:t,error:n}=await $.from(`stories`).select(`
            *,
            user:profiles (
                username,
                avatar_url,
                is_verified
            )
        `).order(`created_at`,{ascending:!1});if(n)throw n;return t.map(t=>({id:t.id,username:t.user?.username||`User`,userAvatar:t.user?.avatar_url||``,img:t.media_url,isUser:t.user_id===e,isVerified:t.user?.is_verified||!1,createdAt:t.created_at}))}},t[0]=e,t[1]=n),_(n)};var Xt=P(),Zt=e(Ie(),1);const Qt=()=>{let e=(0,Xt.c)(2),t=V(),n;return e[0]===t?n=e[1]:(n={mutationFn:$t,onSuccess:()=>{t.invalidateQueries({queryKey:Jt})}},e[0]=t,e[1]=n),ge(n)};async function $t(e){let{file:t,userId:n}=e,r=t.name.split(`.`).pop(),i=`${`${n}-${(0,Zt.default)().valueOf()}.${r}`}`,{error:a}=await $.storage.from(`stories`).upload(i,t);if(a)throw a;let{data:o}=$.storage.from(`stories`).getPublicUrl(i),{publicUrl:s}=o,c=(0,Zt.default)().add(24,`hour`),{error:l}=await $.from(`stories`).insert({user_id:n,media_url:s,expires_at:c.toISOString()});if(l)throw l}var en=P();function tn(e){let t=(0,en.c)(8),n,r;t[0]===e?(n=t[1],r=t[2]):({className:n,...r}=e,t[0]=e,t[1]=n,t[2]=r);let i;t[3]===n?i=t[4]:(i=X(`border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm`,n),t[3]=n,t[4]=i);let a;return t[5]!==r||t[6]!==i?(a=(0,Z.jsx)(`textarea`,{"data-slot":`textarea`,className:i,...r}),t[5]=r,t[6]=i,t[7]=a):a=t[7],a}var nn=P(),rn=e=>{let t=(0,nn.c)(39),n,r,i,a,o,s,c,l,u,d;t[0]===e?(n=t[1],r=t[2],i=t[3],a=t[4],o=t[5],s=t[6],c=t[7],l=t[8],u=t[9],d=t[10]):({src:u,alt:n,className:i,imgClassName:c,fallbackColor:s,width:o,height:a,quality:d,blurHash:r,...l}=e,t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=a,t[5]=o,t[6]=s,t[7]=c,t[8]=l,t[9]=u,t[10]=d);let f=d===void 0?75:d,[p,h]=(0,Y.useState)(!1),[g,_]=(0,Y.useState)(!1),v=u;if(u&&u.includes(`storage.v1/object/public/`)){let e;t[11]!==a||t[12]!==o||t[13]!==f?(e=[],o&&e.push(`width=${o}`),a&&e.push(`height=${a}`),e.push(`quality=${f}`),e.push(`format=webp`),t[11]=a,t[12]=o,t[13]=f,t[14]=e):e=t[14];let n=u.includes(`?`)?`&`:`?`;v=`${u}${n}render=image&${e.join(`&`)}`}let y=s||`bg-zinc-200 dark:bg-zinc-800`;if(!u){let e=`relative overflow-hidden ${i} ${y}`,n;t[15]===Symbol.for(`react.memo_cache_sentinel`)?(n=(0,Z.jsx)(`div`,{className:`absolute inset-0 flex items-center justify-center text-zinc-400 text-xs`,children:`No Image`}),t[15]=n):n=t[15];let r;return t[16]===e?r=t[17]:(r=(0,Z.jsx)(`div`,{className:e,children:n}),t[16]=e,t[17]=r),r}let b=`relative overflow-hidden ${i}`,x;t[18]!==y||t[19]!==r||t[20]!==g||t[21]!==p?(x=!p&&!g&&(0,Z.jsx)(I.div,{initial:{opacity:1},exit:{opacity:0},className:`absolute inset-0 z-10 ${y} ${r?``:`animate-pulse`}`,children:r&&(0,Z.jsx)(C,{hash:r,width:`100%`,height:`100%`,resolutionX:32,resolutionY:32,punch:1})}),t[18]=y,t[19]=r,t[20]=g,t[21]=p,t[22]=x):x=t[22];let S;t[23]===x?S=t[24]:(S=(0,Z.jsx)(m,{children:x}),t[23]=x,t[24]=S);let w=`w-full h-full transition-opacity duration-500 ${c||`object-cover`} ${p?`opacity-100`:`opacity-0`}`,T,E;t[25]===Symbol.for(`react.memo_cache_sentinel`)?(T=()=>h(!0),E=()=>_(!0),t[25]=T,t[26]=E):(T=t[25],E=t[26]);let D;t[27]!==n||t[28]!==v||t[29]!==l||t[30]!==w?(D=(0,Z.jsx)(`img`,{src:v,alt:n,className:w,onLoad:T,onError:E,loading:`lazy`,...l}),t[27]=n,t[28]=v,t[29]=l,t[30]=w,t[31]=D):D=t[31];let O;t[32]===g?O=t[33]:(O=g&&(0,Z.jsx)(`div`,{className:`absolute inset-0 flex items-center justify-center bg-zinc-100 dark:bg-zinc-900 text-zinc-400 text-xs`,children:`Load failed`}),t[32]=g,t[33]=O);let k;return t[34]!==b||t[35]!==S||t[36]!==D||t[37]!==O?(k=(0,Z.jsxs)(`div`,{className:b,children:[S,D,O]}),t[34]=b,t[35]=S,t[36]=D,t[37]=O,t[38]=k):k=t[38],k},an=({onFileSelect:e,accept:t={"image/*":[],"video/*":[]},maxSize:n=100*1024*1024})=>{let{theme:r}=et(),{getRootProps:i,getInputProps:a,isDragActive:s,isDragReject:c}=o({onDrop:(0,Y.useCallback)(t=>{t&&t.length>0&&e(t[0])},[e]),accept:t,maxSize:n,multiple:!1}),l=s?`border-[#0095f6]`:c?`border-red-500`:r===`dark`?`border-zinc-700`:`border-zinc-300`,u=s?`bg-blue-500/10`:`bg-transparent`;return(0,Z.jsxs)(`div`,{...i(),className:`w-full h-full min-h-[300px] flex flex-col items-center justify-center border-2 border-dashed ${l} ${u} rounded-xl transition-colors cursor-pointer p-8`,children:[(0,Z.jsx)(`input`,{...a()}),(0,Z.jsxs)(`div`,{className:`flex flex-col items-center gap-4 text-center`,children:[(0,Z.jsxs)(`div`,{className:`flex gap-4 mb-2`,children:[(0,Z.jsx)(Ae,{size:40,className:`${r===`dark`?`text-white`:`text-black`} opacity-80`}),(0,Z.jsx)(je,{size:40,className:`${r===`dark`?`text-white`:`text-black`} opacity-80`})]}),s?(0,Z.jsx)(`p`,{className:`text-xl font-medium text-[#0095f6]`,children:`Drop files here`}):c?(0,Z.jsx)(`p`,{className:`text-xl font-medium text-red-500`,children:`File not supported`}):(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(`p`,{className:`text-xl font-light ${r===`dark`?`text-white`:`text-black`}`,children:`Drag photos or videos here`}),(0,Z.jsx)(`button`,{className:`bg-[#0095f6] hover:bg-[#1877f2] text-white px-4 py-2 rounded-lg text-sm font-semibold transition-colors mt-4`,children:`Select`})]})]})]})},on=P(),sn=e=>{let t=(0,on.c)(13),{overlays:n,setOverlays:r,activeId:i,setActiveId:a,containerRef:o}=e,[s,c]=(0,Y.useState)(null),l=(0,Y.useRef)(!1),u=(0,Y.useRef)({x:0,y:0}),d=(0,Y.useRef)({x:0,y:0}),f=(0,Y.useRef)(null),p=(0,Y.useRef)(!1),m,h;t[0]===o?(m=t[1],h=t[2]):(m=()=>{c(o.current)},h=[o],t[0]=o,t[1]=m,t[2]=h),(0,Y.useLayoutEffect)(m,h);let g;t[3]===r?g=t[4]:(g=(e,t)=>{r(n=>n.map(n=>n.id===e?{...n,...t}:n))},t[3]=r,t[4]=g);let _=g,v=n.map(e=>{let t=e.type===`text`&&e.background,n=t?e.color||`white`:`transparent`,r=t?e.color===`#FFFFFF`||e.color===`#FFFF00`?`#000000`:`#FFFFFF`:e.color||`white`;return(0,Z.jsx)(`div`,{id:e.id,className:`absolute cursor-move pointer-events-auto origin-center touch-none select-none`,style:{transform:`translate(${e.x}px, ${e.y}px) rotate(${e.rotation}deg) scale(${e.scale})`,color:r,backgroundColor:n,padding:t?`4px 12px`:`0px`,borderRadius:t?`8px`:`0px`,fontSize:e.fontSize||32,fontFamily:e.fontFamily||`sans-serif`,fontWeight:`bold`,textShadow:t?`none`:`1px 1px 2px rgba(0,0,0,0.8)`,whiteSpace:`pre-wrap`,zIndex:e.id===i?50:10,textAlign:`center`,touchAction:`none`},onClick:cn,onPointerDown:t=>{t.stopPropagation(),i!==e.id&&(l.current=!0,f.current=e.id,u.current={x:t.clientX,y:t.clientY},d.current={x:e.x,y:e.y},p.current=!1,t.currentTarget.setPointerCapture(t.pointerId))},onPointerMove:t=>{if(t.stopPropagation(),l.current&&f.current===e.id){let n=t.clientX-u.current.x,r=t.clientY-u.current.y;(Math.abs(n)>2||Math.abs(r)>2)&&(p.current=!0),_(e.id,{x:d.current.x+n,y:d.current.y+r})}},onPointerUp:t=>{t.stopPropagation(),l.current&&(l.current=!1,f.current=null,t.currentTarget.releasePointerCapture(t.pointerId),a(e.id))},children:e.content},e.id)}),y;t[5]!==i||t[6]!==s||t[7]!==n||t[8]!==_?(y=i&&s&&(0,Z.jsx)(j,{target:`#${i}`,container:s,draggable:!0,throttleDrag:0,scalable:!0,throttleScale:0,rotatable:!0,throttleRotate:0,pinchable:!0,origin:!1,keepRatio:!0,renderDirections:[`nw`,`ne`,`se`,`sw`],onDragStart:e=>{e.set([n.find(e=>e.id===i)?.x||0,n.find(e=>e.id===i)?.y||0])},onDrag:ln,onDragEnd:e=>{e.lastEvent&&_(i,{x:e.lastEvent.translate[0],y:e.lastEvent.translate[1]})},onScaleStart:e=>{let t=n.find(e=>e.id===i);e.set([t?.scale||1,t?.scale||1]),e.dragStart&&e.dragStart.set([t?.x||0,t?.y||0])},onScale:un,onScaleEnd:e=>{e.lastEvent&&_(i,{scale:e.lastEvent.scale[0],x:e.lastEvent.drag.translate[0],y:e.lastEvent.drag.translate[1]})},onRotateStart:e=>{e.set(n.find(e=>e.id===i)?.rotation||0)},onRotate:dn,onRotateEnd:e=>{e.lastEvent&&_(i,{rotation:e.lastEvent.rotation})},onPinch:fn,onPinchEnd:e=>{e.lastEvent&&_(i,{scale:e.lastEvent.scale[0],rotation:e.lastEvent.rotation,x:e.lastEvent.drag.translate[0],y:e.lastEvent.drag.translate[1]})}}),t[5]=i,t[6]=s,t[7]=n,t[8]=_,t[9]=y):y=t[9];let b;return t[10]!==v||t[11]!==y?(b=(0,Z.jsxs)(`div`,{className:`absolute inset-0 pointer-events-none overflow-hidden`,children:[v,y]}),t[10]=v,t[11]=y,t[12]=b):b=t[12],b};function cn(e){e.stopPropagation()}function ln(e){e.target.style.transform=e.transform}function un(e){e.target.style.transform=e.drag.transform}function dn(e){e.target.style.transform=e.drag.transform}function fn(e){e.target.style.transform=e.drag.transform}const pn=e=>new Promise((t,n)=>{let r=new Image;r.addEventListener(`load`,()=>t(r)),r.addEventListener(`error`,e=>n(e)),r.setAttribute(`crossOrigin`,`anonymous`),r.src=e});function mn(e){return e*Math.PI/180}function hn(e,t,n){let r=mn(n);return{width:Math.abs(Math.cos(r)*e)+Math.abs(Math.sin(r)*t),height:Math.abs(Math.sin(r)*e)+Math.abs(Math.cos(r)*t)}}async function gn(e,t,n=0,r={horizontal:!1,vertical:!1}){let i=await pn(e),a=document.createElement(`canvas`),o=a.getContext(`2d`);if(!o)return null;let s=mn(n),{width:c,height:l}=hn(i.width,i.height,n);a.width=c,a.height=l,o.translate(c/2,l/2),o.rotate(s),o.scale(r.horizontal?-1:1,r.vertical?-1:1),o.translate(-i.width/2,-i.height/2),o.drawImage(i,0,0);let u=o.getImageData(t.x,t.y,t.width,t.height);return a.width=t.width,a.height=t.height,o.putImageData(u,0,0),new Promise(e=>{a.toBlob(t=>{e(t)},`image/jpeg`)})}var _n=P(),vn=[`#FFFFFF`,`#000000`,`#FF0000`,`#00FF00`,`#0000FF`,`#FFFF00`,`#FF00FF`,`#FFA500`,`#800080`,`#008080`],yn=[{name:`Classic`,family:`sans-serif`},{name:`Serif`,family:`serif`},{name:`Mono`,family:`monospace`},{name:`Rounded`,family:`ui-rounded, system-ui, sans-serif`},{name:`Cursive`,family:`cursive`}],bn=e=>{let t=(0,_n.c)(83),{file:n,onSave:r,onCancel:i}=e,[o,s]=(0,Y.useState)(`edit`),l;t[0]===n.type?l=t[1]:(l=n.type.startsWith(`video/`),t[0]=n.type,t[1]=l);let u=l,[f,p]=(0,Y.useState)(``),m;t[2]===Symbol.for(`react.memo_cache_sentinel`)?(m=[],t[2]=m):m=t[2];let _=(0,Y.useRef)(m),v,y;t[3]===n?(v=t[4],y=t[5]):(v=()=>{if(!n)return;let e=URL.createObjectURL(n);return p(e),_.current.push(e),()=>{_.current.forEach(xn),_.current=[]}},y=[n],t[3]=n,t[4]=v,t[5]=y),Y.useEffect(v,y);let x;t[6]===Symbol.for(`react.memo_cache_sentinel`)?(x={x:0,y:0},t[6]=x):x=t[6];let[S,C]=(0,Y.useState)(x),[w,T]=(0,Y.useState)(1),[E,D]=(0,Y.useState)(.8),[O,k]=(0,Y.useState)(1),[A,j]=(0,Y.useState)(null),P;t[7]===Symbol.for(`react.memo_cache_sentinel`)?(P=[],t[7]=P):P=t[7];let[I,L]=(0,Y.useState)(P),[R,z]=(0,Y.useState)(null),V=(0,Y.useRef)(null),[H,U]=(0,Y.useState)(!1),[W,ee]=(0,Y.useState)(`#FFFFFF`),[G,te]=(0,Y.useState)(yn[0].family),[ne,K]=(0,Y.useState)(!1),[ie,q]=(0,Y.useState)(``),[J,ae]=(0,Y.useState)(!1),oe;t[8]===Symbol.for(`react.memo_cache_sentinel`)?(oe=(e,t)=>{j(t)},t[8]=oe):oe=t[8];let se=oe,ce;t[9]===Symbol.for(`react.memo_cache_sentinel`)?(ce=e=>{k(e.width/e.height)},t[9]=ce):ce=t[9];let le=ce,de;t[10]!==A||t[11]!==f?(de=async()=>{if(A)try{let e=await gn(f,A);if(e){let t=URL.createObjectURL(e);_.current.push(t),p(t),s(`edit`),C({x:0,y:0}),T(1)}}catch(e){let t=e;console.error(`Crop save failed`,t)}},t[10]=A,t[11]=f,t[12]=de):de=t[12];let fe=de,pe;t[13]===Symbol.for(`react.memo_cache_sentinel`)?(pe=()=>{let e=`text-${Date.now()}`,t=0,n=0;if(V.current){let e=V.current.getBoundingClientRect();t=e.width/2,n=e.height/2}ee(`#FFFFFF`),te(yn[0].family),ae(!1),q(``);let r={id:e,type:`text`,content:``,x:t,y:n,scale:1,rotation:0,color:`#FFFFFF`,fontSize:32,fontFamily:yn[0].family,background:!1};L(e=>[...e,r]),z(e),K(!0)},t[13]=pe):pe=t[13];let me=pe,he;t[14]===Symbol.for(`react.memo_cache_sentinel`)?(he=e=>{let t=`emoji-${Date.now()}`,n=0,r=0;if(V.current){let e=V.current.getBoundingClientRect();n=e.width/2,r=e.height/2}L(i=>[...i,{id:t,type:`emoji`,content:e.emoji,x:n,y:r,scale:1,rotation:0}]),z(t),U(!1)},t[14]=he):he=t[14];let ge=he,_e;t[15]===R?_e=t[16]:(_e=()=>{R&&(L(e=>e.filter(e=>e.id!==R)),z(null))},t[15]=R,t[16]=_e);let ye=_e,be;t[17]!==R||t[18]!==I?(be=()=>{if(R){let e=I.find(e=>e.id===R);e&&e.type===`text`&&(q(e.content),ee(e.color||`#FFFFFF`),te(e.fontFamily||yn[0].family),ae(!!e.background),K(!0))}},t[17]=R,t[18]=I,t[19]=be):be=t[19];let xe=be,Ce;t[20]!==R||t[21]!==W||t[22]!==G||t[23]!==J||t[24]!==ie?(Ce=()=>{R&&(ie.trim()?L(e=>e.map(e=>e.id===R?{...e,content:ie,color:W,fontFamily:G,background:J}:e)):(L(e=>e.filter(e=>e.id!==R)),z(null))),K(!1),q(``)},t[20]=R,t[21]=W,t[22]=G,t[23]=J,t[24]=ie,t[25]=Ce):Ce=t[25];let we=Ce,Ee;if(t[26]!==R||t[27]!==I){let e;t[29]===R?e=t[30]:(e=e=>e.id===R,t[29]=R,t[30]=e),Ee=I.find(e),t[26]=R,t[27]=I,t[28]=Ee}else Ee=t[28];let De=Ee,Oe;t[31]!==n||t[32]!==u||t[33]!==r?(Oe=async()=>{try{if(u){r(n);return}if(!V.current)return;s(`edit`),z(null),await new Promise(Sn);let e=await Ne(V.current,{cacheBust:!1,quality:1,pixelRatio:2});e&&r(new File([e],`edited_image.png`,{type:`image/png`}))}catch(e){let t=e;console.error(`Failed to save media`,t)}},t[31]=n,t[32]=u,t[33]=r,t[34]=Oe):Oe=t[34];let ke=Oe,je;t[35]===Symbol.for(`react.memo_cache_sentinel`)?(je=(0,Z.jsx)(h,{className:`h-6 w-6`}),t[35]=je):je=t[35];let Me;t[36]===i?Me=t[37]:(Me=(0,Z.jsx)(`div`,{className:`pointer-events-auto`,children:(0,Z.jsx)(Q,{variant:`ghost`,size:`icon`,className:`rounded-full bg-black/40 hover:bg-black/60 text-white backdrop-blur-sm`,onClick:i,children:je})}),t[36]=i,t[37]=Me);let Pe;t[38]!==R||t[39]!==u||t[40]!==o?(Pe=!R&&(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(Q,{variant:`ghost`,size:`icon`,className:`text-white hover:bg-white/20 rounded-full h-10 w-10`,onClick:me,children:(0,Z.jsx)(F,{className:`h-5 w-5`})}),(0,Z.jsx)(Q,{variant:`ghost`,size:`icon`,className:`text-white hover:bg-white/20 rounded-full h-10 w-10`,onClick:()=>U(!0),children:(0,Z.jsx)(g,{className:`h-5 w-5`})}),(0,Z.jsx)(Q,{variant:`ghost`,size:`icon`,className:X(`text-white hover:bg-white/20 rounded-full h-10 w-10`,o===`crop`&&`bg-white/20 text-blue-400`),onClick:()=>s(o===`crop`?`edit`:`crop`),children:u?(0,Z.jsx)(re,{className:`h-5 w-5`}):(0,Z.jsx)(M,{className:`h-5 w-5`})})]}),t[38]=R,t[39]=u,t[40]=o,t[41]=Pe):Pe=t[41];let Fe;t[42]!==R||t[43]!==De?.type||t[44]!==ye||t[45]!==xe?(Fe=R&&(0,Z.jsxs)(Z.Fragment,{children:[De?.type===`text`&&(0,Z.jsx)(Q,{variant:`ghost`,size:`icon`,className:`text-white hover:bg-white/20 rounded-full h-10 w-10`,onClick:xe,children:(0,Z.jsx)(ve,{className:`h-5 w-5`})}),(0,Z.jsx)(Q,{variant:`ghost`,size:`icon`,className:`text-red-500 hover:bg-red-500/20 rounded-full h-10 w-10`,onClick:ye,children:(0,Z.jsx)(N,{className:`h-5 w-5`})})]}),t[42]=R,t[43]=De?.type,t[44]=ye,t[45]=xe,t[46]=Fe):Fe=t[46];let Ie;t[47]!==Pe||t[48]!==Fe?(Ie=(0,Z.jsx)(`div`,{className:`pointer-events-auto flex gap-4`,children:(0,Z.jsxs)(`div`,{className:`flex gap-2 bg-black/40 backdrop-blur-sm rounded-full p-2`,children:[Pe,Fe]})}),t[47]=Pe,t[48]=Fe,t[49]=Ie):Ie=t[49];let Le;t[50]!==Me||t[51]!==Ie?(Le=(0,Z.jsxs)(`div`,{className:`absolute top-0 left-0 right-0 z-50 p-4 flex justify-between items-start pointer-events-none`,children:[Me,Ie]}),t[50]=Me,t[51]=Ie,t[52]=Le):Le=t[52];let Re;t[53]===Symbol.for(`react.memo_cache_sentinel`)?(Re=()=>z(null),t[53]=Re):Re=t[53];let ze;t[54]!==R||t[55]!==E||t[56]!==S||t[57]!==f||t[58]!==fe||t[59]!==u||t[60]!==o||t[61]!==O||t[62]!==I||t[63]!==w?(ze=(0,Z.jsx)(`div`,{className:`w-full h-full relative flex items-center justify-center bg-[#1a1a1a]`,onClick:Re,children:o===`crop`&&!u?(0,Z.jsxs)(`div`,{className:`relative w-full h-full max-w-lg mx-auto bg-black`,children:[(0,Z.jsx)(`div`,{className:`absolute inset-0 z-10 pointer-events-none border-2 border-white/20 m-4 rounded-xl`}),(0,Z.jsx)(c,{image:f,crop:S,zoom:w,aspect:E,onCropChange:C,onCropComplete:se,onZoomChange:T,onMediaLoaded:le,classes:{containerClassName:`bg-black`}}),(0,Z.jsxs)(`div`,{className:`absolute bottom-8 left-0 right-0 z-50 flex flex-col items-center gap-4 px-4`,children:[(0,Z.jsxs)(`div`,{className:`flex gap-4 bg-black/60 backdrop-blur-md p-2 rounded-full`,children:[(0,Z.jsx)(Q,{size:`sm`,variant:`ghost`,onClick:()=>D(1),className:X(`rounded-full h-8 w-8 p-0`,E===1?`bg-white text-black`:`text-white`),children:(0,Z.jsx)(d,{size:14})}),(0,Z.jsx)(Q,{size:`sm`,variant:`ghost`,onClick:()=>D(.8),className:X(`rounded-full h-8 w-8 p-0`,E===.8?`bg-white text-black`:`text-white`),children:(0,Z.jsx)(B,{size:14})}),(0,Z.jsx)(Q,{size:`sm`,variant:`ghost`,onClick:()=>D(1.7777777777777777),className:X(`rounded-full h-8 w-8 p-0`,E===1.7777777777777777?`bg-white text-black`:`text-white`),children:(0,Z.jsx)(Se,{size:14})}),(0,Z.jsx)(Q,{size:`sm`,variant:`ghost`,onClick:()=>D(O),className:X(`rounded-full h-8 w-8 p-0`,E===O?`bg-white text-black`:`text-white`),children:(0,Z.jsx)(Ae,{size:14})})]}),(0,Z.jsx)(Q,{onClick:fe,className:`w-full max-w-[200px] rounded-full bg-white text-black hover:bg-white/90 font-bold`,children:`Apply`})]})]}):(0,Z.jsxs)(`div`,{ref:V,className:`relative shadow-2xl bg-black inline-flex overflow-hidden`,style:{maxWidth:`100%`,maxHeight:`100%`,aspectRatio:u?void 0:`${O}`,width:`auto`,height:`auto`},children:[u?f&&(0,Z.jsx)(`video`,{src:f,className:`max-w-full max-h-full block object-contain`,loop:!0,autoPlay:!0,muted:!0}):f&&(0,Z.jsx)(`img`,{src:f,className:`max-w-full max-h-full block object-contain pointer-events-none`,alt:`editing bg`}),(0,Z.jsx)(sn,{overlays:I,setOverlays:L,activeId:R,setActiveId:z,containerRef:V}),(0,Z.jsx)(`div`,{className:`absolute top-0 left-0 right-0 h-24 bg-gradient-to-b from-black/50 to-transparent pointer-events-none`}),(0,Z.jsx)(`div`,{className:`absolute bottom-0 left-0 right-0 h-32 bg-gradient-to-t from-black/50 to-transparent pointer-events-none`})]})}),t[54]=R,t[55]=E,t[56]=S,t[57]=f,t[58]=fe,t[59]=u,t[60]=o,t[61]=O,t[62]=I,t[63]=w,t[64]=ze):ze=t[64];let Be;t[65]!==ke||t[66]!==o?(Be=o!==`crop`&&(0,Z.jsx)(`div`,{className:`absolute bottom-6 right-6 z-50`,children:(0,Z.jsxs)(Q,{onClick:ke,className:`bg-white text-black hover:bg-gray-200 rounded-full px-6 font-bold shadow-lg`,children:[`Next `,(0,Z.jsx)(ue,{className:`ml-1 h-4 w-4`})]})}),t[65]=ke,t[66]=o,t[67]=Be):Be=t[67];let Ve;t[68]!==W||t[69]!==G||t[70]!==we||t[71]!==ne||t[72]!==J||t[73]!==ie?(Ve=ne&&(0,Z.jsxs)(`div`,{className:`fixed inset-0 z-[1050] bg-black/90 backdrop-blur-xl flex flex-col animate-in fade-in duration-200`,children:[(0,Z.jsxs)(`div`,{className:`flex justify-between items-center p-4`,children:[(0,Z.jsx)(Q,{variant:`ghost`,className:`text-white`,onClick:()=>K(!1),children:`Cancel`}),(0,Z.jsx)(Q,{className:`bg-white text-black hover:bg-gray-200 rounded-full px-6`,onClick:we,children:`Done`})]}),(0,Z.jsx)(`div`,{className:`flex-grow flex items-center justify-center p-4 relative`,children:(0,Z.jsx)(tn,{autoFocus:!0,value:ie,onChange:e=>q(e.target.value),className:`bg-transparent border-none text-center text-3xl font-bold text-white resize-none focus-visible:ring-0 min-h-[150px] w-full max-w-lg mx-auto shadow-none placeholder:text-white/30`,placeholder:`Type something...`,style:{color:J?W===`#FFFFFF`?`#000000`:`#FFFFFF`:W,fontFamily:G,backgroundColor:J?W===`#FFFFFF`?`#FFFFFF`:W:`transparent`,borderRadius:`8px`,padding:`1rem`}})}),(0,Z.jsxs)(`div`,{className:`p-4 pb-8 flex flex-col gap-4 max-w-lg mx-auto w-full`,children:[(0,Z.jsxs)(`div`,{className:`flex justify-center gap-2 overflow-x-auto pb-2 scrollbar-hide`,children:[(0,Z.jsx)(Q,{variant:`outline`,size:`icon`,className:X(`rounded-full border-white/20 text-white hover:bg-white/20 h-10 w-10 shrink-0`,J&&`bg-white text-black hover:bg-white/90`),onClick:()=>ae(!J),children:(0,Z.jsx)(b,{className:`h-5 w-5`})}),(0,Z.jsx)(`div`,{className:`w-px h-8 bg-white/20 mx-2 self-center`}),yn.map(e=>(0,Z.jsx)(`button`,{onClick:()=>te(e.family),className:X(`px-4 py-1.5 rounded-full text-sm font-medium border transition-all whitespace-nowrap`,G===e.family?`bg-white text-black border-white`:`bg-transparent text-white border-white/30 hover:bg-white/10`),style:{fontFamily:e.family},children:e.name},e.name))]}),(0,Z.jsx)(`div`,{className:`flex justify-center gap-3 overflow-x-auto p-1 scrollbar-hide`,children:vn.map(e=>(0,Z.jsx)(`button`,{className:X(`w-8 h-8 rounded-full border-2 transition-transform hover:scale-110 shrink-0`,W===e?`border-white scale-110 shadow-lg`:`border-transparent`),style:{backgroundColor:e},onClick:()=>ee(e)},e))})]})]}),t[68]=W,t[69]=G,t[70]=we,t[71]=ne,t[72]=J,t[73]=ie,t[74]=Ve):Ve=t[74];let He;t[75]===H?He=t[76]:(He=H&&(0,Z.jsx)(`div`,{className:`fixed inset-0 z-[1050] bg-black/60 backdrop-blur-sm flex items-end sm:items-center justify-center`,onClick:()=>U(!1),children:(0,Z.jsxs)(`div`,{className:`bg-zinc-900 w-full max-w-sm rounded-t-xl sm:rounded-xl overflow-hidden h-[50vh] sm:h-[400px] flex flex-col`,onClick:Cn,children:[(0,Z.jsx)(`div`,{className:`p-2 border-b border-zinc-800 flex justify-center`,children:(0,Z.jsx)(`div`,{className:`w-12 h-1.5 bg-zinc-700 rounded-full`})}),(0,Z.jsx)(Te,{theme:a.DARK,onEmojiClick:ge,width:`100%`,height:`100%`,previewConfig:{showPreview:!1}})]})}),t[75]=H,t[76]=He);let Ue;return t[77]!==Le||t[78]!==ze||t[79]!==Be||t[80]!==Ve||t[81]!==He?(Ue=(0,Z.jsxs)(`div`,{className:`fixed inset-0 z-[1000] bg-black flex flex-col items-center justify-center overflow-hidden`,children:[Le,ze,Be,Ve,He]}),t[77]=Le,t[78]=ze,t[79]=Be,t[80]=Ve,t[81]=He,t[82]=Ue):Ue=t[82],Ue};function xn(e){return URL.revokeObjectURL(e)}function Sn(e){return setTimeout(e,150)}function Cn(e){return e.stopPropagation()}var wn=P(),Tn=()=>{let e=(0,wn.c)(71),{theme:t,setCreateModalOpen:n,showToast:r}=et(),{user:i,profile:a}=nt(),o=t===`dark`?`bg-[#121212] md:bg-[#121212]/95 md:backdrop-blur-xl md:border md:border-zinc-800`:`bg-white md:bg-white/95 md:backdrop-blur-xl md:border md:border-zinc-200`,[s,c]=(0,Y.useState)(null),[l,u]=(0,Y.useState)(null),[d,f]=(0,Y.useState)(``),[p,m]=(0,Y.useState)(!1),[g,_]=(0,Y.useState)(null),[v,y]=(0,Y.useState)(!1),{mutate:b,isPending:x}=Ft(),{mutate:S,isPending:C}=Gt(),{mutate:w,isPending:T}=Qt(),E=x||C||T,D;e[0]===Symbol.for(`react.memo_cache_sentinel`)?(D=e=>{if(e){c(e);let t=e.type.startsWith(`video/`);m(t),u(URL.createObjectURL(e)),_(t?`reel`:`post`)}},e[0]=D):D=e[0];let k=D,j;e[1]!==d||e[2]!==b||e[3]!==S||e[4]!==w||e[5]!==g||e[6]!==s||e[7]!==a||e[8]!==n||e[9]!==r||e[10]!==i?(j=async()=>{!s||!i||!a||(g===`reel`?S({file:s,caption:d,userId:i.id,username:a.username},{onSuccess:()=>{r(`Reel shared`),n(!1)},onError:()=>r(`Failed to share reel`)}):g===`story`?w({file:s,userId:i.id},{onSuccess:()=>{r(`Story shared`),n(!1)},onError:()=>r(`Failed to share story`)}):b({file:s,caption:d,userId:i.id,username:a.username},{onSuccess:()=>{r(`Post shared`),n(!1)},onError:()=>r(`Failed to share post`)}))},e[1]=d,e[2]=b,e[3]=S,e[4]=w,e[5]=g,e[6]=s,e[7]=a,e[8]=n,e[9]=r,e[10]=i,e[11]=j):j=e[11];let M=j,N;e[12]===n?N=e[13]:(N=()=>n(!1),e[12]=n,e[13]=N);let P=N,F;e[14]===Symbol.for(`react.memo_cache_sentinel`)?(F=e=>{c(e),u(URL.createObjectURL(e)),y(!1)},e[14]=F):F=e[14];let L=F,R;e[15]!==s||e[16]!==v?(R=v&&s&&(0,Z.jsx)(bn,{file:s,onSave:L,onCancel:()=>y(!1)}),e[15]=s,e[16]=v,e[17]=R):R=e[17];let z,B,V;e[18]===Symbol.for(`react.memo_cache_sentinel`)?(z={opacity:0},B={opacity:1},V={opacity:0},e[18]=z,e[19]=B,e[20]=V):(z=e[18],B=e[19],V=e[20]);let H,U,ee;e[21]===Symbol.for(`react.memo_cache_sentinel`)?(U={scale:.95,opacity:0,y:20},ee={scale:1,opacity:1,y:0},H={scale:.95,opacity:0,y:20},e[21]=H,e[22]=U,e[23]=ee):(H=e[21],U=e[22],ee=e[23]);let G=`w-full h-full md:w-full md:max-w-5xl md:h-[85vh] md:rounded-2xl overflow-hidden shadow-2xl flex flex-col ${o} ${t===`dark`?`text-white`:`text-black`}`,te=t===`dark`?`border-zinc-800`:`border-zinc-200`,ne;e[24]===te?ne=e[25]:(ne=X(`px-4 h-14 border-b flex items-center justify-between shrink-0`,te),e[24]=te,e[25]=ne);let K;e[26]!==P||e[27]!==l?(K=(0,Z.jsx)(`div`,{className:`w-20 flex justify-start`,children:l?(0,Z.jsx)(Q,{variant:`ghost`,size:`icon`,className:`-ml-2`,onClick:()=>{u(null),c(null),_(null)},children:(0,Z.jsx)(Me,{className:`h-6 w-6`})}):(0,Z.jsx)(Q,{variant:`ghost`,size:`icon`,className:`-ml-2`,onClick:P,children:(0,Z.jsx)(h,{className:`h-6 w-6`})})}),e[26]=P,e[27]=l,e[28]=K):K=e[28];let re=l?g===`reel`?`New Reel`:g===`story`?`New Story`:`New Post`:`Create`,ie;e[29]===re?ie=e[30]:(ie=(0,Z.jsx)(`span`,{className:`font-semibold text-lg`,children:re}),e[29]=re,e[30]=ie);let q;e[31]!==M||e[32]!==E||e[33]!==l?(q=l&&(0,Z.jsx)(Q,{variant:`ghost`,onClick:M,disabled:E,className:`text-blue-500 hover:text-blue-600 hover:bg-blue-500/10 font-semibold px-2`,children:E?(0,Z.jsx)(W,{className:`h-5 w-5 animate-spin`}):`Share`}),e[31]=M,e[32]=E,e[33]=l,e[34]=q):q=e[34];let J;e[35]===q?J=e[36]:(J=(0,Z.jsx)(`div`,{className:`w-20 flex justify-end`,children:q}),e[35]=q,e[36]=J);let ae;e[37]!==ne||e[38]!==K||e[39]!==ie||e[40]!==J?(ae=(0,Z.jsxs)(`div`,{className:ne,children:[K,ie,J]}),e[37]=ne,e[38]=K,e[39]=ie,e[40]=J,e[41]=ae):ae=e[41];let oe=l?`md:border-r border-zinc-800`:``,se;e[42]===oe?se=e[43]:(se=X(`flex-1 bg-black relative flex items-center justify-center overflow-hidden`,oe),e[42]=oe,e[43]=se);let ce;e[44]!==p||e[45]!==l?(ce=l?(0,Z.jsxs)(`div`,{className:`relative w-full h-full flex items-center justify-center bg-[#1a1a1a]`,children:[p?(0,Z.jsx)(`video`,{src:l,controls:!0,className:`max-h-full max-w-full object-contain`}):(0,Z.jsx)(rn,{src:l,className:`max-h-full max-w-full`,imgClassName:`object-contain`,alt:`preview`}),!p&&(0,Z.jsx)(Q,{size:`icon`,className:`absolute bottom-4 right-4 rounded-full bg-black/50 hover:bg-black/70 text-white backdrop-blur-md border border-white/10 shadow-lg h-12 w-12`,onClick:()=>y(!0),children:(0,Z.jsx)(ve,{size:20})})]}):(0,Z.jsx)(`div`,{className:`w-full h-full p-8 flex flex-col items-center justify-center`,children:(0,Z.jsx)(an,{onFileSelect:k})}),e[44]=p,e[45]=l,e[46]=ce):ce=e[46];let le;e[47]!==se||e[48]!==ce?(le=(0,Z.jsx)(`div`,{className:se,children:ce}),e[47]=se,e[48]=ce,e[49]=le):le=e[49];let de;e[50]!==d||e[51]!==g||e[52]!==p||e[53]!==l||e[54]!==a?.avatar_url||e[55]!==a?.username||e[56]!==t?(de=l&&(0,Z.jsxs)(`div`,{className:X(`w-full md:w-[400px] flex flex-col bg-background/50 backdrop-blur-sm`,t===`dark`?`bg-[#121212]`:`bg-white`),children:[(0,Z.jsxs)(`div`,{className:`p-4 flex items-center gap-3`,children:[(0,Z.jsxs)(rt,{className:`w-10 h-10 border border-border`,children:[(0,Z.jsx)(it,{src:a?.avatar_url||``}),(0,Z.jsx)(at,{children:a?.username?.[0]?.toUpperCase()})]}),(0,Z.jsx)(`span`,{className:`font-semibold text-sm`,children:a?.username})]}),g===`story`?(0,Z.jsx)(`div`,{className:`flex-grow flex items-center justify-center p-8 text-center text-muted-foreground`,children:(0,Z.jsx)(`p`,{className:`text-sm`,children:`Stories are visible for 24 hours. Captions are not supported on stories yet.`})}):(0,Z.jsxs)(`div`,{className:`flex-grow flex flex-col overflow-y-auto`,children:[(0,Z.jsx)(`div`,{className:`px-4 pb-4`,children:(0,Z.jsx)(tn,{className:`w-full min-h-[120px] bg-transparent border-none focus-visible:ring-0 resize-none text-base p-1 placeholder:text-muted-foreground/50`,placeholder:`Write a caption...`,value:d,onChange:e=>f(e.target.value)})}),(0,Z.jsx)(`div`,{className:X(`h-px w-full`,t===`dark`?`bg-zinc-800`:`bg-zinc-100`)}),(0,Z.jsxs)(`div`,{className:`flex flex-col`,children:[(0,Z.jsxs)(`div`,{className:`px-4 py-3 flex items-center justify-between cursor-pointer hover:bg-accent/50 transition-colors border-b border-border/50`,children:[(0,Z.jsxs)(`div`,{className:`flex items-center gap-3 text-sm`,children:[(0,Z.jsx)(O,{size:20,className:`text-muted-foreground`}),(0,Z.jsx)(`span`,{children:`Tag People`})]}),(0,Z.jsx)(ue,{size:16,className:`text-muted-foreground`})]}),(0,Z.jsxs)(`div`,{className:`px-4 py-3 flex items-center justify-between cursor-pointer hover:bg-accent/50 transition-colors border-b border-border/50`,children:[(0,Z.jsxs)(`div`,{className:`flex items-center gap-3 text-sm`,children:[(0,Z.jsx)(A,{size:20,className:`text-muted-foreground`}),(0,Z.jsx)(`span`,{children:`Add Topics`})]}),(0,Z.jsx)(ue,{size:16,className:`text-muted-foreground`})]})]})]}),(0,Z.jsx)(`div`,{className:X(`p-4 border-t`,t===`dark`?`border-zinc-800`:`border-zinc-200`),children:(0,Z.jsxs)(`div`,{className:`grid grid-cols-2 gap-2 bg-muted/50 p-1 rounded-lg`,children:[!p&&(0,Z.jsx)(`button`,{onClick:()=>_(`post`),className:X(`text-sm font-semibold py-2 rounded-md transition-all`,g===`post`?`bg-background text-foreground shadow-sm`:`text-muted-foreground hover:text-foreground`),children:`Post`}),(0,Z.jsx)(`button`,{onClick:()=>_(p?`reel`:`story`),className:X(`text-sm font-semibold py-2 rounded-md transition-all`,g===(p?`reel`:`story`)?`bg-background text-foreground shadow-sm`:`text-muted-foreground hover:text-foreground`),children:p?`Reel`:`Story`})]})})]}),e[50]=d,e[51]=g,e[52]=p,e[53]=l,e[54]=a?.avatar_url,e[55]=a?.username,e[56]=t,e[57]=de):de=e[57];let fe;e[58]!==le||e[59]!==de?(fe=(0,Z.jsxs)(`div`,{className:`flex-grow flex flex-col md:flex-row overflow-hidden`,children:[le,de]}),e[58]=le,e[59]=de,e[60]=fe):fe=e[60];let pe;e[61]!==G||e[62]!==ae||e[63]!==fe?(pe=(0,Z.jsxs)(I.div,{initial:U,animate:ee,exit:H,className:G,onClick:En,children:[ae,fe]}),e[61]=G,e[62]=ae,e[63]=fe,e[64]=pe):pe=e[64];let me;e[65]!==P||e[66]!==pe?(me=(0,Z.jsx)(I.div,{initial:z,animate:B,exit:V,className:`fixed inset-0 z-[100] bg-black/80 flex items-center justify-center md:p-4`,onClick:P,children:pe}),e[65]=P,e[66]=pe,e[67]=me):me=e[67];let he;return e[68]!==me||e[69]!==R?(he=(0,Z.jsxs)(Z.Fragment,{children:[R,me]}),e[68]=me,e[69]=R,e[70]=he):he=e[70],he};function En(e){return e.stopPropagation()}var Dn=P();const On=()=>{let e=(0,Dn.c)(10),t=V(),{showToast:n,setCurrentUser:r,currentUser:i}=et(),a;e[0]!==i||e[1]!==t||e[2]!==r||e[3]!==n?(a=e=>{n(`Profile updated`),r({...i,name:e?.full_name||``,bio:e?.bio||``,avatar:e?.avatar_url||``}),t.invalidateQueries({queryKey:[`profile`]}),e?.username&&t.invalidateQueries({queryKey:[`profile`,e.username]})},e[0]=i,e[1]=t,e[2]=r,e[3]=n,e[4]=a):a=e[4];let o;e[5]===n?o=e[6]:(o=e=>{console.error(`Update profile error:`,e),n(`Failed to update profile`)},e[5]=n,e[6]=o);let s;return e[7]!==a||e[8]!==o?(s={mutationFn:kn,onSuccess:a,onError:o},e[7]=a,e[8]=o,e[9]=s):s=e[9],ge(s)};async function kn(e){let{userId:t,name:n,bio:r,avatar:i}=e,{data:a,error:o}=await $.from(`profiles`).update({full_name:n,bio:r,avatar_url:i}).eq(`id`,t).select().single();if(o)throw o;return a}var An=P();function jn(e){let t=(0,An.c)(10),n,r,i;t[0]===e?(n=t[1],r=t[2],i=t[3]):({className:n,type:i,...r}=e,t[0]=e,t[1]=n,t[2]=r,t[3]=i);let a;t[4]===n?a=t[5]:(a=X(`file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm`,`focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]`,`aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive`,n),t[4]=n,t[5]=a);let o;return t[6]!==r||t[7]!==a||t[8]!==i?(o=(0,Z.jsx)(`input`,{type:i,"data-slot":`input`,className:a,...r}),t[6]=r,t[7]=a,t[8]=i,t[9]=o):o=t[9],o}var Mn=P();function Nn(e){let t=(0,Mn.c)(8),n,r;t[0]===e?(n=t[1],r=t[2]):({className:n,...r}=e,t[0]=e,t[1]=n,t[2]=r);let i;t[3]===n?i=t[4]:(i=X(`flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50`,n),t[3]=n,t[4]=i);let a;return t[5]!==r||t[6]!==i?(a=(0,Z.jsx)(k,{"data-slot":`label`,className:i,...r}),t[5]=r,t[6]=i,t[7]=a):a=t[7],a}var Pn=P(),Fn=()=>{let e=(0,Pn.c)(69),{currentUser:t,theme:n,setEditProfileOpen:r}=et(),{user:i}=nt(),{mutate:a,isPending:o}=On(),s=n===`dark`?`bg-[#121212]/90 backdrop-blur-2xl border border-white/10`:`bg-white/90 backdrop-blur-2xl border border-black/10`,[c,l]=(0,Y.useState)(t.name),[u,d]=(0,Y.useState)(t.bio),[f,p]=(0,Y.useState)(t.avatar),m;e[0]===Symbol.for(`react.memo_cache_sentinel`)?(m=e=>{if(e.target.files&&e.target.files[0]){let t=new FileReader;t.onload=e=>p(e.target?.result),t.readAsDataURL(e.target.files[0])}},e[0]=m):m=e[0];let g=m,_;e[1]===r?_=e[2]:(_=()=>r(!1),e[1]=r,e[2]=_);let v=_,y;e[3]!==f||e[4]!==u||e[5]!==c||e[6]!==v||e[7]!==a||e[8]!==i?(y=()=>{i&&a({userId:i.id,name:c,bio:u||``,avatar:f},{onSuccess:()=>{v()}})},e[3]=f,e[4]=u,e[5]=c,e[6]=v,e[7]=a,e[8]=i,e[9]=y):y=e[9];let b=y,x,S,C;e[10]===Symbol.for(`react.memo_cache_sentinel`)?(x={opacity:0},S={opacity:1},C={opacity:0},e[10]=x,e[11]=S,e[12]=C):(x=e[10],S=e[11],C=e[12]);let w,T,E;e[13]===Symbol.for(`react.memo_cache_sentinel`)?(w={y:50,opacity:0},T={y:0,opacity:1},E={y:50,opacity:0},e[13]=w,e[14]=T,e[15]=E):(w=e[13],T=e[14],E=e[15]);let D=`w-full max-w-md rounded-xl overflow-hidden shadow-2xl ${s} ${n===`dark`?`text-white`:`text-black`}`,O=`p-4 border-b font-bold flex justify-between items-center ${n===`dark`?`border-zinc-800`:`border-zinc-200`}`,k;e[16]===Symbol.for(`react.memo_cache_sentinel`)?(k=(0,Z.jsx)(`span`,{children:`Edit Profile`}),e[16]=k):k=e[16];let A;e[17]===Symbol.for(`react.memo_cache_sentinel`)?(A=(0,Z.jsx)(h,{className:`h-5 w-5`}),e[17]=A):A=e[17];let j;e[18]===v?j=e[19]:(j=(0,Z.jsx)(Q,{variant:`ghost`,size:`icon`,onClick:v,children:A}),e[18]=v,e[19]=j);let M;e[20]!==O||e[21]!==j?(M=(0,Z.jsxs)(`div`,{className:O,children:[k,j]}),e[20]=O,e[21]=j,e[22]=M):M=e[22];let N=`flex items-center gap-4 p-4 rounded-lg ${n===`dark`?`bg-white/5`:`bg-black/5`}`,P;e[23]===f?P=e[24]:(P=(0,Z.jsx)(it,{src:f}),e[23]=f,e[24]=P);let F;e[25]===t.username?.[0]?F=e[26]:(F=t.username?.[0]?.toUpperCase()||`?`,e[25]=t.username?.[0],e[26]=F);let L;e[27]===F?L=e[28]:(L=(0,Z.jsx)(at,{children:F}),e[27]=F,e[28]=L);let R;e[29]!==P||e[30]!==L?(R=(0,Z.jsxs)(rt,{className:`w-16 h-16`,children:[P,L]}),e[29]=P,e[30]=L,e[31]=R):R=e[31];let z;e[32]===t.username?z=e[33]:(z=(0,Z.jsx)(`div`,{className:`font-semibold text-lg`,children:t.username}),e[32]=t.username,e[33]=z);let B;e[34]===Symbol.for(`react.memo_cache_sentinel`)?(B=(0,Z.jsxs)(`label`,{className:`text-[#006a4e] text-sm font-bold cursor-pointer hover:underline`,children:[`Change profile photo`,(0,Z.jsx)(`input`,{type:`file`,className:`hidden`,accept:`image/*`,onChange:g})]}),e[34]=B):B=e[34];let V;e[35]===z?V=e[36]:(V=(0,Z.jsxs)(`div`,{children:[z,B]}),e[35]=z,e[36]=V);let H;e[37]!==N||e[38]!==R||e[39]!==V?(H=(0,Z.jsxs)(`div`,{className:N,children:[R,V]}),e[37]=N,e[38]=R,e[39]=V,e[40]=H):H=e[40];let U;e[41]===Symbol.for(`react.memo_cache_sentinel`)?(U=(0,Z.jsx)(Nn,{children:`Name`}),e[41]=U):U=e[41];let ee;e[42]===Symbol.for(`react.memo_cache_sentinel`)?(ee=e=>l(e.target.value),e[42]=ee):ee=e[42];let G;e[43]===c?G=e[44]:(G=(0,Z.jsxs)(`div`,{className:`space-y-2`,children:[U,(0,Z.jsx)(jn,{type:`text`,value:c,onChange:ee,className:`bg-transparent`})]}),e[43]=c,e[44]=G);let te;e[45]===Symbol.for(`react.memo_cache_sentinel`)?(te=(0,Z.jsx)(Nn,{children:`Bio`}),e[45]=te):te=e[45];let ne;e[46]===Symbol.for(`react.memo_cache_sentinel`)?(ne=e=>d(e.target.value),e[46]=ne):ne=e[46];let K;e[47]===u?K=e[48]:(K=(0,Z.jsxs)(`div`,{className:`space-y-2`,children:[te,(0,Z.jsx)(tn,{value:u,onChange:ne,className:`bg-transparent h-24 resize-none`})]}),e[47]=u,e[48]=K);let re;e[49]===o?re=e[50]:(re=o?(0,Z.jsx)(W,{className:`mr-2 h-4 w-4 animate-spin`}):`Save`,e[49]=o,e[50]=re);let ie;e[51]!==b||e[52]!==o||e[53]!==re?(ie=(0,Z.jsx)(Q,{onClick:b,disabled:o,className:`w-full bg-[#006a4e] hover:bg-[#00523c] text-white font-bold`,children:re}),e[51]=b,e[52]=o,e[53]=re,e[54]=ie):ie=e[54];let q;e[55]!==G||e[56]!==K||e[57]!==ie?(q=(0,Z.jsxs)(`div`,{className:`space-y-4`,children:[G,K,ie]}),e[55]=G,e[56]=K,e[57]=ie,e[58]=q):q=e[58];let J;e[59]!==H||e[60]!==q?(J=(0,Z.jsxs)(`div`,{className:`p-6 flex flex-col gap-4`,children:[H,q]}),e[59]=H,e[60]=q,e[61]=J):J=e[61];let ae;e[62]!==M||e[63]!==J||e[64]!==D?(ae=(0,Z.jsxs)(I.div,{initial:w,animate:T,exit:E,className:D,onClick:In,children:[M,J]}),e[62]=M,e[63]=J,e[64]=D,e[65]=ae):ae=e[65];let oe;return e[66]!==v||e[67]!==ae?(oe=(0,Z.jsx)(I.div,{initial:x,animate:S,exit:C,className:`fixed inset-0 z-[100] bg-black/60 flex items-center justify-center p-4`,onClick:v,children:ae}),e[66]=v,e[67]=ae,e[68]=oe):oe=e[68],oe};function In(e){return e.stopPropagation()}var Ln=P(),Rn=e=>{let t=(0,Ln.c)(3),{className:n}=e,r=`inline-block ml-1 ${n}`,i;t[0]===Symbol.for(`react.memo_cache_sentinel`)?(i=(0,Z.jsxs)(`g`,{transform:`translate(1.4065934065934016 1.4065934065934016) scale(2.81 2.81)`,children:[(0,Z.jsx)(`path`,{d:`M 30.091 10.131 L 30.091 10.131 c 5.28 -13.046 23.695 -13.207 29.202 -0.255 l 0 0 l 0 0 c 12.959 -5.491 26.093 7.416 20.829 20.469 l 0 0 l 0 0 c 13.046 5.28 13.207 23.695 0.255 29.202 l 0 0 l 0 0 c 5.491 12.959 -7.416 26.093 -20.469 20.829 l 0 0 l 0 0 c -5.28 13.046 -23.695 13.207 -29.202 0.255 l 0 0 l 0 0 C 17.748 86.122 4.613 73.215 9.878 60.162 l 0 0 l 0 0 C -3.169 54.881 -3.33 36.467 9.623 30.96 l 0 0 l 0 0 C 4.131 18.001 17.038 4.866 30.091 10.131 L 30.091 10.131 z`,fill:`#0096F1`}),(0,Z.jsx)(`polygon`,{points:`39.66,63.79 23.36,47.76 28.97,42.05 39.3,52.21 59.6,29.58 65.56,34.93`,fill:`#FFFFFF`})]}),t[0]=i):i=t[0];let a;return t[1]===r?a=t[2]:(a=(0,Z.jsx)(`svg`,{width:`16`,height:`16`,viewBox:`0 0 256 256`,xmlns:`http://www.w3.org/2000/svg`,className:r,children:i}),t[1]=r,t[2]=a),a},zn=P(),Bn=e(Ie(),1),Vn=e(Re(),1);ze(),Bn.default.extend(Vn.default),Bn.default.locale(`en`);var Hn=()=>{let e=(0,zn.c)(108),{viewingStory:t,setViewingStory:n,showToast:r}=et(),{user:a}=nt(),o=oe(),{data:s}=Yt(a?.id),c;e[0]===s?c=e[1]:(c=s===void 0?[]:s,e[0]=s,e[1]=c);let l=c,u;e[2]===t?u=e[3]:(u=e=>e.id===t,e[2]=t,e[3]=u);let d=l.findIndex(u),[f,p]=(0,Y.useState)(-1),[g,_]=(0,Y.useState)(0);d!==-1&&f===-1&&p(d);let v;e[4]!==f||e[5]!==n||e[6]!==l.length?(v=()=>{f<l.length-1?(p(Un),_(0)):n(null)},e[4]=f,e[5]=n,e[6]=l.length,e[7]=v):v=e[7];let y=v,b;e[8]===f?b=e[9]:(b=()=>{f>0&&(p(Wn),_(0))},e[8]=f,e[9]=b);let x=b,S,C;if(e[10]!==f||e[11]!==y||e[12]!==t?(S=()=>{if(t===null||f===-1)return;let e=setInterval(()=>{_(e=>e>=100?(y(),0):e+1)},50);return()=>clearInterval(e)},C=[f,t,y],e[10]=f,e[11]=y,e[12]=t,e[13]=S,e[14]=C):(S=e[13],C=e[14]),(0,Y.useEffect)(S,C),t===null||f===-1||l.length===0)return null;let w=l[f];if(!w)return null;let T;e[15]===n?T=e[16]:(T=()=>n(null),e[15]=n,e[16]=T);let D=T,O,k,A;e[17]===Symbol.for(`react.memo_cache_sentinel`)?(k={opacity:0,scale:.9},A={opacity:1,scale:1},O={opacity:0,scale:.9},e[17]=O,e[18]=k,e[19]=A):(O=e[17],k=e[18],A=e[19]);let j;e[20]===Symbol.for(`react.memo_cache_sentinel`)?(j=(0,Z.jsx)(h,{size:32}),e[20]=j):j=e[20];let M;e[21]===D?M=e[22]:(M=(0,Z.jsx)(Q,{variant:`ghost`,size:`icon`,className:`absolute top-4 right-4 z-50 text-white hover:bg-white/10 hover:text-white`,onClick:D,children:j}),e[21]=D,e[22]=M);let N;if(e[23]!==f||e[24]!==g||e[25]!==l){let t;e[27]!==f||e[28]!==g?(t=(e,t)=>(0,Z.jsx)(`div`,{className:`h-1 bg-white/30 flex-1 rounded-full overflow-hidden`,children:(0,Z.jsx)(I.div,{className:`h-full bg-white origin-left`,initial:{scaleX:0},animate:{scaleX:t<f?1:t===f?g/100:0},transition:{type:`tween`,ease:`linear`}})},t),e[27]=f,e[28]=g,e[29]=t):t=e[29],N=l.map(t),e[23]=f,e[24]=g,e[25]=l,e[26]=N}else N=e[26];let P;e[30]===N?P=e[31]:(P=(0,Z.jsx)(`div`,{className:`absolute top-4 left-0 right-0 flex gap-1 px-2 z-20`,children:N}),e[30]=N,e[31]=P);let F;e[32]!==w.username||e[33]!==o||e[34]!==n?(F=e=>{e.stopPropagation(),n(null),o(`/profile/${w.username}`)},e[32]=w.username,e[33]=o,e[34]=n,e[35]=F):F=e[35];let L=w.userAvatar||w.img,R;e[36]===L?R=e[37]:(R=(0,Z.jsx)(it,{src:L}),e[36]=L,e[37]=R);let z;e[38]===w.username?.[0]?z=e[39]:(z=w.username?.[0]?.toUpperCase()||`?`,e[38]=w.username?.[0],e[39]=z);let B;e[40]===z?B=e[41]:(B=(0,Z.jsx)(at,{children:z}),e[40]=z,e[41]=B);let V;e[42]!==F||e[43]!==R||e[44]!==B?(V=(0,Z.jsxs)(rt,{className:`w-8 h-8 border border-white cursor-pointer`,onClick:F,children:[R,B]}),e[42]=F,e[43]=R,e[44]=B,e[45]=V):V=e[45];let H;e[46]!==w.username||e[47]!==o||e[48]!==n?(H=e=>{e.stopPropagation(),n(null),o(`/profile/${w.username}`)},e[46]=w.username,e[47]=o,e[48]=n,e[49]=H):H=e[49];let U;e[50]!==w.username||e[51]!==H?(U=(0,Z.jsx)(`span`,{className:`font-semibold text-sm cursor-pointer hover:underline`,onClick:H,children:w.username}),e[50]=w.username,e[51]=H,e[52]=U):U=e[52];let W;e[53]===w.isVerified?W=e[54]:(W=w.isVerified&&(0,Z.jsx)(Rn,{}),e[53]=w.isVerified,e[54]=W);let ee;e[55]!==U||e[56]!==W?(ee=(0,Z.jsxs)(`div`,{className:`flex items-center`,children:[U,W]}),e[55]=U,e[56]=W,e[57]=ee):ee=e[57];let G;e[58]===w.createdAt?G=e[59]:(G=w.createdAt?(0,Bn.default)(w.createdAt).fromNow(!0):``,e[58]=w.createdAt,e[59]=G);let te;e[60]===G?te=e[61]:(te=(0,Z.jsx)(`span`,{className:`text-white/70 text-xs`,children:G}),e[60]=G,e[61]=te);let ne;e[62]!==V||e[63]!==ee||e[64]!==te?(ne=(0,Z.jsxs)(`div`,{className:`absolute top-8 left-4 flex items-center gap-3 z-20 text-white`,children:[V,ee,te]}),e[62]=V,e[63]=ee,e[64]=te,e[65]=ne):ne=e[65];let K,re,ie;e[66]===Symbol.for(`react.memo_cache_sentinel`)?(K={opacity:0,x:20},re={opacity:1,x:0},ie={opacity:0,x:-20},e[66]=K,e[67]=re,e[68]=ie):(K=e[66],re=e[67],ie=e[68]);let q;e[69]===w.img?q=e[70]:(q=(0,Z.jsx)(rn,{src:w.img,className:`w-full h-full`,alt:`story`}),e[69]=w.img,e[70]=q);let J;e[71]!==w.id||e[72]!==q?(J=(0,Z.jsx)(m,{mode:`wait`,children:(0,Z.jsx)(I.div,{initial:K,animate:re,exit:ie,className:`w-full h-full`,children:q},w.id)}),e[71]=w.id,e[72]=q,e[73]=J):J=e[73];let ae;e[74]===x?ae=e[75]:(ae=(0,Z.jsx)(`div`,{className:`absolute inset-y-0 left-0 w-1/3 z-10`,onClick:x}),e[74]=x,e[75]=ae);let se;e[76]===y?se=e[77]:(se=(0,Z.jsx)(`div`,{className:`absolute inset-y-0 right-0 w-1/3 z-10`,onClick:y}),e[76]=y,e[77]=se);let ce;e[78]!==J||e[79]!==ae||e[80]!==se?(ce=(0,Z.jsxs)(`div`,{className:`flex-1 relative flex items-center justify-center bg-gray-900`,children:[J,ae,se]}),e[78]=J,e[79]=ae,e[80]=se,e[81]=ce):ce=e[81];let le=`Reply to ${w.username}...`,de;e[82]===le?de=e[83]:(de=(0,Z.jsx)(`div`,{className:`flex-1 relative`,children:(0,Z.jsx)(jn,{type:`text`,placeholder:le,className:`w-full bg-transparent border-white/50 rounded-full py-6 px-4 text-white text-sm placeholder:text-white/70 focus-visible:ring-0 focus-visible:border-white`})}),e[82]=le,e[83]=de);let fe;e[84]===r?fe=e[85]:(fe=(0,Z.jsx)(Oe,{size:28,className:`text-white cursor-pointer hover:scale-110 transition-transform`,onClick:()=>r(`Liked story`)}),e[84]=r,e[85]=fe);let pe;e[86]===Symbol.for(`react.memo_cache_sentinel`)?(pe=(0,Z.jsx)(E,{size:28,className:`text-white cursor-pointer hover:scale-110 transition-transform`}),e[86]=pe):pe=e[86];let me;e[87]!==de||e[88]!==fe?(me=(0,Z.jsxs)(`div`,{className:`absolute bottom-0 w-full p-4 flex items-center gap-4 z-20 bg-gradient-to-t from-black/50 to-transparent`,children:[de,fe,pe]}),e[87]=de,e[88]=fe,e[89]=me):me=e[89];let he;e[90]!==P||e[91]!==ne||e[92]!==ce||e[93]!==me?(he=(0,Z.jsxs)(`div`,{className:`relative w-full md:w-[400px] h-full md:h-[90vh] bg-black md:rounded-lg overflow-hidden flex flex-col`,children:[P,ne,ce,me]}),e[90]=P,e[91]=ne,e[92]=ce,e[93]=me,e[94]=he):he=e[94];let ge=f===0,_e;e[95]===Symbol.for(`react.memo_cache_sentinel`)?(_e=(0,Z.jsx)(i,{size:48}),e[95]=_e):_e=e[95];let ve;e[96]!==x||e[97]!==ge?(ve=(0,Z.jsx)(`button`,{className:`hidden md:block absolute left-4 text-white/50 hover:text-white`,onClick:x,disabled:ge,children:_e}),e[96]=x,e[97]=ge,e[98]=ve):ve=e[98];let ye=f===l.length-1,be;e[99]===Symbol.for(`react.memo_cache_sentinel`)?(be=(0,Z.jsx)(ue,{size:48}),e[99]=be):be=e[99];let xe;e[100]!==y||e[101]!==ye?(xe=(0,Z.jsx)(`button`,{className:`hidden md:block absolute right-4 text-white/50 hover:text-white`,onClick:y,disabled:ye,children:be}),e[100]=y,e[101]=ye,e[102]=xe):xe=e[102];let Se;return e[103]!==M||e[104]!==he||e[105]!==ve||e[106]!==xe?(Se=(0,Z.jsxs)(I.div,{initial:k,animate:A,exit:O,className:`fixed inset-0 z-[200] bg-black flex items-center justify-center`,children:[M,he,ve,xe]}),e[103]=M,e[104]=he,e[105]=ve,e[106]=xe,e[107]=Se):Se=e[107],Se};function Un(e){return e+1}function Wn(e){return e-1}var Gn=P();const Kn=()=>{let e=(0,Gn.c)(2),t=V(),n;return e[0]===t?n=e[1]:(n={mutationFn:qn,onMutate:async e=>{let{targetId:n,type:r,hasLiked:i}=e,a=r===`post`?wt:Rt;await t.cancelQueries({queryKey:a});let o=t.getQueryData(a);return t.setQueryData(a,e=>{if(!e)return e;if(r===`post`&&typeof e==`object`&&e&&`pages`in e){let t=e;return{...t,pages:t.pages.map(e=>e.map(e=>{if(e.id===n){let t=Number(e.likes);return{...e,hasLiked:!i,likes:i?Math.max(0,t-1):t+1}}return e}))}}return r===`reel`&&Array.isArray(e)?e.map(e=>{if(e.id===n){let t=Number(e.likes);return{...e,hasLiked:!i,likes:i?Math.max(0,t-1):t+1}}return e}):e}),{previousData:o,queryKey:a}},onError:(e,n,r)=>{r?.previousData&&t.setQueryData(r.queryKey,r.previousData),console.error(e)},onSettled:(e,n,r)=>{let{type:i}=r,a=i===`post`?wt:Rt;t.invalidateQueries({queryKey:a})}},e[0]=t,e[1]=n),ge(n)};async function qn(e){let{targetId:t,type:n,userId:r,hasLiked:i}=e,a=n===`post`?{user_id:r,post_id:t}:{user_id:r,reel_id:t};if(i){let{error:e}=await $.from(`likes`).delete().match(a);if(e)throw e}else{let{error:e}=await $.from(`likes`).insert(a);if(e)throw e}}var Jn=P(),Yn=e(Ie(),1);const Xn=()=>{let e=(0,Jn.c)(11),t=V(),{profile:n}=nt(),r;e[0]!==n?.avatar_url||e[1]!==n?.username||e[2]!==t?(r=async e=>{let{targetId:r,type:i,text:a,userId:o,audioBlob:s,parentId:c}=e,l=[`comments`,i,r],u=i===`post`?wt:Rt;await t.cancelQueries({queryKey:l}),await t.cancelQueries({queryKey:u});let d=t.getQueryData(l),f=t.getQueryData(u),p={id:`temp-${(0,Yn.default)().valueOf()}`,created_at:(0,Yn.default)().toISOString(),text:a,user_id:o,post_id:i===`post`?r:void 0,reel_id:i===`reel`?r:void 0,audioUrl:s?URL.createObjectURL(s):void 0,parent_id:c,likes_count:0,hasLiked:!1,user:{username:n?.username||`You`,avatar_url:n?.avatar_url||``,isVerified:!1}};return t.setQueryData(l,e=>[p,...e===void 0?[]:e]),t.setQueryData(u,e=>{if(!e)return e;if(i===`post`&&e.pages){let t=e;return{...t,pages:t.pages.map(e=>e.map(e=>e.id===r?{...e,comments:Number(e.comments)+1}:e))}}return i===`reel`&&Array.isArray(e)?e.map(e=>e.id===r?{...e,comments:Number(e.comments)+1}:e):e}),{previousComments:d,previousFeed:f,commentsKey:l,feedKey:u}},e[0]=n?.avatar_url,e[1]=n?.username,e[2]=t,e[3]=r):r=e[3];let i,a;e[4]===t?(i=e[5],a=e[6]):(i=(e,n,r)=>{let i=r;i?.previousComments&&t.setQueryData(i.commentsKey,i.previousComments),i?.previousFeed&&t.setQueryData(i.feedKey,i.previousFeed)},a=(e,n)=>{let r=n.type===`post`?wt:Rt;t.invalidateQueries({queryKey:r}),t.invalidateQueries({queryKey:[`comments`,n.type,n.targetId]})},e[4]=t,e[5]=i,e[6]=a);let o;return e[7]!==r||e[8]!==i||e[9]!==a?(o={mutationFn:Zn,onMutate:r,onError:i,onSuccess:a},e[7]=r,e[8]=i,e[9]=a,e[10]=o):o=e[10],ge(o)};async function Zn(e){let{targetId:t,type:n,text:r,userId:i,audioBlob:a,parentId:o}=e,s=null;if(a){let e=`${i}/${Date.now()}.webm`,{error:t}=await $.storage.from(`audio-messages`).upload(e,a);if(t)throw t;let{data:n}=$.storage.from(`audio-messages`).getPublicUrl(e);s=n.publicUrl}let{data:c,error:l}=await $.from(`comments`).insert({user_id:i,post_id:n===`post`?t:null,reel_id:n===`reel`?t:null,text:r,audio_url:s,parent_id:o}).select(`
          *,
          user:profiles(username, avatar_url, is_verified)
        `).single();if(l)throw l;let u=c;return{id:u.id,created_at:u.created_at,text:u.text,user_id:u.user_id,post_id:u.post_id,reel_id:u.reel_id,parent_id:u.parent_id,likes_count:0,hasLiked:!1,audioUrl:u.audio_url,user:{username:u.user?.username,avatar_url:u.user?.avatar_url,isVerified:u.user?.is_verified}}}var Qn=P();const $n=()=>{let e=(0,Qn.c)(2),t=V(),n;return e[0]===t?n=e[1]:(n={mutationFn:er,onSuccess:()=>{t.invalidateQueries({queryKey:wt}),t.invalidateQueries({queryKey:[`savedPosts`]})}},e[0]=t,e[1]=n),ge(n)};async function er(e){let{postId:t,userId:n,hasSaved:r}=e;if(r){let{error:e}=await $.from(`saves`).delete().match({user_id:n,post_id:t});if(e)throw e}else{let{error:e}=await $.from(`saves`).insert({user_id:n,post_id:t});if(e)throw e}}var tr=P();function nr(e){let t=(0,tr.c)(12),n,r,i,a;t[0]===e?(n=t[1],r=t[2],i=t[3],a=t[4]):({className:n,orientation:i,decorative:a,...r}=e,t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=a);let o=i===void 0?`horizontal`:i,s=a===void 0?!0:a,c;t[5]===n?c=t[6]:(c=X(`bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px`,n),t[5]=n,t[6]=c);let l;return t[7]!==s||t[8]!==o||t[9]!==r||t[10]!==c?(l=(0,Z.jsx)(De,{"data-slot":`separator`,decorative:s,orientation:o,className:c,...r}),t[7]=s,t[8]=o,t[9]=r,t[10]=c,t[11]=l):l=t[11],l}var rr=P();function ir(e){let t=(0,rr.c)(14),n,r,i;t[0]===e?(n=t[1],r=t[2],i=t[3]):({className:r,children:n,...i}=e,t[0]=e,t[1]=n,t[2]=r,t[3]=i);let a;t[4]===r?a=t[5]:(a=X(`relative`,r),t[4]=r,t[5]=a);let o;t[6]===n?o=t[7]:(o=(0,Z.jsx)(G,{"data-slot":`scroll-area-viewport`,className:`focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1`,children:n}),t[6]=n,t[7]=o);let s,c;t[8]===Symbol.for(`react.memo_cache_sentinel`)?(s=(0,Z.jsx)(ar,{}),c=(0,Z.jsx)(q,{}),t[8]=s,t[9]=c):(s=t[8],c=t[9]);let l;return t[10]!==i||t[11]!==a||t[12]!==o?(l=(0,Z.jsxs)(U,{"data-slot":`scroll-area`,className:a,...i,children:[o,s,c]}),t[10]=i,t[11]=a,t[12]=o,t[13]=l):l=t[13],l}function ar(e){let t=(0,rr.c)(13),n,r,i;t[0]===e?(n=t[1],r=t[2],i=t[3]):({className:n,orientation:i,...r}=e,t[0]=e,t[1]=n,t[2]=r,t[3]=i);let a=i===void 0?`vertical`:i,o=a===`vertical`&&`h-full w-2.5 border-l border-l-transparent`,s=a===`horizontal`&&`h-2.5 flex-col border-t border-t-transparent`,c;t[4]!==n||t[5]!==o||t[6]!==s?(c=X(`flex touch-none p-px transition-colors select-none`,o,s,n),t[4]=n,t[5]=o,t[6]=s,t[7]=c):c=t[7];let l;t[8]===Symbol.for(`react.memo_cache_sentinel`)?(l=(0,Z.jsx)(ke,{"data-slot":`scroll-area-thumb`,className:`bg-border relative flex-1 rounded-full`}),t[8]=l):l=t[8];let u;return t[9]!==a||t[10]!==r||t[11]!==c?(u=(0,Z.jsx)(Ce,{"data-slot":`scroll-area-scrollbar`,orientation:a,className:c,...r,children:l}),t[9]=a,t[10]=r,t[11]=c,t[12]=u):u=t[12],u}var or=P(),sr=e=>{let t=(0,or.c)(27),{onRecordingComplete:n,onCancel:r}=e,[i,a]=(0,Y.useState)(!1),[o,s]=(0,Y.useState)(0),[c,l]=(0,Y.useState)(null),[u,f]=(0,Y.useState)(!1),[p,m]=(0,Y.useState)(0),h=(0,Y.useRef)(null),g;t[0]===Symbol.for(`react.memo_cache_sentinel`)?(g=[],t[0]=g):g=t[0];let _=(0,Y.useRef)(g),v=(0,Y.useRef)(null),y=(0,Y.useRef)(null),b;t[1]===Symbol.for(`react.memo_cache_sentinel`)?(b=()=>{v.current&&clearInterval(v.current),h.current&&h.current.stream.getTracks().forEach(cr)},t[1]=b):b=t[1];let x=b,S;t[2]===r?S=t[3]:(S=async()=>{try{let e=await navigator.mediaDevices.getUserMedia({audio:!0}),t=new MediaRecorder(e);h.current=t,_.current=[],t.ondataavailable=e=>{e.data.size>0&&_.current.push(e.data)},t.onstop=()=>{l(new Blob(_.current,{type:`audio/webm`})),x()},t.start(),a(!0),v.current=setInterval(()=>{s(lr)},1e3)}catch(e){let t=e;console.error(`Error accessing microphone:`,t),r()}},t[2]=r,t[3]=S);let C=S,w,T;t[4]===C?(w=t[5],T=t[6]):(w=()=>{let e=setTimeout(()=>{C()},0);return()=>{clearTimeout(e),x()}},T=[C,x],t[4]=C,t[5]=w,t[6]=T),(0,Y.useEffect)(w,T);let D;t[7]===i?D=t[8]:(D=()=>{h.current&&i&&(h.current.stop(),a(!1))},t[7]=i,t[8]=D);let O=D,k=ur,A;t[9]!==c||t[10]!==u?(A=()=>{if(c){if(!y.current){let e=URL.createObjectURL(c);y.current=new Audio(e),y.current.onended=()=>f(!1),y.current.ontimeupdate=()=>{m(y.current?.currentTime||0)}}u?y.current.pause():y.current.play(),f(!u)}},t[9]=c,t[10]=u,t[11]=A):A=t[11];let j=A,M;t[12]!==c||t[13]!==n?(M=()=>{c&&n(c)},t[12]=c,t[13]=n,t[14]=M):M=t[14];let P=M,F,L,R;t[15]===Symbol.for(`react.memo_cache_sentinel`)?(R={opacity:0,y:10},F={opacity:1,y:0},L={opacity:0,y:10},t[15]=F,t[16]=L,t[17]=R):(F=t[15],L=t[16],R=t[17]);let z;return t[18]!==c||t[19]!==j||t[20]!==P||t[21]!==u||t[22]!==r||t[23]!==p||t[24]!==o||t[25]!==O?(z=(0,Z.jsx)(I.div,{initial:R,animate:F,exit:L,className:`flex items-center gap-2 w-full bg-zinc-100 dark:bg-zinc-800 p-2 rounded-full`,children:c?(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(Q,{size:`icon`,variant:`ghost`,className:`h-8 w-8 text-zinc-500 hover:text-red-500`,onClick:r,children:(0,Z.jsx)(N,{size:18})}),(0,Z.jsxs)(`div`,{className:`flex-1 flex items-center gap-2`,children:[(0,Z.jsx)(Q,{size:`icon`,variant:`ghost`,className:`h-8 w-8`,onClick:j,children:u?(0,Z.jsx)(se,{size:18}):(0,Z.jsx)(pe,{size:18})}),(0,Z.jsx)(`div`,{className:`h-1 flex-1 bg-zinc-300 dark:bg-zinc-700 rounded-full overflow-hidden`,children:(0,Z.jsx)(`div`,{className:`h-full bg-blue-500 transition-all duration-100`,style:{width:`${p/o*100}%`}})}),(0,Z.jsx)(`span`,{className:`text-xs font-mono text-zinc-500 w-10`,children:k(o)})]}),(0,Z.jsx)(Q,{size:`icon`,className:`h-8 w-8 bg-blue-500 hover:bg-blue-600 rounded-full`,onClick:P,children:(0,Z.jsx)(E,{size:16,className:`text-white`})})]}):(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsxs)(`div`,{className:`flex-1 flex items-center gap-2 px-3`,children:[(0,Z.jsx)(`div`,{className:`w-2 h-2 rounded-full bg-red-500 animate-pulse`}),(0,Z.jsx)(`span`,{className:`text-sm font-mono text-red-500`,children:k(o)}),(0,Z.jsx)(`span`,{className:`text-xs text-zinc-500`,children:`Recording...`})]}),(0,Z.jsx)(Q,{size:`icon`,variant:`ghost`,className:`h-8 w-8 text-red-500 hover:text-red-600 hover:bg-red-100 dark:hover:bg-red-900/20`,onClick:O,children:(0,Z.jsx)(d,{size:16,fill:`currentColor`})})]})}),t[18]=c,t[19]=j,t[20]=P,t[21]=u,t[22]=r,t[23]=p,t[24]=o,t[25]=O,t[26]=z):z=t[26],z};function cr(e){return e.stop()}function lr(e){return e+1}function ur(e){return`${Math.floor(e/60)}:${(e%60).toString().padStart(2,`0`)}`}var dr=P(),fr=e=>{let t=(0,dr.c)(15),{text:n,className:r,truncateLength:i,expanded:a,onToggleExpand:o}=e,s=r===void 0?``:r,c=a===void 0?!1:a;if(!n)return null;let l,u,d;if(t[0]!==s||t[1]!==c||t[2]!==n||t[3]!==i){let e=n;l=i&&n.length>i&&!c,l&&(e=n.slice(0,i));let r;t[7]===Symbol.for(`react.memo_cache_sentinel`)?(r=/(\B#[a-zA-Z0-9_\u0980-\u09FF]+|\B@[a-zA-Z0-9_]+)/g,t[7]=r):r=t[7];let a=r,o=e.split(a);u=`whitespace-pre-wrap ${s}`,d=o.map(hr),t[0]=s,t[1]=c,t[2]=n,t[3]=i,t[4]=l,t[5]=u,t[6]=d}else l=t[4],u=t[5],d=t[6];let f;t[8]!==o||t[9]!==l?(f=l&&o&&(0,Z.jsx)(`span`,{className:`text-zinc-500 cursor-pointer font-semibold ml-1 hover:text-zinc-700 dark:hover:text-zinc-300`,onClick:o,children:`... more`}),t[8]=o,t[9]=l,t[10]=f):f=t[10];let p;return t[11]!==u||t[12]!==d||t[13]!==f?(p=(0,Z.jsxs)(`span`,{className:u,children:[d,f]}),t[11]=u,t[12]=d,t[13]=f,t[14]=p):p=t[14],p};function pr(e){return e.stopPropagation()}function mr(e){return e.stopPropagation()}function hr(e,t){return e.match(/\B#[a-zA-Z0-9_\u0980-\u09FF]+/)?(0,Z.jsx)(D,{to:`/explore?q=%23${e.slice(1)}`,className:`text-[#006a4e] hover:underline`,onClick:pr,children:e},t):e.match(/\B@[a-zA-Z0-9_]+/)?(0,Z.jsx)(D,{to:`/profile/${e.slice(1)}`,className:`text-[#006a4e] hover:underline`,onClick:mr,children:e},t):e}var gr=P();const _r=(e,t)=>{let n=(0,gr.c)(12),{user:r}=nt(),i=r?.id,a;n[0]!==i||n[1]!==e||n[2]!==t?(a=[`comments`,t,e,i],n[0]=i,n[1]=e,n[2]=t,n[3]=a):a=n[3];let o;n[4]!==e||n[5]!==t||n[6]!==r?(o=async()=>{let n=t===`post`?`post_id`:`reel_id`,{data:i,error:a}=await $.from(`comments`).select(`
          *,
          profiles:user_id (
            username,
            avatar_url,
            is_verified
          )
        `).eq(n,e).order(`created_at`,{ascending:!1});if(a)throw a;if(!i)return[];let o=new Set;if(r){let e=i.map(vr);if(e.length>0){let{data:t}=await $.from(`comment_likes`).select(`comment_id`).eq(`user_id`,r.id).in(`comment_id`,e);t&&t.forEach(e=>o.add(e.comment_id))}}return i.map(e=>{let t=e.audio_url||void 0;return t&&t.includes(`/storage/v1/object/audio-messages/`)&&!t.includes(`/storage/v1/object/public/`)&&(t=t.replace(`/storage/v1/object/audio-messages/`,`/storage/v1/object/public/audio-messages/`)),{id:e.id,created_at:e.created_at,text:e.text,user_id:e.user_id,post_id:e.post_id||void 0,reel_id:e.reel_id||void 0,audioUrl:t,parent_id:e.parent_id,likes_count:e.likes_count||0,hasLiked:o.has(e.id),user:{username:e.profiles?.username||`Guest`,avatar_url:e.profiles?.avatar_url||`https://api.dicebear.com/9.x/avataaars/svg?seed=guest`,isVerified:e.profiles?.is_verified||!1}}})},n[4]=e,n[5]=t,n[6]=r,n[7]=o):o=n[7];let s=!!e,c;return n[8]!==a||n[9]!==o||n[10]!==s?(c={queryKey:a,queryFn:o,enabled:s},n[8]=a,n[9]=o,n[10]=s,n[11]=c):c=n[11],_(c)};function vr(e){return e.id}var yr=P();const br=()=>{let e=(0,yr.c)(12),t=V(),{user:n}=nt(),r;e[0]===n?r=e[1]:(r=async e=>{let{commentId:t,hasLiked:r}=e;if(!n)throw Error(`Not authenticated`);if(r){let{error:e}=await $.from(`comment_likes`).delete().match({user_id:n.id,comment_id:t});if(e)throw e}else{let{error:e}=await $.from(`comment_likes`).insert({user_id:n.id,comment_id:t});if(e)throw e}},e[0]=n,e[1]=r);let i,a,o;e[2]!==t||e[3]!==n?.id?(i=async e=>{let{commentId:r,hasLiked:i,targetId:a,type:o}=e;await t.cancelQueries({queryKey:[`comments`,o,a,n?.id]});let s=t.getQueryData([`comments`,o,a,n?.id]);return t.setQueryData([`comments`,o,a,n?.id],e=>e&&e.map(e=>e.id===r?{...e,hasLiked:!i,likes_count:i?e.likes_count-1:e.likes_count+1}:e)),{previousComments:s}},a=(e,r,i)=>{i?.previousComments&&t.setQueryData([`comments`,r.type,r.targetId,n?.id],i.previousComments)},o=(e,r,i)=>{t.invalidateQueries({queryKey:[`comments`,i.type,i.targetId,n?.id]})},e[2]=t,e[3]=n?.id,e[4]=i,e[5]=a,e[6]=o):(i=e[4],a=e[5],o=e[6]);let s;return e[7]!==r||e[8]!==i||e[9]!==a||e[10]!==o?(s={mutationFn:r,onMutate:i,onError:a,onSettled:o},e[7]=r,e[8]=i,e[9]=a,e[10]=o,e[11]=s):s=e[11],ge(s)};var xr=P(),Sr=e=>{let t=(0,xr.c)(14),{src:n,theme:r}=e,i=r===void 0?`dark`:r,[a,o]=(0,Y.useState)(!1),s=Y.useRef(null),[c,l]=(0,Y.useState)(0),u;t[0]!==a||t[1]!==n?(u=()=>{s.current||(s.current=new Audio(n),s.current.onended=()=>{o(!1),l(0)},s.current.ontimeupdate=()=>{s.current&&l(s.current.currentTime/s.current.duration*100||0)}),a?s.current.pause():s.current.play(),o(!a)},t[0]=a,t[1]=n,t[2]=u):u=t[2];let d=u,f=`flex items-center gap-2 ${i===`dark`?`bg-zinc-800`:`bg-zinc-100`} rounded-full px-3 py-1 mt-1 w-fit min-w-[150px]`,p;t[3]===a?p=t[4]:(p=a?(0,Z.jsx)(se,{size:14}):(0,Z.jsx)(pe,{size:14}),t[3]=a,t[4]=p);let m;t[5]!==p||t[6]!==d?(m=(0,Z.jsx)(Q,{variant:`ghost`,size:`icon`,className:`h-6 w-6 shrink-0`,onClick:d,children:p}),t[5]=p,t[6]=d,t[7]=m):m=t[7];let h=`${c}%`,g;t[8]===h?g=t[9]:(g=(0,Z.jsx)(`div`,{className:`h-1 flex-grow bg-zinc-300 dark:bg-zinc-600 rounded-full overflow-hidden`,children:(0,Z.jsx)(`div`,{className:`h-full bg-blue-500 rounded-full transition-all duration-100`,style:{width:h}})}),t[8]=h,t[9]=g);let _;return t[10]!==f||t[11]!==m||t[12]!==g?(_=(0,Z.jsxs)(`div`,{className:f,children:[m,g]}),t[10]=f,t[11]=m,t[12]=g,t[13]=_):_=t[13],_},Cr=P(),wr=e(Ie(),1);const Tr=e=>{let t=(0,Cr.c)(77),{comment:n,replies:r,depth:i,onReply:a,targetId:o,type:s}=e,c=i===void 0?0:i,{showToast:l}=et(),{user:u}=nt(),{mutate:d}=br(),[f,p]=(0,Y.useState)(!1),m=c>0,h;t[0]!==n.hasLiked||t[1]!==n.id||t[2]!==l||t[3]!==o||t[4]!==d||t[5]!==s||t[6]!==u?(h=()=>{if(!u){l(`Log in to like comments`);return}d({commentId:n.id,hasLiked:n.hasLiked,targetId:o,type:s})},t[0]=n.hasLiked,t[1]=n.id,t[2]=l,t[3]=o,t[4]=d,t[5]=s,t[6]=u,t[7]=h):h=t[7];let g=h,_=m&&`ml-8 md:ml-12`,v;t[8]===_?v=t[9]:(v=X(`flex gap-3 mb-4`,_),t[8]=_,t[9]=v);let y;t[10]===n.user.avatar_url?y=t[11]:(y=(0,Z.jsx)(it,{src:n.user.avatar_url}),t[10]=n.user.avatar_url,t[11]=y);let b;t[12]===n.user.username[0]?b=t[13]:(b=n.user.username[0]?.toUpperCase(),t[12]=n.user.username[0],t[13]=b);let x;t[14]===b?x=t[15]:(x=(0,Z.jsx)(at,{children:b}),t[14]=b,t[15]=x);let S;t[16]!==y||t[17]!==x?(S=(0,Z.jsxs)(rt,{className:`w-8 h-8 shrink-0`,children:[y,x]}),t[16]=y,t[17]=x,t[18]=S):S=t[18];let C;t[19]===n.user.username?C=t[20]:(C=(0,Z.jsx)(`span`,{className:`font-semibold text-sm`,children:n.user.username}),t[19]=n.user.username,t[20]=C);let w;t[21]===n.user.isVerified?w=t[22]:(w=n.user.isVerified&&(0,Z.jsx)(Rn,{}),t[21]=n.user.isVerified,t[22]=w);let T;t[23]===n.created_at?T=t[24]:(T=(0,wr.default)(n.created_at).fromNow(!0),t[23]=n.created_at,t[24]=T);let E;t[25]===T?E=t[26]:(E=(0,Z.jsx)(`span`,{className:`text-xs text-muted-foreground ml-1`,children:T}),t[25]=T,t[26]=E);let D;t[27]!==w||t[28]!==E||t[29]!==C?(D=(0,Z.jsxs)(`div`,{className:`flex items-center gap-1`,children:[C,w,E]}),t[27]=w,t[28]=E,t[29]=C,t[30]=D):D=t[30];let O;t[31]!==n.audioUrl||t[32]!==n.text?(O=n.audioUrl?(0,Z.jsx)(`div`,{className:`mt-1`,children:(0,Z.jsx)(Sr,{src:n.audioUrl})}):(0,Z.jsx)(`p`,{className:`text-sm dark:text-gray-200 leading-normal whitespace-pre-wrap break-words`,children:n.text}),t[31]=n.audioUrl,t[32]=n.text,t[33]=O):O=t[33];let k;t[34]!==n||t[35]!==a?(k=(0,Z.jsx)(`button`,{onClick:()=>a(n),className:`text-xs font-semibold text-muted-foreground hover:text-foreground transition-colors`,children:`Reply`}),t[34]=n,t[35]=a,t[36]=k):k=t[36];let A;t[37]!==r.length||t[38]!==f?(A=r.length>0&&(0,Z.jsxs)(`button`,{onClick:()=>p(!f),className:`text-xs font-semibold text-muted-foreground hover:text-foreground transition-colors flex items-center gap-1`,children:[(0,Z.jsx)(`div`,{className:`w-6 h-[1px] bg-muted-foreground`}),f?`Hide replies`:`View ${r.length} replies`]}),t[37]=r.length,t[38]=f,t[39]=A):A=t[39];let j;t[40]!==k||t[41]!==A?(j=(0,Z.jsxs)(`div`,{className:`flex items-center gap-4 mt-1`,children:[k,A]}),t[40]=k,t[41]=A,t[42]=j):j=t[42];let M;t[43]!==D||t[44]!==O||t[45]!==j?(M=(0,Z.jsxs)(`div`,{className:`flex flex-col`,children:[D,O,j]}),t[43]=D,t[44]=O,t[45]=j,t[46]=M):M=t[46];let N;t[47]!==c||t[48]!==a||t[49]!==r||t[50]!==f||t[51]!==o||t[52]!==s?(N=f&&r.length>0&&(0,Z.jsx)(`div`,{className:`mt-4`,children:r.map(e=>(0,Z.jsx)(Tr,{comment:e,replies:e.replies||[],depth:c+1,onReply:a,targetId:o,type:s},e.id))}),t[47]=c,t[48]=a,t[49]=r,t[50]=f,t[51]=o,t[52]=s,t[53]=N):N=t[53];let P;t[54]!==M||t[55]!==N?(P=(0,Z.jsxs)(`div`,{className:`flex-1 min-w-0`,children:[M,N]}),t[54]=M,t[55]=N,t[56]=P):P=t[56];let F=n.hasLiked?`text-red-500`:`text-muted-foreground hover:text-muted-foreground/80`,I;t[57]===F?I=t[58]:(I=X(`transition-colors`,F),t[57]=F,t[58]=I);let L=n.hasLiked&&`fill-current`,R;t[59]===L?R=t[60]:(R=X(`w-3 h-3`,L),t[59]=L,t[60]=R);let z;t[61]===R?z=t[62]:(z=(0,Z.jsx)(Oe,{className:R}),t[61]=R,t[62]=z);let B;t[63]!==g||t[64]!==I||t[65]!==z?(B=(0,Z.jsx)(`button`,{onClick:g,className:I,children:z}),t[63]=g,t[64]=I,t[65]=z,t[66]=B):B=t[66];let V;t[67]===n.likes_count?V=t[68]:(V=n.likes_count>0&&(0,Z.jsx)(`span`,{className:`text-[10px] text-muted-foreground`,children:n.likes_count}),t[67]=n.likes_count,t[68]=V);let H;t[69]!==B||t[70]!==V?(H=(0,Z.jsxs)(`div`,{className:`flex flex-col items-center gap-0.5 pt-1`,children:[B,V]}),t[69]=B,t[70]=V,t[71]=H):H=t[71];let U;return t[72]!==P||t[73]!==H||t[74]!==v||t[75]!==S?(U=(0,Z.jsxs)(`div`,{className:v,children:[S,P,H]}),t[72]=P,t[73]=H,t[74]=v,t[75]=S,t[76]=U):U=t[76],U};var Er=P();function Dr(e){let t=(0,Er.c)(8),n,r;t[0]===e?(n=t[1],r=t[2]):({className:n,...r}=e,t[0]=e,t[1]=n,t[2]=r);let i;t[3]===n?i=t[4]:(i=X(`bg-accent animate-pulse rounded-md`,n),t[3]=n,t[4]=i);let a;return t[5]!==r||t[6]!==i?(a=(0,Z.jsx)(`div`,{"data-slot":`skeleton`,className:i,...r}),t[5]=r,t[6]=i,t[7]=a):a=t[7],a}var Or=P();const kr=e=>{let t=(0,Or.c)(12),{targetId:n,type:r,onReply:i}=e,{data:a,isLoading:o}=_r(n,r),s;t[0]===a?s=t[1]:(s=a===void 0?[]:a,t[0]=a,t[1]=s);let c=s,l;bb0:{if(!c){let e;t[2]===Symbol.for(`react.memo_cache_sentinel`)?(e=[],t[2]=e):e=t[2],l=e;break bb0}let e;if(t[3]!==c){let n=new Map;e=[],c.forEach(e=>{n.set(e.id,{...e,replies:[]})}),c.forEach(t=>{let r=n.get(t.id);t.parent_id&&n.has(t.parent_id)?n.get(t.parent_id).replies.push(r):e.push(r)}),t[3]=c,t[4]=e}else e=t[4];l=e}let u=l;if(o){let e;return t[5]===Symbol.for(`react.memo_cache_sentinel`)?(e=(0,Z.jsx)(`div`,{className:`p-4 space-y-4`,children:[1,2,3].map(Ar)}),t[5]=e):e=t[5],e}if(c.length===0){let e;return t[6]===Symbol.for(`react.memo_cache_sentinel`)?(e=(0,Z.jsxs)(`div`,{className:`flex flex-col items-center justify-center py-12 text-center`,children:[(0,Z.jsx)(`div`,{className:`text-2xl mb-2`,children:``}),(0,Z.jsx)(`h3`,{className:`font-semibold text-lg`,children:`No comments yet.`}),(0,Z.jsx)(`p`,{className:`text-muted-foreground text-sm`,children:`Start the conversation.`})]}),t[6]=e):e=t[6],e}let d;return t[7]!==i||t[8]!==u||t[9]!==n||t[10]!==r?(d=(0,Z.jsx)(`div`,{className:`p-4 pb-20 md:pb-4`,children:u.map(e=>(0,Z.jsx)(Tr,{comment:e,replies:e.replies||[],onReply:i,targetId:n,type:r},e.id))}),t[7]=i,t[8]=u,t[9]=n,t[10]=r,t[11]=d):d=t[11],d};function Ar(e){return(0,Z.jsxs)(`div`,{className:`flex gap-3`,children:[(0,Z.jsx)(Dr,{className:`w-8 h-8 rounded-full`}),(0,Z.jsxs)(`div`,{className:`flex-1 space-y-2`,children:[(0,Z.jsx)(Dr,{className:`h-4 w-32`}),(0,Z.jsx)(Dr,{className:`h-3 w-full`})]})]},e)}var jr=P(),Mr=e(Ie(),1),Nr=e(Re(),1);ze(),Mr.default.extend(Nr.default),Mr.default.locale(`en`);var Pr=()=>{let e=(0,jr.c)(182),{viewingPost:t,viewingReel:n,theme:r,showToast:i,savedPostIds:o,setViewingPost:s,setViewingReel:c}=et(),{mutate:l}=$n(),d=oe(),{user:f}=nt(),{mutate:p}=Kn(),{mutate:m,isPending:_}=Xn(),[v,y]=(0,Y.useState)(``),[b,x]=(0,Y.useState)(!1),[S,C]=(0,Y.useState)(!1),[w,T]=(0,Y.useState)(null),D=Y.useRef(null),O=Y.useRef(null),k=t||n,A,j;e[0]===Symbol.for(`react.memo_cache_sentinel`)?(A=()=>{let e=e=>{D.current&&!D.current.contains(e.target)&&x(!1)};return document.addEventListener(`mousedown`,e),()=>document.removeEventListener(`mousedown`,e)},j=[],e[0]=A,e[1]=j):(A=e[0],j=e[1]),Y.useEffect(A,j);let M;e[2]===Symbol.for(`react.memo_cache_sentinel`)?(M=e=>{y(t=>t+e.emoji)},e[2]=M):M=e[2];let N=M,P=!!n,F=P?`reel`:`post`,L=k?String(k.id):``;if(!k)return null;let R;e[3]!==k.id||e[4]!==o?(R=o.has(k.id),e[3]=k.id,e[4]=o,e[5]=R):R=e[5];let z=R,B=k.hasLiked||!1,V;e[6]!==k.id||e[7]!==B||e[8]!==i||e[9]!==p||e[10]!==F||e[11]!==f?(V=()=>{if(!f){i(`Log in to like`);return}p({targetId:String(k.id),type:F,userId:f.id,hasLiked:B})},e[6]=k.id,e[7]=B,e[8]=i,e[9]=p,e[10]=F,e[11]=f,e[12]=V):V=e[12];let H=V,U;e[13]===Symbol.for(`react.memo_cache_sentinel`)?(U=e=>{T(e),O.current?.focus()},e[13]=U):U=e[13];let ee=U,G;e[14]!==k.id||e[15]!==m||e[16]!==v||e[17]!==w?.id||e[18]!==i||e[19]!==F||e[20]!==f?(G=(e,t)=>{if(e&&e.preventDefault(),!f){i(`Log in to comment`);return}!t&&!v.trim()||m({targetId:String(k.id),type:F,text:t?`Voice Message`:v,userId:f.id,audioBlob:t,parentId:w?.id},{onSuccess:()=>{i(`Comment added`),y(``),C(!1),T(null)},onError:()=>i(`Failed to add comment`)})},e[14]=k.id,e[15]=m,e[16]=v,e[17]=w?.id,e[18]=i,e[19]=F,e[20]=f,e[21]=G):G=e[21];let te=G,K;e[22]!==s||e[23]!==c||e[24]!==t||e[25]!==n?(K=()=>{t&&s(null),n&&c(null),T(null)},e[22]=s,e[23]=c,e[24]=t,e[25]=n,e[26]=K):K=e[26];let re=K,q;e[27]!==d||e[28]!==re?(q=e=>{re(),d(`/profile/${e.username}`)},e[27]=d,e[28]=re,e[29]=q):q=e[29];let J=q,ae=r===`dark`?`bg-[#121212]/90 backdrop-blur-2xl border border-white/10`:`bg-white/90 backdrop-blur-2xl border border-black/10`,se,ce,le;e[30]===Symbol.for(`react.memo_cache_sentinel`)?(le={opacity:0},se={opacity:1},ce={opacity:0},e[30]=se,e[31]=ce,e[32]=le):(se=e[30],ce=e[31],le=e[32]);let ue,de,fe,pe;e[33]===Symbol.for(`react.memo_cache_sentinel`)?(ue={y:`100%`},de={y:0},fe={y:`100%`},pe={type:`spring`,damping:25,stiffness:300},e[33]=ue,e[34]=de,e[35]=fe,e[36]=pe):(ue=e[33],de=e[34],fe=e[35],pe=e[36]);let me=`w-full max-w-5xl h-[95vh] md:h-[650px] md:max-h-[90vh] rounded-t-[20px] md:rounded-lg overflow-hidden flex flex-col md:flex-row shadow-2xl ${ae} ${r===`dark`?`text-white`:`text-black`}`,he;e[37]!==k||e[38]!==P?(he=(0,Z.jsx)(`div`,{className:`hidden md:flex flex-1 bg-black items-center justify-center h-full border-r border-zinc-800 relative`,children:P?(0,Z.jsx)(`video`,{src:k.src,className:`max-h-full max-w-full`,controls:!0,autoPlay:!0,loop:!0}):(0,Z.jsx)(rn,{src:k.content?.src||k.content?.poster||``,className:`max-h-full max-w-full`,imgClassName:`object-contain`,alt:`post detail`})}),e[37]=k,e[38]=P,e[39]=he):he=e[39];let ge;e[40]===Symbol.for(`react.memo_cache_sentinel`)?(ge=(0,Z.jsx)(`div`,{className:`md:hidden w-full text-center font-bold text-sm`,children:`Comments`}),e[40]=ge):ge=e[40];let _e;e[41]!==k.user||e[42]!==J?(_e=()=>J(k.user),e[41]=k.user,e[42]=J,e[43]=_e):_e=e[43];let ve;e[44]===k.user.avatar?ve=e[45]:(ve=(0,Z.jsx)(it,{src:k.user.avatar}),e[44]=k.user.avatar,e[45]=ve);let ye;e[46]===k.user.username[0]?ye=e[47]:(ye=k.user.username?.[0]?.toUpperCase()||`?`,e[46]=k.user.username[0],e[47]=ye);let be;e[48]===ye?be=e[49]:(be=(0,Z.jsx)(at,{children:ye}),e[48]=ye,e[49]=be);let xe;e[50]!==ve||e[51]!==be?(xe=(0,Z.jsxs)(rt,{className:`w-8 h-8 border border-zinc-700`,children:[ve,be]}),e[50]=ve,e[51]=be,e[52]=xe):xe=e[52];let Se;e[53]===k.user.username?Se=e[54]:(Se=(0,Z.jsx)(`span`,{className:`font-semibold text-sm hover:opacity-70`,children:k.user.username}),e[53]=k.user.username,e[54]=Se);let Ce;e[55]===k.user.isVerified?Ce=e[56]:(Ce=k.user.isVerified&&(0,Z.jsx)(Rn,{}),e[55]=k.user.isVerified,e[56]=Ce);let we;e[57]!==Se||e[58]!==Ce?(we=(0,Z.jsxs)(`div`,{className:`flex items-center`,children:[Se,Ce]}),e[57]=Se,e[58]=Ce,e[59]=we):we=e[59];let De;e[60]!==_e||e[61]!==xe||e[62]!==we?(De=(0,Z.jsxs)(`div`,{className:`hidden md:flex items-center gap-3 cursor-pointer`,onClick:_e,children:[xe,we]}),e[60]=_e,e[61]=xe,e[62]=we,e[63]=De):De=e[63];let ke,Ae;e[64]===Symbol.for(`react.memo_cache_sentinel`)?(ke={scale:1.1},Ae={scale:.9},e[64]=ke,e[65]=Ae):(ke=e[64],Ae=e[65]);let je;e[66]===Symbol.for(`react.memo_cache_sentinel`)?(je=(0,Z.jsx)(I.div,{whileHover:ke,whileTap:Ae,className:`hidden md:flex`,children:(0,Z.jsx)(Ee,{size:20,className:`cursor-pointer hover:opacity-70`})}),e[66]=je):je=e[66];let Me;e[67]===Symbol.for(`react.memo_cache_sentinel`)?(Me=(0,Z.jsx)(h,{size:20}),e[67]=Me):Me=e[67];let Ne;e[68]===re?Ne=e[69]:(Ne=(0,Z.jsx)(`div`,{className:`absolute right-4 top-4 md:hidden cursor-pointer`,onClick:re,children:Me}),e[68]=re,e[69]=Ne);let Pe;e[70]!==De||e[71]!==Ne?(Pe=(0,Z.jsxs)(`div`,{className:`p-4 flex items-center justify-between shrink-0`,children:[ge,De,je,Ne]}),e[70]=De,e[71]=Ne,e[72]=Pe):Pe=e[72];let Fe;e[73]===Symbol.for(`react.memo_cache_sentinel`)?(Fe=(0,Z.jsx)(nr,{}),e[73]=Fe):Fe=e[73];let Ie;e[74]!==k.user||e[75]!==J?(Ie=()=>J(k.user),e[74]=k.user,e[75]=J,e[76]=Ie):Ie=e[76];let Le;e[77]===k.user.avatar?Le=e[78]:(Le=(0,Z.jsx)(it,{src:k.user.avatar}),e[77]=k.user.avatar,e[78]=Le);let Re;e[79]===k.user.username[0]?Re=e[80]:(Re=k.user.username[0].toUpperCase(),e[79]=k.user.username[0],e[80]=Re);let ze;e[81]===Re?ze=e[82]:(ze=(0,Z.jsx)(at,{children:Re}),e[81]=Re,e[82]=ze);let Be;e[83]!==Ie||e[84]!==Le||e[85]!==ze?(Be=(0,Z.jsxs)(rt,{className:`w-8 h-8 cursor-pointer flex-shrink-0`,onClick:Ie,children:[Le,ze]}),e[83]=Ie,e[84]=Le,e[85]=ze,e[86]=Be):Be=e[86];let Ve;e[87]!==k.user||e[88]!==J?(Ve=()=>J(k.user),e[87]=k.user,e[88]=J,e[89]=Ve):Ve=e[89];let He;e[90]!==k.user.username||e[91]!==Ve?(He=(0,Z.jsx)(`span`,{className:`font-semibold mr-2 cursor-pointer`,onClick:Ve,children:k.user.username}),e[90]=k.user.username,e[91]=Ve,e[92]=He):He=e[92];let Ue;e[93]===k.user.isVerified?Ue=e[94]:(Ue=k.user.isVerified&&(0,Z.jsx)(Rn,{}),e[93]=k.user.isVerified,e[94]=Ue);let We;e[95]!==He||e[96]!==Ue?(We=(0,Z.jsxs)(`div`,{className:`flex items-center`,children:[He,Ue]}),e[95]=He,e[96]=Ue,e[97]=We):We=e[97];let Ge;e[98]===k.caption?Ge=e[99]:(Ge=(0,Z.jsx)(fr,{text:k.caption}),e[98]=k.caption,e[99]=Ge);let Ke;e[100]===k?Ke=e[101]:(Ke=`createdAt`in k&&k.createdAt?(0,Mr.default)(k.createdAt).fromNow():`time`in k?k.time:``,e[100]=k,e[101]=Ke);let qe;e[102]===Ke?qe=e[103]:(qe=(0,Z.jsx)(`div`,{className:`text-xs text-zinc-500 mt-1`,children:Ke}),e[102]=Ke,e[103]=qe);let Je;e[104]!==We||e[105]!==Ge||e[106]!==qe?(Je=(0,Z.jsxs)(`div`,{className:`text-sm`,children:[We,Ge,qe]}),e[104]=We,e[105]=Ge,e[106]=qe,e[107]=Je):Je=e[107];let Ye;e[108]!==Be||e[109]!==Je?(Ye=(0,Z.jsxs)(`div`,{className:`flex gap-3`,children:[Be,Je]}),e[108]=Be,e[109]=Je,e[110]=Ye):Ye=e[110];let Xe;e[111]!==L||e[112]!==F?(Xe=(0,Z.jsx)(kr,{targetId:L,type:F,onReply:ee}),e[111]=L,e[112]=F,e[113]=Xe):Xe=e[113];let Ze;e[114]!==Ye||e[115]!==Xe?(Ze=(0,Z.jsx)(`div`,{className:`flex-1 min-h-0 overflow-hidden`,children:(0,Z.jsx)(ir,{className:`h-full w-full`,children:(0,Z.jsxs)(`div`,{className:`p-4 space-y-4`,children:[Ye,Xe]})})}),e[114]=Ye,e[115]=Xe,e[116]=Ze):Ze=e[116];let Qe;e[117]===Symbol.for(`react.memo_cache_sentinel`)?(Qe=(0,Z.jsx)(nr,{}),e[117]=Qe):Qe=e[117];let $e;e[118]!==b||e[119]!==r?($e=b&&(0,Z.jsx)(`div`,{ref:D,className:`absolute bottom-full left-0 z-50 shadow-2xl mb-2`,children:(0,Z.jsx)(Te,{theme:r===`dark`?a.DARK:a.LIGHT,onEmojiClick:N,lazyLoadEmojis:!0,skinTonesDisabled:!0,searchDisabled:!1,width:300,height:400})}),e[118]=b,e[119]=r,e[120]=$e):$e=e[120];let tt=`cursor-pointer hover:opacity-70 transition-transform active:scale-90 ${B?`fill-[#f42a41] text-[#f42a41]`:``}`,X;e[121]!==H||e[122]!==tt?(X=(0,Z.jsx)(Oe,{size:24,className:tt,onClick:H}),e[121]=H,e[122]=tt,e[123]=X):X=e[123];let ot;e[124]===Symbol.for(`react.memo_cache_sentinel`)?(ot=(0,Z.jsx)(ie,{size:24,className:`-scale-x-100 cursor-pointer hover:opacity-70`,onClick:()=>O.current?.focus()}),e[124]=ot):ot=e[124];let st;e[125]===i?st=e[126]:(st=(0,Z.jsx)(E,{size:24,className:`cursor-pointer hover:opacity-70`,onClick:()=>i(`Shared`)}),e[125]=i,e[126]=st);let Q;e[127]!==X||e[128]!==st?(Q=(0,Z.jsxs)(`div`,{className:`flex items-center gap-4`,children:[X,ot,st]}),e[127]=X,e[128]=st,e[129]=Q):Q=e[129];let ct=`cursor-pointer hover:opacity-70 ${z?`fill-current`:``}`,lt;e[130]!==k||e[131]!==z||e[132]!==l||e[133]!==f?(lt=()=>{f&&k&&l({postId:String(k.id),userId:f.id,hasSaved:z})},e[130]=k,e[131]=z,e[132]=l,e[133]=f,e[134]=lt):lt=e[134];let ut;e[135]!==ct||e[136]!==lt?(ut=(0,Z.jsx)(u,{size:24,className:ct,onClick:lt}),e[135]=ct,e[136]=lt,e[137]=ut):ut=e[137];let dt;e[138]!==Q||e[139]!==ut?(dt=(0,Z.jsxs)(`div`,{className:`flex items-center justify-between mb-2`,children:[Q,ut]}),e[138]=Q,e[139]=ut,e[140]=dt):dt=e[140];let ft=k.likes+` likes`,pt;e[141]===ft?pt=e[142]:(pt=(0,Z.jsx)(`span`,{className:`font-semibold text-sm`,children:ft}),e[141]=ft,e[142]=pt);let mt;e[143]===k?mt=e[144]:(mt=`createdAt`in k&&k.createdAt?(0,Mr.default)(k.createdAt).fromNow():`time`in k?k.time:``,e[143]=k,e[144]=mt);let ht;e[145]===mt?ht=e[146]:(ht=(0,Z.jsx)(`span`,{className:`text-[10px] text-zinc-500 uppercase`,children:mt}),e[145]=mt,e[146]=ht);let gt;e[147]!==pt||e[148]!==ht?(gt=(0,Z.jsxs)(`div`,{className:`flex flex-col mb-2`,children:[pt,ht]}),e[147]=pt,e[148]=ht,e[149]=gt):gt=e[149];let _t;e[150]===S?_t=e[151]:(_t=!S&&(0,Z.jsx)(`div`,{className:`flex gap-4 mt-2 mb-1 overflow-x-auto scrollbar-hide py-1`,children:[``,``,``,``,``,``,``,``].map(e=>(0,Z.jsx)(`span`,{className:`text-xl cursor-pointer hover:scale-125 transition-transform`,onClick:()=>y(t=>t+e),children:e},e))}),e[150]=S,e[151]=_t);let vt;e[152]===w?vt=e[153]:(vt=w&&(0,Z.jsxs)(`div`,{className:`flex items-center gap-2 mr-2 bg-blue-500/10 px-2 py-0.5 rounded text-xs text-blue-500 whitespace-nowrap`,children:[(0,Z.jsxs)(`span`,{children:[`@`,w.user.username]}),(0,Z.jsx)(`button`,{onClick:()=>T(null),children:(0,Z.jsx)(h,{className:`w-3 h-3`})})]}),e[152]=w,e[153]=vt);let yt;e[154]!==te||e[155]!==_||e[156]!==v||e[157]!==w||e[158]!==b||e[159]!==S||e[160]!==r?(yt=S?(0,Z.jsx)(sr,{onRecordingComplete:e=>te(void 0,e),onCancel:()=>C(!1)}):(0,Z.jsxs)(`form`,{onSubmit:e=>te(e),className:`flex items-center gap-2 w-full relative`,children:[(0,Z.jsx)(g,{size:20,className:`cursor-pointer transition-colors flex-shrink-0 ${b?`text-[#006a4e]`:`text-zinc-500 hover:text-zinc-300`}`,onClick:()=>x(!b)}),(0,Z.jsx)(`input`,{ref:O,type:`text`,placeholder:`Add a comment...`,className:`bg-transparent text-sm w-full outline-none ${r===`dark`?`text-white`:`text-black`}`,value:v,onChange:e=>y(e.target.value),onFocus:()=>x(!1),disabled:_}),!v&&(0,Z.jsx)(ne,{size:20,className:`text-zinc-500 cursor-pointer hover:text-zinc-300 flex-shrink-0`,onClick:()=>C(!0)}),(0,Z.jsx)(`button`,{type:`submit`,className:`text-[#006a4e] text-sm font-semibold disabled:opacity-50 hover:text-[#004d39] flex-shrink-0`,disabled:!v||_,children:_?(0,Z.jsx)(W,{className:`h-4 w-4 animate-spin`}):`Post`})]}),e[154]=te,e[155]=_,e[156]=v,e[157]=w,e[158]=b,e[159]=S,e[160]=r,e[161]=yt):yt=e[161];let $;e[162]!==vt||e[163]!==yt?($=(0,Z.jsxs)(`div`,{className:`flex bg-zinc-100 dark:bg-zinc-800 rounded-full px-3 py-1.5 focus-within:ring-1 ring-blue-500/50 items-center justify-between border border-transparent transition-all`,children:[vt,yt]}),e[162]=vt,e[163]=yt,e[164]=$):$=e[164];let bt;e[165]!==$e||e[166]!==dt||e[167]!==gt||e[168]!==_t||e[169]!==$?(bt=(0,Z.jsxs)(`div`,{className:`px-4 py-3 relative shrink-0 bg-inherit`,children:[$e,dt,gt,_t,$]}),e[165]=$e,e[166]=dt,e[167]=gt,e[168]=_t,e[169]=$,e[170]=bt):bt=e[170];let xt;e[171]!==Pe||e[172]!==Ze||e[173]!==bt?(xt=(0,Z.jsxs)(`div`,{className:`w-full md:w-[400px] flex flex-col h-full overflow-hidden bg-inherit`,children:[Pe,Fe,Ze,Qe,bt]}),e[171]=Pe,e[172]=Ze,e[173]=bt,e[174]=xt):xt=e[174];let St;e[175]!==me||e[176]!==he||e[177]!==xt?(St=(0,Z.jsxs)(I.div,{initial:ue,animate:de,exit:fe,transition:pe,className:me,onClick:Fr,children:[he,xt]}),e[175]=me,e[176]=he,e[177]=xt,e[178]=St):St=e[178];let Ct;return e[179]!==re||e[180]!==St?(Ct=(0,Z.jsx)(I.div,{initial:le,animate:se,exit:ce,className:`fixed inset-0 z-[100] bg-black/80 backdrop-blur-md flex items-end md:items-center justify-center p-0 md:p-8`,onClick:re,children:St}),e[179]=re,e[180]=St,e[181]=Ct):Ct=e[181],Ct};function Fr(e){return e.stopPropagation()}var Ir=P(),Lr=e=>{let t=(0,Ir.c)(6),{children:n}=e,r,i,a,o;t[0]===Symbol.for(`react.memo_cache_sentinel`)?(r={opacity:0},i={opacity:1},a={opacity:0},o={duration:.15,ease:`easeOut`},t[0]=r,t[1]=i,t[2]=a,t[3]=o):(r=t[0],i=t[1],a=t[2],o=t[3]);let s;return t[4]===n?s=t[5]:(s=(0,Z.jsx)(I.div,{initial:r,animate:i,exit:a,transition:o,className:`w-full flex justify-center`,children:n}),t[4]=n,t[5]=s),s},Rr=P();function zr(){let e=(0,Rr.c)(4),t;e[0]===Symbol.for(`react.memo_cache_sentinel`)?(t=(0,Z.jsxs)(`div`,{className:`mb-8 mt-4 flex items-center gap-2 px-2`,children:[(0,Z.jsx)(Dr,{className:`w-8 h-8 rounded-md shrink-0`}),(0,Z.jsx)(Dr,{className:`h-6 w-32 hidden lg:block`})]}),e[0]=t):t=e[0];let n;e[1]===Symbol.for(`react.memo_cache_sentinel`)?(n=(0,Z.jsxs)(`div`,{className:`hidden md:flex flex-col w-[72px] lg:w-[245px] h-screen fixed border-r border-border p-4 gap-4 z-50 bg-background`,children:[t,(0,Z.jsx)(`div`,{className:`flex flex-col gap-2`,children:Array.from({length:6}).map(Ur)})]}),e[1]=n):n=e[1];let r;e[2]===Symbol.for(`react.memo_cache_sentinel`)?(r=(0,Z.jsx)(`div`,{className:`md:hidden fixed bottom-0 left-0 right-0 h-16 border-t border-border bg-background flex justify-around items-center px-4 z-50`,children:Array.from({length:5}).map(Hr)}),e[2]=r):r=e[2];let i;return e[3]===Symbol.for(`react.memo_cache_sentinel`)?(i=(0,Z.jsxs)(`div`,{className:`min-h-screen flex flex-col md:flex-row bg-background`,children:[n,r,(0,Z.jsx)(`main`,{className:`flex-grow md:ml-[72px] lg:ml-[245px] flex justify-center pt-4 md:pt-8 pb-20 md:pb-0`,children:(0,Z.jsxs)(`div`,{className:`w-full max-w-[470px] flex flex-col gap-6 px-4 md:px-0`,children:[(0,Z.jsx)(`div`,{className:`flex gap-4 overflow-hidden`,children:Array.from({length:6}).map(Vr)}),Array.from({length:2}).map(Br)]})})]}),e[3]=i):i=e[3],i}function Br(e,t){return(0,Z.jsxs)(`div`,{className:`w-full rounded-xl overflow-hidden border border-border bg-card shadow-sm`,children:[(0,Z.jsxs)(`div`,{className:`p-3 flex items-center gap-3`,children:[(0,Z.jsx)(Dr,{className:`w-8 h-8 rounded-full`}),(0,Z.jsxs)(`div`,{className:`space-y-2`,children:[(0,Z.jsx)(Dr,{className:`w-24 h-3`}),(0,Z.jsx)(Dr,{className:`w-16 h-2`})]})]}),(0,Z.jsx)(Dr,{className:`w-full aspect-square`}),(0,Z.jsxs)(`div`,{className:`p-3 space-y-3`,children:[(0,Z.jsx)(Dr,{className:`w-full h-4`}),(0,Z.jsx)(Dr,{className:`w-3/4 h-4`})]})]},t)}function Vr(e,t){return(0,Z.jsxs)(`div`,{className:`flex flex-col items-center gap-2 shrink-0`,children:[(0,Z.jsx)(Dr,{className:`w-16 h-16 rounded-full border-2 border-background`}),(0,Z.jsx)(Dr,{className:`w-12 h-2`})]},t)}function Hr(e,t){return(0,Z.jsx)(Dr,{className:`w-6 h-6 rounded-full`},t)}function Ur(e,t){return(0,Z.jsxs)(`div`,{className:`flex items-center gap-4 px-2 py-3`,children:[(0,Z.jsx)(Dr,{className:`w-6 h-6 rounded-md shrink-0`}),(0,Z.jsx)(Dr,{className:`h-4 w-24 hidden lg:block`})]},t)}var Wr=P(),Gr=e(Ie(),1);const Kr=[`notifications`],qr=e=>{let t=(0,Wr.c)(5),n=!!e,r;t[0]===e?r=t[1]:(r=async()=>{let{data:t,error:n}=await $.from(`notifications`).select(`
          id,
          created_at,
          type,
          post_id,
          reel_id,
          actor_id,
          actor:profiles!actor_id (username, avatar_url, is_verified)
        `).eq(`user_id`,e).order(`created_at`,{ascending:!1});if(n)throw n;return(t||[]).map(Jr)},t[0]=e,t[1]=r);let i;return t[2]!==n||t[3]!==r?(i={queryKey:Kr,enabled:n,queryFn:r},t[2]=n,t[3]=r,t[4]=i):i=t[4],_(i)};function Jr(e){let t=`interacted with you.`;return e.type===`follow`?t=`started following you.`:e.type===`like`?t=`liked your `+(e.reel_id?`reel.`:`post.`):e.type===`comment`?t=`commented on your `+(e.reel_id?`reel.`:`post.`):e.type===`mention`&&(t=`mentioned you in a `+(e.reel_id?`reel.`:`post.`)),{id:e.id,created_at:e.created_at,type:e.type,user:{id:e.actor_id||``,username:e.actor?.username||`Unknown`,name:e.actor?.username||`Unknown`,avatar:e.actor?.avatar_url||``,isVerified:e.actor?.is_verified||!1},text:t,time:(0,Gr.default)(e.created_at).fromNow(),isFollowing:!1,post_id:e.post_id||void 0,reel_id:e.reel_id||void 0}}var Yr=P(),Xr=e=>{let t=(0,Yr.c)(7),n;t[0]===e?n=t[1]:({...n}=e,t[0]=e,t[1]=n);let{theme:r}=J(),i=r===void 0?`system`:r,a,o;t[2]===Symbol.for(`react.memo_cache_sentinel`)?(a={success:(0,Z.jsx)(w,{className:`size-4`}),info:(0,Z.jsx)(we,{className:`size-4`}),warning:(0,Z.jsx)(p,{className:`size-4`}),error:(0,Z.jsx)(be,{className:`size-4`}),loading:(0,Z.jsx)(W,{className:`size-4 animate-spin`})},o={"--normal-bg":`var(--popover)`,"--normal-text":`var(--popover-foreground)`,"--normal-border":`var(--border)`,"--border-radius":`var(--radius)`},t[2]=a,t[3]=o):(a=t[2],o=t[3]);let s;return t[4]!==n||t[5]!==i?(s=(0,Z.jsx)(S,{theme:i,className:`toaster group`,icons:a,style:o,...n}),t[4]=n,t[5]=i,t[6]=s):s=t[6],s},Zr=P(),Qr=e(Ie(),1),$r=(0,Y.lazy)(()=>Pe(()=>import(`./HomeView-BE8i3gip.js`),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]))),ei=(0,Y.lazy)(()=>Pe(()=>import(`./ProfileView-CXVFOv3l.js`),__vite__mapDeps([10,1,2,3,4,5,9]))),ti=(0,Y.lazy)(()=>Pe(()=>import(`./MessagesView-bc7Di6CU.js`),__vite__mapDeps([11,1,2,3,4,5]))),ni=(0,Y.lazy)(()=>Pe(()=>import(`./ReelsView-x3sSInIC.js`),__vite__mapDeps([12,1,2,3,4,5,7,8,9]))),ri=(0,Y.lazy)(()=>Pe(()=>import(`./NotificationsView-DG3pBfIo.js`),__vite__mapDeps([13,1,2,3,4,5,9,8]))),ii=(0,Y.lazy)(()=>Pe(()=>import(`./ExploreView-B7N-nKv6.js`),__vite__mapDeps([14,1,2,3,4,5]))),ai=(0,Y.lazy)(()=>Pe(()=>import(`./AuthView-B_a6XjDR.js`),__vite__mapDeps([15,1,2,3,4]))),oi=(0,Y.lazy)(()=>Pe(()=>import(`./PostView-DsGbIxLs.js`),__vite__mapDeps([16,1,2,3,4,5,6,7,8])));function si(){let e=(0,Zr.c)(56),{theme:t,isCreateModalOpen:n,isEditProfileOpen:r,viewingStory:i,viewingPost:a,viewingReel:o,setCurrentUser:s,setUnreadNotificationsCount:c,showToast:l}=et(),{user:u,profile:d,loading:f}=nt(),p=_e(),h=V(),{data:g}=qr(u?.id),_;e[0]===g?_=e[1]:(_=g===void 0?[]:g,e[0]=g,e[1]=_);let v=_,y=p.pathname.startsWith(`/reels/`)&&p.pathname.split(`/`).length===3||p.pathname.startsWith(`/post/`)&&p.pathname.split(`/`).length===3,b,x;e[2]===t?(b=e[3],x=e[4]):(b=()=>{t===`dark`?document.documentElement.classList.add(`dark`):document.documentElement.classList.remove(`dark`)},x=[t],e[2]=t,e[3]=b,e[4]=x),(0,Y.useEffect)(b,x);let S,C;e[5]!==h||e[6]!==l||e[7]!==u?(S=()=>{if(!u)return;let e=$.channel(`notifications_realtime_${u.id}`).on(`postgres_changes`,{event:`INSERT`,schema:`public`,table:`notifications`,filter:`user_id=eq.${u.id}`},e=>{console.log(`New notification:`,e),h.invalidateQueries({queryKey:Kr}),l(`New notification received`)}).subscribe();return()=>{$.removeChannel(e)}},C=[u,h,l],e[5]=h,e[6]=l,e[7]=u,e[8]=S,e[9]=C):(S=e[8],C=e[9]),(0,Y.useEffect)(S,C);let w,T;e[10]!==v||e[11]!==c?(w=()=>{let e=localStorage.getItem(`lastNotificationReadTime`),t=e?(0,Qr.default)(e):(0,Qr.default)(0);c(v.filter(e=>e.created_at&&(0,Qr.default)(e.created_at).isAfter(t)).length)},T=[v,c],e[10]=v,e[11]=c,e[12]=w,e[13]=T):(w=e[12],T=e[13]),(0,Y.useEffect)(w,T),xt();let E,D;if(e[14]!==d||e[15]!==s||e[16]!==u?(E=()=>{d&&u&&s({id:u.id,username:d.username,name:d.full_name||u.email||`User`,avatar:d.avatar_url||`https://api.dicebear.com/9.x/avataaars/svg?seed=default`,bio:d.bio||``,isVerified:d.is_verified||!1,stats:{posts:0,followers:0,following:0}})},D=[d,u,s],e[14]=d,e[15]=s,e[16]=u,e[17]=E,e[18]=D):(E=e[17],D=e[18]),(0,Y.useEffect)(E,D),f){let t;return e[19]===Symbol.for(`react.memo_cache_sentinel`)?(t=(0,Z.jsx)(`div`,{className:`min-h-screen flex items-center justify-center bg-background`,children:(0,Z.jsx)(`img`,{src:`/icon.png`,className:`w-20 h-20 animate-pulse`,alt:`Loading`})}),e[19]=t):t=e[19],t}if(!u&&!y){let t;return e[20]===Symbol.for(`react.memo_cache_sentinel`)?(t=(0,Z.jsx)(Y.Suspense,{fallback:(0,Z.jsx)(`div`,{className:`min-h-screen flex items-center justify-center bg-background`,children:(0,Z.jsx)(`img`,{src:`/icon.png`,className:`w-20 h-20 animate-pulse`,alt:`Loading`})}),children:(0,Z.jsx)(ai,{})}),e[20]=t):t=e[20],t}let O;e[21]===Symbol.for(`react.memo_cache_sentinel`)?(O=(0,Z.jsx)(Xr,{}),e[21]=O):O=e[21];let k;e[22]===n?k=e[23]:(k=n&&(0,Z.jsx)(Tn,{}),e[22]=n,e[23]=k);let A;e[24]===k?A=e[25]:(A=(0,Z.jsx)(m,{children:k}),e[24]=k,e[25]=A);let j;e[26]===r?j=e[27]:(j=r&&(0,Z.jsx)(Fn,{}),e[26]=r,e[27]=j);let M;e[28]===j?M=e[29]:(M=(0,Z.jsx)(m,{children:j}),e[28]=j,e[29]=M);let N;e[30]===i?N=e[31]:(N=i!==null&&(0,Z.jsx)(Hn,{}),e[30]=i,e[31]=N);let P;e[32]===N?P=e[33]:(P=(0,Z.jsx)(m,{children:N}),e[32]=N,e[33]=P);let F;e[34]!==a||e[35]!==o?(F=(a!==null||o!==null)&&(0,Z.jsx)(Pr,{},a?.id||o?.id),e[34]=a,e[35]=o,e[36]=F):F=e[36];let I;e[37]===F?I=e[38]:(I=(0,Z.jsx)(m,{children:F}),e[37]=F,e[38]=I);let L;e[39]===Symbol.for(`react.memo_cache_sentinel`)?(L=(0,Z.jsx)(zr,{}),e[39]=L):L=e[39];let R;e[40]===Symbol.for(`react.memo_cache_sentinel`)?(R=(0,Z.jsx)(yt,{}),e[40]=R):R=e[40];let z;e[41]===Symbol.for(`react.memo_cache_sentinel`)?(z=(0,Z.jsx)(xe,{path:`/`,element:(0,Z.jsx)(Lr,{children:(0,Z.jsx)($r,{})})}),e[41]=z):z=e[41];let B;e[42]===Symbol.for(`react.memo_cache_sentinel`)?(B=(0,Z.jsx)(xe,{path:`/explore`,element:(0,Z.jsx)(Lr,{children:(0,Z.jsx)(ii,{})})}),e[42]=B):B=e[42];let H;e[43]===Symbol.for(`react.memo_cache_sentinel`)?(H=(0,Z.jsx)(xe,{path:`/post/:id`,element:(0,Z.jsx)(Lr,{children:(0,Z.jsx)(oi,{})})}),e[43]=H):H=e[43];let U;e[44]===Symbol.for(`react.memo_cache_sentinel`)?(U=(0,Z.jsx)(xe,{path:`/reels/:id?`,element:(0,Z.jsx)(Lr,{children:(0,Z.jsx)(ni,{})})}),e[44]=U):U=e[44];let W;e[45]===Symbol.for(`react.memo_cache_sentinel`)?(W=(0,Z.jsx)(xe,{path:`/messages/:username?`,element:(0,Z.jsx)(Lr,{children:(0,Z.jsx)(ti,{})})}),e[45]=W):W=e[45];let ee;e[46]===Symbol.for(`react.memo_cache_sentinel`)?(ee=(0,Z.jsx)(xe,{path:`/notifications`,element:(0,Z.jsx)(Lr,{children:(0,Z.jsx)(ri,{})})}),e[46]=ee):ee=e[46];let G;e[47]===Symbol.for(`react.memo_cache_sentinel`)?(G=(0,Z.jsxs)(xe,{element:R,children:[z,B,H,U,W,ee,(0,Z.jsx)(xe,{path:`/profile/:username`,element:(0,Z.jsx)(Lr,{children:(0,Z.jsx)(ei,{})})})]}),e[47]=G):G=e[47];let te;e[48]===p?te=e[49]:(te=(0,Z.jsx)(m,{mode:`wait`,children:(0,Z.jsx)(Y.Suspense,{fallback:L,children:(0,Z.jsx)(fe,{location:p,children:G},p.pathname)})}),e[48]=p,e[49]=te);let ne;return e[50]!==A||e[51]!==M||e[52]!==P||e[53]!==I||e[54]!==te?(ne=(0,Z.jsxs)(Z.Fragment,{children:[O,A,M,P,I,te]}),e[50]=A,e[51]=M,e[52]=P,e[53]=I,e[54]=te,e[55]=ne):ne=e[55],ne}const ci=({children:e})=>{let[t,n]=(0,Y.useState)(null),[r,i]=(0,Y.useState)(null),[a,o]=(0,Y.useState)(null),[s,c]=(0,Y.useState)(!0);(0,Y.useEffect)(()=>{$.auth.getSession().then(({data:{session:e}})=>{n(e),i(e?.user??null),e?.user?l(e.user.id):c(!1)});let{data:{subscription:e}}=$.auth.onAuthStateChange((e,t)=>{n(t),i(t?.user??null),t?.user?l(t.user.id):(o(null),c(!1))});return()=>e.unsubscribe()},[]);let l=async e=>{try{let{data:t,error:n}=await $.from(`profiles`).select(`*`).eq(`id`,e).single();n?console.error(`Error fetching profile:`,n):o(t)}finally{c(!1)}};return(0,Z.jsx)(tt.Provider,{value:{session:t,user:r,profile:a,loading:s,signIn:async(e,t)=>{let{data:n,error:r}=await $.auth.signInWithPassword({email:e,password:t});return{data:n,error:r}},signUp:async(e,t,n)=>{let{data:r,error:i}=await $.auth.signUp({email:e,password:t,options:{data:n}});return{data:r,error:i}},signOut:async()=>{await $.auth.signOut()},resetPassword:async e=>{let{data:t,error:n}=await $.auth.resetPasswordForEmail(e,{redirectTo:`${window.location.origin}/?reset=true`});return{data:t,error:n}},updatePassword:async e=>{let{data:t,error:n}=await $.auth.updateUser({password:e});return{data:t,error:n}}},children:!s&&e})};var li=new We({defaultOptions:{queries:{staleTime:1e3*60*5,gcTime:1e3*60*60*24,retry:1}}}),ui=Ge({storage:window.localStorage});(0,qe.createRoot)(document.getElementById(`root`)).render((0,Z.jsx)(Y.StrictMode,{children:(0,Z.jsxs)(f,{client:li,persistOptions:{persister:ui},children:[(0,Z.jsx)(H,{children:(0,Z.jsx)(ci,{children:(0,Z.jsx)(si,{})})}),(0,Z.jsx)(R,{initialIsOpen:!1})]})}));export{X as C,it as S,et as T,Tt as _,$n as a,rt as b,Rn as c,rn as d,Yt as f,wt as g,jt as h,sr as i,Nn as l,At as m,Sr as n,Xn as o,zt as p,fr as r,Kn as s,qr as t,jn as u,$ as v,nt as w,at as x,Q as y};