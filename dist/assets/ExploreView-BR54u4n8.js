import{A as e,E as t,I as n,L as r,M as i,O as a,P as o,d as s,i as c,m as l,p as u,u as d,v as f,x as p,y as m}from"./index-D58btYjJ.js";var h=r(n(),1),g=a();const _=[`explorePosts`],v=()=>{let t=(0,g.c)(1),n;return t[0]===Symbol.for(`react.memo_cache_sentinel`)?(n={queryKey:_,queryFn:b},t[0]=n):n=t[0],e(n)};function y(e){return{id:e.id,content:{type:`image`,src:e.image_url},likes:e.likes[0]?.count||0,comments:e.comments[0]?.count||0}}async function b(){let{data:e,error:t}=await d.from(`posts`).select(`
          *,
          likes (count),
          comments (count)
        `).limit(20).order(`created_at`,{ascending:!1});if(t)throw t;return e.map(y)}var x=a(),S=i(),C=()=>{let e=(0,x.c)(37),{theme:n,setViewingPost:r}=u(),i=o(),[a,g]=(0,h.useState)(``),_;e[0]===Symbol.for(`react.memo_cache_sentinel`)?(_=[],e[0]=_):_=e[0];let[y,b]=(0,h.useState)(_),[C,T]=(0,h.useState)(!1),{data:E,isLoading:D}=v(),O;e[1]===E?O=e[2]:(O=E===void 0?[]:E,e[1]=E,e[2]=O);let k=O,A,j;e[3]===a?(A=e[4],j=e[5]):(A=()=>{let e=setTimeout(async()=>{if(a.trim().length>0){T(!0);let{data:e}=await d.from(`profiles`).select(`username, full_name, avatar_url, is_verified`).ilike(`username`,`%${a}%`).limit(10);e&&b(e.map(w)),T(!1)}else b([])},300);return()=>clearTimeout(e)},j=[a],e[3]=a,e[4]=A,e[5]=j),(0,h.useEffect)(A,j);let M;e[6]===Symbol.for(`react.memo_cache_sentinel`)?(M={opacity:0},e[6]=M):M=e[6];let N;e[7]===Symbol.for(`react.memo_cache_sentinel`)?(N={hidden:M,visible:{opacity:1,transition:{staggerChildren:.05}}},e[7]=N):N=e[7];let P=N,F;e[8]===Symbol.for(`react.memo_cache_sentinel`)?(F={hidden:{opacity:0,scale:.9},visible:{opacity:1,scale:1}},e[8]=F):F=e[8];let I=F,L=`mb-4 sticky top-0 z-30 py-2 ${n===`dark`?`bg-black`:`bg-white`}`,R=`flex items-center gap-2 px-3 py-2 rounded-lg ${n===`dark`?`bg-[#262626]`:`bg-gray-100`}`,z=n===`dark`?`text-[#8e8e8e]`:`text-gray-500`,B;e[9]===z?B=e[10]:(B=(0,S.jsx)(f,{size:18,className:z}),e[9]=z,e[10]=B);let V;e[11]===Symbol.for(`react.memo_cache_sentinel`)?(V=e=>g(e.target.value),e[11]=V):V=e[11];let H=`bg-transparent border-none outline-none text-sm w-full ${n===`dark`?`text-white`:`text-black`}`,U;e[12]!==a||e[13]!==H?(U=(0,S.jsx)(`input`,{type:`text`,placeholder:`অনুসন্ধান`,value:a,onChange:V,className:H}),e[12]=a,e[13]=H,e[14]=U):U=e[14];let W;e[15]===a?W=e[16]:(W=a&&(0,S.jsx)(l,{size:18,className:`cursor-pointer`,onClick:()=>g(``)}),e[15]=a,e[16]=W);let G;e[17]!==B||e[18]!==U||e[19]!==W||e[20]!==R?(G=(0,S.jsxs)(`div`,{className:R,children:[B,U,W]}),e[17]=B,e[18]=U,e[19]=W,e[20]=R,e[21]=G):G=e[21];let K;e[22]!==G||e[23]!==L?(K=(0,S.jsx)(`div`,{className:L,children:G}),e[22]=G,e[23]=L,e[24]=K):K=e[24];let q;e[25]!==D||e[26]!==C||e[27]!==i||e[28]!==k||e[29]!==a||e[30]!==y||e[31]!==r||e[32]!==n?(q=a?(0,S.jsxs)(`div`,{className:`flex flex-col gap-2`,children:[C&&(0,S.jsx)(`div`,{className:`p-4 text-center`,children:`Searching...`}),!C&&y.length===0&&(0,S.jsx)(`div`,{className:`p-4 text-center text-gray-500`,children:`কোনো ফলাফল পাওয়া যায়নি`}),y.map(e=>(0,S.jsxs)(`div`,{onClick:()=>i(`/profile/${e.username}`),className:`flex items-center gap-3 p-2 rounded-lg cursor-pointer ${n===`dark`?`hover:bg-white/10`:`hover:bg-gray-100`}`,children:[(0,S.jsx)(s,{src:e.avatar,className:`w-10 h-10 rounded-full`,alt:e.username}),(0,S.jsxs)(`div`,{className:`flex flex-col`,children:[(0,S.jsxs)(`div`,{className:`flex items-center gap-1`,children:[(0,S.jsx)(`span`,{className:`font-semibold text-sm`,children:e.username}),e.isVerified&&(0,S.jsx)(c,{})]}),(0,S.jsx)(`span`,{className:`text-xs text-gray-500`,children:e.name})]})]},e.username))]}):(0,S.jsx)(S.Fragment,{children:D?(0,S.jsx)(`div`,{className:`p-10 text-center`,children:`Loading explore...`}):(0,S.jsx)(t.div,{variants:P,initial:`hidden`,animate:`visible`,className:`grid grid-cols-3 gap-1 md:gap-4 pb-14`,children:k.map(e=>(0,S.jsxs)(t.div,{variants:I,whileHover:{scale:.98},className:`relative aspect-square group cursor-pointer overflow-hidden`,onClick:()=>r(e),children:[(0,S.jsx)(s,{src:e.content.src||e.content.poster,className:`w-full h-full transition-transform duration-300 group-hover:scale-110`,alt:`explore`}),(0,S.jsxs)(`div`,{className:`absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 flex items-center justify-center gap-4 text-white font-bold transition-opacity duration-200 z-20`,children:[(0,S.jsxs)(`div`,{className:`flex items-center gap-1`,children:[(0,S.jsx)(p,{fill:`white`,size:16}),` `,e.likes]}),(0,S.jsxs)(`div`,{className:`flex items-center gap-1`,children:[(0,S.jsx)(m,{fill:`white`,size:16,className:`-scale-x-100`}),` `,e.comments]})]})]},e.id))})}),e[25]=D,e[26]=C,e[27]=i,e[28]=k,e[29]=a,e[30]=y,e[31]=r,e[32]=n,e[33]=q):q=e[33];let J;return e[34]!==K||e[35]!==q?(J=(0,S.jsxs)(`div`,{className:`w-full max-w-[935px] py-4 px-2`,children:[K,q]}),e[34]=K,e[35]=q,e[36]=J):J=e[36],J};function w(e){return{username:e.username,name:e.full_name||e.username,avatar:e.avatar_url||``,isVerified:e.is_verified||!1}}export{C as default};