import{a as e}from"./rolldown-runtime-Cn8xt2Gj.js";import{Dt as t,Gt as n,Ht as r,Pt as i,Ut as a,_t as o,jt as s}from"./vendor-j4eAkL9f.js";import{tn as c}from"./libs-Bghk4o3g.js";import"./tanstack-DEYdLxKO.js";import"./supabase-nYr-R5G6.js";import{_ as l,p as u,v as d}from"./index-BnmHHGy6.js";import"./ShareModal-puO9NkuP.js";import"./useGetSuggestedUsers-Cr6lfybW.js";import{t as f}from"./PostItem-B4kYKD40.js";n();var p=t(),m=e(c(),1);const h=e=>[`post`,e],g=(e,t)=>{let n=(0,p.c)(9),r=e||``,i;n[0]===r?i=n[1]:(i=h(r),n[0]=r,n[1]=i);let a=!!e,o;n[2]!==t||n[3]!==e?(o=async()=>{if(!e)throw Error(`Post ID required`);let{data:n,error:r}=await u.from(`posts`).select(`
          id,
          created_at,
          caption,
          image_url,
          user_id,
          profiles (username, full_name, avatar_url, is_verified),
          likes (count),
          comments (count)
        `).eq(`id`,e).single();if(r)throw r;let i=n,a=!1,o=!1;if(t){let{count:n}=await u.from(`likes`).select(`*`,{count:`exact`,head:!0}).eq(`post_id`,e).eq(`user_id`,t);a=!!n&&n>0;let{count:r}=await u.from(`saves`).select(`*`,{count:`exact`,head:!0}).eq(`post_id`,e).eq(`user_id`,t);o=!!r&&r>0}return{id:i.id,user:{username:i.profiles?.username||`Unknown`,name:i.profiles?.full_name||`Unknown`,avatar:i.profiles?.avatar_url||``,isVerified:i.profiles?.is_verified||!1},content:{type:`image`,src:i.image_url},likes:i.likes[0]?.count||0,caption:i.caption||``,comments:i.comments[0]?.count||0,time:(0,m.default)(i.created_at).fromNow(),hasLiked:a,hasSaved:o}},n[2]=t,n[3]=e,n[4]=o):o=n[4];let c;return n[5]!==i||n[6]!==a||n[7]!==o?(c={queryKey:i,enabled:a,queryFn:o},n[5]=i,n[6]=a,n[7]=o,n[8]=c):c=n[8],s(c)};var _=t(),v=i(),y=()=>{let e=(0,_.c)(37),{id:t}=a(),{user:n}=l(),{theme:i,toggleSave:s,setViewingPost:c}=d(),u=r(),{data:p,isLoading:m,error:h}=g(t,n?.id);if(m){let t=`min-h-screen w-full flex items-center justify-center ${i===`dark`?`bg-black text-white`:`bg-white text-black`}`,n;e[0]===Symbol.for(`react.memo_cache_sentinel`)?(n=(0,v.jsx)(`div`,{className:`w-8 h-8 border-4 border-[#006a4e] border-t-transparent rounded-full animate-spin`}),e[0]=n):n=e[0];let r;return e[1]===t?r=e[2]:(r=(0,v.jsx)(`div`,{className:t,children:n}),e[1]=t,e[2]=r),r}if(h||!p){let t=`min-h-screen w-full flex flex-col items-center justify-center ${i===`dark`?`bg-black text-white`:`bg-white text-black`}`,n;e[3]===Symbol.for(`react.memo_cache_sentinel`)?(n=(0,v.jsx)(`h2`,{className:`text-xl font-bold mb-4`,children:`পোস্টটি খুঁজে পাওয়া যায়নি`}),e[3]=n):n=e[3];let r;e[4]===u?r=e[5]:(r=(0,v.jsx)(`button`,{onClick:()=>u(`/`),className:`bg-[#006a4e] text-white px-4 py-2 rounded-lg font-semibold`,children:`হোমে ফিরে যান`}),e[4]=u,e[5]=r);let a;return e[6]!==t||e[7]!==r?(a=(0,v.jsxs)(`div`,{className:t,children:[n,r]}),e[6]=t,e[7]=r,e[8]=a):a=e[8],a}let y=`min-h-screen w-full ${i===`dark`?`bg-black`:`bg-white`} pt-4 md:pt-8`,b;e[9]===u?b=e[10]:(b=()=>u(-1),e[9]=u,e[10]=b);let x=`p-2 rounded-full ${i===`dark`?`hover:bg-zinc-800`:`hover:bg-gray-100`}`,S;e[11]===Symbol.for(`react.memo_cache_sentinel`)?(S=(0,v.jsx)(o,{size:24}),e[11]=S):S=e[11];let C;e[12]!==b||e[13]!==x?(C=(0,v.jsx)(`button`,{onClick:b,className:x,children:S}),e[12]=b,e[13]=x,e[14]=C):C=e[14];let w;e[15]===Symbol.for(`react.memo_cache_sentinel`)?(w=(0,v.jsx)(`h1`,{className:`text-xl font-bold`,children:`পোস্ট`}),e[15]=w):w=e[15];let T;e[16]===C?T=e[17]:(T=(0,v.jsxs)(`div`,{className:`flex items-center gap-4 mb-6`,children:[C,w]}),e[16]=C,e[17]=T);let E=p.hasSaved||!1,D;e[18]!==p.id||e[19]!==s?(D=()=>s(p.id),e[18]=p.id,e[19]=s,e[20]=D):D=e[20];let O;e[21]===u?O=e[22]:(O=e=>u(`/profile/${e.username}`),e[21]=u,e[22]=O);let k;e[23]===c?k=e[24]:(k=e=>c(e),e[23]=c,e[24]=k);let A;e[25]!==p||e[26]!==k||e[27]!==E||e[28]!==D||e[29]!==O?(A=(0,v.jsx)(f,{post:p,isSaved:E,onToggleSave:D,onUserClick:O,onPostClick:k}),e[25]=p,e[26]=k,e[27]=E,e[28]=D,e[29]=O,e[30]=A):A=e[30];let j;e[31]!==A||e[32]!==T?(j=(0,v.jsxs)(`div`,{className:`max-w-[600px] mx-auto px-4`,children:[T,A]}),e[31]=A,e[32]=T,e[33]=j):j=e[33];let M;return e[34]!==y||e[35]!==j?(M=(0,v.jsx)(`div`,{className:y,children:j}),e[34]=y,e[35]=j,e[36]=M):M=e[36],M};export{y as default};