import{D as e,F as t,I as n,N as r,T as i,_ as a,b as o,f as s,j as c,k as l,l as u,p as d,u as f,v as p}from"./index-B9kqV9H8.js";var m=n(t(),1),h=e();const g=[`explorePosts`],_=()=>{let e=(0,h.c)(1),t;return e[0]===Symbol.for(`react.memo_cache_sentinel`)?(t={queryKey:g,queryFn:y},e[0]=t):t=e[0],l(t)};function v(e){return{id:e.id,content:{type:`image`,src:e.image_url},likes:e.likes[0]?.count||0,comments:e.comments[0]?.count||0}}async function y(){let{data:e,error:t}=await u.from(`posts`).select(`
          *,
          likes (count),
          comments (count)
        `).limit(20).order(`created_at`,{ascending:!1});if(t)throw t;return e.map(v)}var b=e(),x=c(),S=()=>{let e=(0,b.c)(37),{theme:t,setViewingPost:n}=s(),c=r(),[l,h]=(0,m.useState)(``),g;e[0]===Symbol.for(`react.memo_cache_sentinel`)?(g=[],e[0]=g):g=e[0];let[v,y]=(0,m.useState)(g),[S,w]=(0,m.useState)(!1),{data:T,isLoading:E}=_(),D;e[1]===T?D=e[2]:(D=T===void 0?[]:T,e[1]=T,e[2]=D);let O=D,k,A;e[3]===l?(k=e[4],A=e[5]):(k=()=>{let e=setTimeout(async()=>{if(l.trim().length>0){w(!0);let{data:e}=await u.from(`profiles`).select(`username, full_name, avatar_url`).ilike(`username`,`%${l}%`).limit(10);e&&y(e.map(C)),w(!1)}else y([])},300);return()=>clearTimeout(e)},A=[l],e[3]=l,e[4]=k,e[5]=A),(0,m.useEffect)(k,A);let j;e[6]===Symbol.for(`react.memo_cache_sentinel`)?(j={opacity:0},e[6]=j):j=e[6];let M;e[7]===Symbol.for(`react.memo_cache_sentinel`)?(M={hidden:j,visible:{opacity:1,transition:{staggerChildren:.05}}},e[7]=M):M=e[7];let N=M,P;e[8]===Symbol.for(`react.memo_cache_sentinel`)?(P={hidden:{opacity:0,scale:.9},visible:{opacity:1,scale:1}},e[8]=P):P=e[8];let F=P,I=`mb-4 sticky top-0 z-30 py-2 ${t===`dark`?`bg-black`:`bg-white`}`,L=`flex items-center gap-2 px-3 py-2 rounded-lg ${t===`dark`?`bg-[#262626]`:`bg-gray-100`}`,R=t===`dark`?`text-[#8e8e8e]`:`text-gray-500`,z;e[9]===R?z=e[10]:(z=(0,x.jsx)(a,{size:18,className:R}),e[9]=R,e[10]=z);let B;e[11]===Symbol.for(`react.memo_cache_sentinel`)?(B=e=>h(e.target.value),e[11]=B):B=e[11];let V=`bg-transparent border-none outline-none text-sm w-full ${t===`dark`?`text-white`:`text-black`}`,H;e[12]!==l||e[13]!==V?(H=(0,x.jsx)(`input`,{type:`text`,placeholder:`অনুসন্ধান`,value:l,onChange:B,className:V}),e[12]=l,e[13]=V,e[14]=H):H=e[14];let U;e[15]===l?U=e[16]:(U=l&&(0,x.jsx)(d,{size:18,className:`cursor-pointer`,onClick:()=>h(``)}),e[15]=l,e[16]=U);let W;e[17]!==z||e[18]!==H||e[19]!==U||e[20]!==L?(W=(0,x.jsxs)(`div`,{className:L,children:[z,H,U]}),e[17]=z,e[18]=H,e[19]=U,e[20]=L,e[21]=W):W=e[21];let G;e[22]!==W||e[23]!==I?(G=(0,x.jsx)(`div`,{className:I,children:W}),e[22]=W,e[23]=I,e[24]=G):G=e[24];let K;e[25]!==E||e[26]!==S||e[27]!==c||e[28]!==O||e[29]!==l||e[30]!==v||e[31]!==n||e[32]!==t?(K=l?(0,x.jsxs)(`div`,{className:`flex flex-col gap-2`,children:[S&&(0,x.jsx)(`div`,{className:`p-4 text-center`,children:`Searching...`}),!S&&v.length===0&&(0,x.jsx)(`div`,{className:`p-4 text-center text-gray-500`,children:`কোনো ফলাফল পাওয়া যায়নি`}),v.map(e=>(0,x.jsxs)(`div`,{onClick:()=>c(`/profile/${e.username}`),className:`flex items-center gap-3 p-2 rounded-lg cursor-pointer ${t===`dark`?`hover:bg-white/10`:`hover:bg-gray-100`}`,children:[(0,x.jsx)(f,{src:e.avatar,className:`w-10 h-10 rounded-full`,alt:e.username}),(0,x.jsxs)(`div`,{className:`flex flex-col`,children:[(0,x.jsx)(`span`,{className:`font-semibold text-sm`,children:e.username}),(0,x.jsx)(`span`,{className:`text-xs text-gray-500`,children:e.name})]})]},e.username))]}):(0,x.jsx)(x.Fragment,{children:E?(0,x.jsx)(`div`,{className:`p-10 text-center`,children:`Loading explore...`}):(0,x.jsx)(i.div,{variants:N,initial:`hidden`,animate:`visible`,className:`grid grid-cols-3 gap-1 md:gap-4 pb-14`,children:O.map(e=>(0,x.jsxs)(i.div,{variants:F,whileHover:{scale:.98},className:`relative aspect-square group cursor-pointer overflow-hidden`,onClick:()=>n(e),children:[(0,x.jsx)(f,{src:e.content.src||e.content.poster,className:`w-full h-full transition-transform duration-300 group-hover:scale-110`,alt:`explore`}),(0,x.jsxs)(`div`,{className:`absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 flex items-center justify-center gap-4 text-white font-bold transition-opacity duration-200 z-20`,children:[(0,x.jsxs)(`div`,{className:`flex items-center gap-1`,children:[(0,x.jsx)(o,{fill:`white`,size:16}),` `,e.likes]}),(0,x.jsxs)(`div`,{className:`flex items-center gap-1`,children:[(0,x.jsx)(p,{fill:`white`,size:16,className:`-scale-x-100`}),` `,e.comments]})]})]},e.id))})}),e[25]=E,e[26]=S,e[27]=c,e[28]=O,e[29]=l,e[30]=v,e[31]=n,e[32]=t,e[33]=K):K=e[33];let q;return e[34]!==G||e[35]!==K?(q=(0,x.jsxs)(`div`,{className:`w-full max-w-[935px] py-4 px-2`,children:[G,K]}),e[34]=G,e[35]=K,e[36]=q):q=e[36],q};function C(e){return{username:e.username,name:e.full_name||e.username,avatar:e.avatar_url||``}}export{S as default};