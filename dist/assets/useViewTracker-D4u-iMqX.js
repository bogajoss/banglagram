import{a as e}from"./rolldown-runtime-Cn8xt2Gj.js";import{$t as t,Ft as n,H as r,Ht as i,J as a,N as o,Xt as s,n as c,vt as l}from"./vendor-BGrLWuzF.js";import{C as u,_ as d,b as f,x as p,y as m}from"./index-qR2YstvC.js";import{t as h}from"./useGetSuggestedUsers-BL8VlLqm.js";var ee=n(),g=e(t(),1),_=i(),v=e=>{let t=(0,ee.c)(32),{onClose:n,showToast:r,theme:i,glassModal:a,shareUrl:o,isOwner:s,onEdit:c}=e,l=`w-full max-w-[300px] rounded-xl overflow-hidden shadow-2xl ${a} ${i===`dark`?`text-white`:`text-black`}`,u;t[0]!==s||t[1]!==n||t[2]!==c?(u=s&&(0,_.jsx)(`button`,{className:`py-3.5 border-b border-zinc-700/30 hover:bg-white/5 transition-colors`,onClick:()=>{c?.(),n()},children:`Edit`}),t[0]=s,t[1]=n,t[2]=c,t[3]=u):u=t[3];let d;t[4]!==n||t[5]!==r?(d=(0,_.jsx)(`button`,{className:`py-3.5 text-[#f42a41] border-b border-zinc-700/30 hover:bg-white/5 transition-colors`,onClick:()=>{r(`Reported`),n()},children:`Report`}),t[4]=n,t[5]=r,t[6]=d):d=t[6];let f;t[7]!==n||t[8]!==r?(f=(0,_.jsx)(`button`,{className:`py-3.5 text-[#f42a41] border-b border-zinc-700/30 hover:bg-white/5 transition-colors`,onClick:()=>{r(`Unfollowed`),n()},children:`Unfollow`}),t[7]=n,t[8]=r,t[9]=f):f=t[9];let p;t[10]!==n||t[11]!==r?(p=(0,_.jsx)(`button`,{className:`py-3.5 border-b border-zinc-700/30 hover:bg-white/5 transition-colors`,onClick:()=>{r(`Added to favorites`),n()},children:`Add to favorites`}),t[10]=n,t[11]=r,t[12]=p):p=t[12];let m;t[13]!==n||t[14]!==o||t[15]!==r?(m=(0,_.jsx)(`button`,{className:`py-3.5 border-b border-zinc-700/30 hover:bg-white/5 transition-colors`,onClick:()=>{let e=o||window.location.href;navigator.clipboard.writeText(e),r(`Link copied`),n()},children:`Copy link`}),t[13]=n,t[14]=o,t[15]=r,t[16]=m):m=t[16];let h;t[17]===n?h=t[18]:(h=(0,_.jsx)(`button`,{className:`py-3.5 hover:bg-white/5 transition-colors`,onClick:n,children:`Cancel`}),t[17]=n,t[18]=h);let g;t[19]!==u||t[20]!==d||t[21]!==f||t[22]!==p||t[23]!==m||t[24]!==h?(g=(0,_.jsxs)(`div`,{className:`flex flex-col text-sm font-semibold`,children:[u,d,f,p,m,h]}),t[19]=u,t[20]=d,t[21]=f,t[22]=p,t[23]=m,t[24]=h,t[25]=g):g=t[25];let v;t[26]!==l||t[27]!==g?(v=(0,_.jsx)(`div`,{className:l,onClick:y,children:g}),t[26]=l,t[27]=g,t[28]=v):v=t[28];let b;return t[29]!==n||t[30]!==v?(b=(0,_.jsx)(`div`,{className:`fixed inset-0 z-[100] bg-black/60 flex items-center justify-center p-4`,onClick:n,children:v}),t[29]=n,t[30]=v,t[31]=b):b=t[31],b};function y(e){return e.stopPropagation()}var b=n(),te=e=>{let t=(0,b.c)(70),{onClose:n,theme:i,showToast:c,glassModal:ee,shareUrl:v}=e,y=s(),{user:te}=u(),{data:x}=h(te?.id),S;t[0]===x?S=t[1]:(S=x===void 0?[]:x,t[0]=x,t[1]=S);let ie=S,[C,ae]=(0,g.useState)(``),w;t[2]===Symbol.for(`react.memo_cache_sentinel`)?(w=[],t[2]=w):w=t[2];let[oe,se]=(0,g.useState)(w),[ce,le]=(0,g.useState)(!1),T,E;t[3]===C?(T=t[4],E=t[5]):(T=()=>{let e=setTimeout(async()=>{if(C.trim().length>0){le(!0);let{data:e}=await d.from(`profiles`).select(`id, username, full_name, avatar_url, is_verified`).ilike(`username`,`%${C}%`).limit(10);e&&se(e.map(ne)),le(!1)}else se([])},300);return()=>clearTimeout(e)},E=[C],t[3]=C,t[4]=T,t[5]=E),(0,g.useEffect)(T,E);let D;t[6]!==C||t[7]!==oe||t[8]!==ie?(D=C.trim()?oe:ie.slice(0,8),t[6]=C,t[7]=oe,t[8]=ie,t[9]=D):D=t[9];let O=D,ue=`w-full max-w-md rounded-xl overflow-hidden shadow-2xl ${ee} ${i===`dark`?`text-white`:`text-black`}`,k=`p-3 border-b text-center font-bold relative ${i===`dark`?`border-zinc-800`:`border-zinc-200`}`,A;t[10]===n?A=t[11]:(A=(0,_.jsx)(o,{className:`absolute right-3 top-3 cursor-pointer`,onClick:n}),t[10]=n,t[11]=A);let j;t[12]!==k||t[13]!==A?(j=(0,_.jsxs)(`div`,{className:k,children:[`Share`,A]}),t[12]=k,t[13]=A,t[14]=j):j=t[14];let M=`p-4 border-b ${i===`dark`?`border-zinc-700/50`:`border-zinc-200`}`,de=`flex items-center gap-2 px-3 py-2 rounded-lg ${i===`dark`?`bg-[#262626]`:`bg-gray-100`}`,N;t[15]===Symbol.for(`react.memo_cache_sentinel`)?(N=(0,_.jsx)(a,{size:18,className:`text-[#8e8e8e]`}),t[15]=N):N=t[15];let P;t[16]===Symbol.for(`react.memo_cache_sentinel`)?(P=e=>ae(e.target.value),t[16]=P):P=t[16];let F,I;t[17]===C?(F=t[18],I=t[19]):(F=(0,_.jsx)(`input`,{type:`text`,placeholder:`Search`,value:C,onChange:P,className:`bg-transparent border-none outline-none text-sm w-full`}),I=C&&(0,_.jsx)(o,{size:18,className:`cursor-pointer text-[#8e8e8e]`,onClick:()=>ae(``)}),t[17]=C,t[18]=F,t[19]=I);let L;t[20]!==de||t[21]!==F||t[22]!==I?(L=(0,_.jsxs)(`div`,{className:de,children:[N,F,I]}),t[20]=de,t[21]=F,t[22]=I,t[23]=L):L=t[23];let R;t[24]!==M||t[25]!==L?(R=(0,_.jsx)(`div`,{className:M,children:L}),t[24]=M,t[25]=L,t[26]=R):R=t[26];let z;t[27]!==ce||t[28]!==y||t[29]!==n||t[30]!==c||t[31]!==i||t[32]!==O?(z=ce?(0,_.jsx)(`div`,{className:`p-4 text-center text-sm text-gray-500`,children:`Searching...`}):O.length===0?(0,_.jsx)(`div`,{className:`p-4 text-center text-sm text-gray-500`,children:`No results found`}):O.map((e,t)=>(0,_.jsxs)(`div`,{className:`flex items-center justify-between p-2 rounded-lg ${i===`dark`?`hover:bg-white/5`:`hover:bg-black/5`} cursor-pointer transition-colors`,children:[(0,_.jsxs)(`div`,{className:`flex items-center gap-3 flex-grow`,onClick:()=>{n(),y(`/profile/${e.username}`)},children:[(0,_.jsxs)(m,{className:`w-10 h-10`,children:[(0,_.jsx)(p,{src:e.avatar}),(0,_.jsx)(f,{children:e.username?.[0]?.toUpperCase()||`?`})]}),(0,_.jsxs)(`div`,{className:`flex flex-col`,children:[(0,_.jsx)(`span`,{className:`text-sm font-semibold`,children:e.username}),(0,_.jsx)(`span`,{className:`text-xs opacity-70`,children:e.name||e.username})]})]}),(0,_.jsx)(`button`,{className:`px-4 py-1.5 rounded-lg text-sm font-semibold bg-[#006a4e] text-white hover:bg-[#00523c] transition-colors`,onClick:t=>{t.stopPropagation(),c(`Sent to ${e.username}`),n()},children:`Send`})]},t)),t[27]=ce,t[28]=y,t[29]=n,t[30]=c,t[31]=i,t[32]=O,t[33]=z):z=t[33];let B;t[34]===z?B=t[35]:(B=(0,_.jsx)(`div`,{className:`h-64 overflow-y-auto p-2`,children:z}),t[34]=z,t[35]=B);let fe=`p-4 border-t ${i===`dark`?`border-zinc-800`:`border-zinc-200`} flex gap-4 overflow-x-auto`,V;t[36]!==n||t[37]!==v||t[38]!==c?(V=()=>{let e=v||window.location.href;navigator.clipboard.writeText(e),c(`Link copied`),n()},t[36]=n,t[37]=v,t[38]=c,t[39]=V):V=t[39];let pe=`w-12 h-12 rounded-full border flex items-center justify-center ${i===`dark`?`border-zinc-700 bg-black`:`border-gray-300 bg-white`}`,H;t[40]===Symbol.for(`react.memo_cache_sentinel`)?(H=(0,_.jsx)(l,{size:20}),t[40]=H):H=t[40];let U;t[41]===pe?U=t[42]:(U=(0,_.jsx)(`div`,{className:pe,children:H}),t[41]=pe,t[42]=U);let W;t[43]===Symbol.for(`react.memo_cache_sentinel`)?(W=(0,_.jsx)(`span`,{className:`text-xs`,children:`Copy Link`}),t[43]=W):W=t[43];let G;t[44]!==V||t[45]!==U?(G=(0,_.jsxs)(`div`,{className:`flex flex-col items-center gap-1 cursor-pointer min-w-[60px]`,onClick:V,children:[U,W]}),t[44]=V,t[45]=U,t[46]=G):G=t[46];let K;t[47]!==n||t[48]!==c?(K=()=>{c(`Added to your story`),n()},t[47]=n,t[48]=c,t[49]=K):K=t[49];let me=`w-12 h-12 rounded-full border flex items-center justify-center ${i===`dark`?`border-zinc-700 bg-black`:`border-gray-300 bg-white`}`,q;t[50]===Symbol.for(`react.memo_cache_sentinel`)?(q=(0,_.jsx)(r,{size:20}),t[50]=q):q=t[50];let J;t[51]===me?J=t[52]:(J=(0,_.jsx)(`div`,{className:me,children:q}),t[51]=me,t[52]=J);let Y;t[53]===Symbol.for(`react.memo_cache_sentinel`)?(Y=(0,_.jsx)(`span`,{className:`text-xs`,children:`Add to story`}),t[53]=Y):Y=t[53];let X;t[54]!==K||t[55]!==J?(X=(0,_.jsxs)(`div`,{className:`flex flex-col items-center gap-1 cursor-pointer min-w-[60px]`,onClick:K,children:[J,Y]}),t[54]=K,t[55]=J,t[56]=X):X=t[56];let Z;t[57]!==fe||t[58]!==G||t[59]!==X?(Z=(0,_.jsxs)(`div`,{className:fe,children:[G,X]}),t[57]=fe,t[58]=G,t[59]=X,t[60]=Z):Z=t[60];let Q;t[61]!==j||t[62]!==R||t[63]!==B||t[64]!==Z||t[65]!==ue?(Q=(0,_.jsxs)(`div`,{className:ue,onClick:re,children:[j,R,B,Z]}),t[61]=j,t[62]=R,t[63]=B,t[64]=Z,t[65]=ue,t[66]=Q):Q=t[66];let $;return t[67]!==n||t[68]!==Q?($=(0,_.jsx)(`div`,{className:`fixed inset-0 z-[100] bg-black/60 flex items-center justify-center p-4 animate-fade-in`,onClick:n,children:Q}),t[67]=n,t[68]=Q,t[69]=$):$=t[69],$};function ne(e){return{id:e.id,username:e.username,name:e.full_name||e.username,avatar:e.avatar_url||``,isVerified:e.is_verified||!1}}function re(e){return e.stopPropagation()}var x=n();const S=(e,t,n)=>{let r=(0,x.c)(10),i=n===void 0?3e3:n,a;r[0]===Symbol.for(`react.memo_cache_sentinel`)?(a={threshold:.6,triggerOnce:!0},r[0]=a):a=r[0];let{ref:o,inView:s}=c(a),[l,u]=(0,g.useState)(!1),f,p;r[1]!==l||r[2]!==e||r[3]!==s||r[4]!==i||r[5]!==t?(f=()=>{let n;return s&&!l&&(n=setTimeout(async()=>{try{await d.rpc(`increment_view_count`,{target_id:e,type:t}),u(!0)}catch(e){let t=e;console.error(`Failed to track view`,t)}},i)),()=>clearTimeout(n)},p=[s,l,e,t,i],r[1]=l,r[2]=e,r[3]=s,r[4]=i,r[5]=t,r[6]=f,r[7]=p):(f=r[6],p=r[7]),(0,g.useEffect)(f,p);let m;return r[8]===o?m=r[9]:(m={ref:o},r[8]=o,r[9]=m),m};export{te as n,v as r,S as t};