const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/HomeView-BIY3KiPp.js","assets/libs-CDFYUT-j.js","assets/rolldown-runtime-Cn8xt2Gj.js","assets/vendor-CF4zx1nW.js","assets/tanstack-CjdblyHw.js","assets/supabase-CW8wD_q0.js","assets/PostItem-fPb_31rt.js","assets/useViewTracker-CtC3KOky.js","assets/useGetSuggestedUsers-yf6QhQht.js","assets/useFollowUser-B2pEa2Yj.js","assets/ProfileView-DDaHHPzN.js","assets/UserStatus-BI8pym_G.js","assets/MessagesView-BOLlrCp7.js","assets/ReelsView-BMQmIY6g.js","assets/NotificationsView-BbBkCTo_.js","assets/ExploreView-Cvt-nVxc.js","assets/AuthView-HhhOvXGw.js","assets/PostView-N0IIGuj7.js"])))=>i.map(i=>d[i]);
import{a as e}from"./rolldown-runtime-Cn8xt2Gj.js";import{$t as t,A as n,At as r,B as i,C as a,Ct as o,D as s,Dt as c,E as l,Et as u,F as d,Ft as f,G as p,H as m,I as h,It as g,J as _,K as v,Kt as y,L as b,Lt as x,M as S,N as C,Nt as w,O as T,Ot as E,P as D,Q as O,Qt as k,R as A,Rt as j,S as M,T as N,Tt as P,U as F,V as I,W as L,Wt as R,Xt as z,Y as B,Yt as V,Zt as H,an as U,b as W,bt as ee,cn as G,dn as te,en as K,et as ne,fn as re,ft as ie,gt as ae,hn as oe,ht as se,in as ce,it as le,j as ue,jt as de,k as fe,kt as pe,ln as q,lt as me,mn as he,mt as ge,nn as J,nt as _e,on as ve,ot as ye,pt as be,q as xe,qt as Se,rn as Y,rt as Ce,sn as we,tn as Te,tt as Ee,un as De,ut as Oe,vt as ke,w as Ae,x as je,y as Me,yt as Ne,z as Pe}from"./vendor-CF4zx1nW.js";import{A as Fe,J as Ie,Jt as Le,Kt as Re,M as ze,Xt as Be,Y as Ve,Yt as He,Zt as Ue,j as We,q as Ge,qt as Ke}from"./libs-CDFYUT-j.js";import{i as qe,t as Je}from"./tanstack-CjdblyHw.js";import{t as Ye}from"./supabase-CW8wD_q0.js";(function(){let e=document.createElement(`link`).relList;if(e&&e.supports&&e.supports(`modulepreload`))return;for(let e of document.querySelectorAll(`link[rel="modulepreload"]`))n(e);new MutationObserver(e=>{for(let t of e)if(t.type===`childList`)for(let e of t.addedNodes)e.tagName===`LINK`&&e.rel===`modulepreload`&&n(e)}).observe(document,{childList:!0,subtree:!0});function t(e){let t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin===`use-credentials`?t.credentials=`include`:e.crossOrigin===`anonymous`?t.credentials=`omit`:t.credentials=`same-origin`,t}function n(e){if(e.ep)return;e.ep=!0;let n=t(e);fetch(e.href,n)}})();var Xe=he(),X=oe(),Ze=e(Be(),1),Qe=e(He(),1),$e=e(Le(),1),et=e(Ke(),1),tt=e(Re(),1);Ze.default.extend(Qe.default),Ze.default.extend($e.default),Ze.default.extend(et.default),Ze.default.extend(tt.default);var nt=H();const rt=_((e,t)=>({currentUser:{id:``,username:``,name:``,avatar:``,stats:{posts:0,followers:0,following:0}},stories:[],posts:[],savedPostIds:new Set,followedUsers:new Set,theme:`dark`,toastMessage:null,isCreateModalOpen:!1,isEditProfileOpen:!1,viewingStory:null,viewingPost:null,viewingReel:null,isSidebarExpanded:!0,unreadNotificationsCount:0,unreadMessagesCount:0,setUnreadNotificationsCount:t=>e({unreadNotificationsCount:t}),setUnreadMessagesCount:t=>e({unreadMessagesCount:t}),toggleSidebar:()=>e(e=>({isSidebarExpanded:!e.isSidebarExpanded})),toggleTheme:()=>e(e=>({theme:e.theme===`dark`?`light`:`dark`})),setToastMessage:t=>e({toastMessage:t}),showToast:e=>{xe(e)},setCreateModalOpen:t=>e({isCreateModalOpen:t}),setEditProfileOpen:t=>e({isEditProfileOpen:t}),setViewingStory:t=>e({viewingStory:t}),setViewingPost:t=>e({viewingPost:t}),setViewingReel:t=>e({viewingReel:t}),setCurrentUser:t=>e({currentUser:t}),addStory:n=>e(e=>{let r={id:String(Date.now()),username:e.currentUser.username,img:n,isUser:!0};return t().showToast(`Story added`),{stories:[r,...e.stories.filter(e=>!e.isUser)]}})})),it=(0,X.createContext)(void 0),at=()=>{let e=(0,X.useContext)(it);if(e===void 0)throw Error(`useAuth must be used within an AuthProvider`);return e};function Z(...e){return Ie(Ve(e))}var Q=ce();function ot(e){let t=(0,nt.c)(8),n,r;t[0]===e?(n=t[1],r=t[2]):({className:n,...r}=e,t[0]=e,t[1]=n,t[2]=r);let i;t[3]===n?i=t[4]:(i=Z(`relative flex size-8 shrink-0 overflow-hidden rounded-full`,n),t[3]=n,t[4]=i);let a;return t[5]!==r||t[6]!==i?(a=(0,Q.jsx)(L,{"data-slot":`avatar`,className:i,...r}),t[5]=r,t[6]=i,t[7]=a):a=t[7],a}function st(e){let t=(0,nt.c)(8),n,r;t[0]===e?(n=t[1],r=t[2]):({className:n,...r}=e,t[0]=e,t[1]=n,t[2]=r);let i;t[3]===n?i=t[4]:(i=Z(`aspect-square size-full`,n),t[3]=n,t[4]=i);let a;return t[5]!==r||t[6]!==i?(a=(0,Q.jsx)(F,{"data-slot":`avatar-image`,className:i,...r}),t[5]=r,t[6]=i,t[7]=a):a=t[7],a}function ct(e){let t=(0,nt.c)(8),n,r;t[0]===e?(n=t[1],r=t[2]):({className:n,...r}=e,t[0]=e,t[1]=n,t[2]=r);let i;t[3]===n?i=t[4]:(i=Z(`bg-muted flex size-full items-center justify-center rounded-full`,n),t[3]=n,t[4]=i);let a;return t[5]!==r||t[6]!==i?(a=(0,Q.jsx)(m,{"data-slot":`avatar-fallback`,className:i,...r}),t[5]=r,t[6]=i,t[7]=a):a=t[7],a}var lt=H(),ut=Ge(`inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive`,{variants:{variant:{default:`bg-primary text-primary-foreground hover:bg-primary/90`,destructive:`bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60`,outline:`border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50`,secondary:`bg-secondary text-secondary-foreground hover:bg-secondary/80`,ghost:`hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50`,link:`text-primary underline-offset-4 hover:underline`},size:{default:`h-9 px-4 py-2 has-[>svg]:px-3`,sm:`h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5`,lg:`h-10 rounded-md px-6 has-[>svg]:px-4`,icon:`size-9`,"icon-sm":`size-8`,"icon-lg":`size-10`}},defaultVariants:{variant:`default`,size:`default`}});function dt(e){let t=(0,lt.c)(16),n,r,i,a,o;t[0]===e?(n=t[1],r=t[2],i=t[3],a=t[4],o=t[5]):({className:n,variant:i,size:a,asChild:o,...r}=e,t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=a,t[5]=o);let s=i===void 0?`default`:i,c=a===void 0?`default`:a,l=o!==void 0&&o?p:`button`,u;t[6]!==n||t[7]!==c||t[8]!==s?(u=Z(ut({variant:s,size:c,className:n})),t[6]=n,t[7]=c,t[8]=s,t[9]=u):u=t[9];let d;return t[10]!==l||t[11]!==r||t[12]!==c||t[13]!==u||t[14]!==s?(d=(0,Q.jsx)(l,{"data-slot":`button`,"data-variant":s,"data-size":c,className:u,...r}),t[10]=l,t[11]=r,t[12]=c,t[13]=u,t[14]=s,t[15]=d):d=t[15],d}var ft=H(),pt=()=>{let e=(0,ft.c)(96),{toggleTheme:t,currentUser:n,setCreateModalOpen:i,isSidebarExpanded:a,toggleSidebar:s,unreadNotificationsCount:c,unreadMessagesCount:l}=rt(),{signOut:u}=at(),d,p,m,h;e[0]===Symbol.for(`react.memo_cache_sentinel`)?(d={icon:(0,Q.jsx)(pe,{size:24}),label:`Home`,path:`/`},p={icon:(0,Q.jsx)(Oe,{size:24}),label:`Explore`,path:`/explore`},m={icon:(0,Q.jsx)(f,{size:24}),label:`Reels`,path:`/reels`},h=(0,Q.jsx)(ee,{size:24}),e[0]=d,e[1]=p,e[2]=m,e[3]=h):(d=e[0],p=e[1],m=e[2],h=e[3]);let g=l>0?l>99?`99+`:l:void 0,_;e[4]===g?_=e[5]:(_={icon:h,label:`Messages`,path:`/messages`,badge:g},e[4]=g,e[5]=_);let v;e[6]===Symbol.for(`react.memo_cache_sentinel`)?(v=(0,Q.jsx)(r,{size:24}),e[6]=v):v=e[6];let y=c>0?c>99?`99+`:c:void 0,b;e[7]===y?b=e[8]:(b={icon:v,label:`Notifications`,path:`/notifications`,badge:y},e[7]=y,e[8]=b);let x;e[9]!==_||e[10]!==b?(x=[d,p,m,_,b],e[9]=_,e[10]=b,e[11]=x):x=e[11];let S=x,C=`hidden md:flex flex-col ${a?`w-[245px]`:`w-[72px]`} h-screen fixed border-r border-border p-4 pb-5 justify-between z-50 transition-all duration-300 bg-background text-foreground`,w=`mb-8 mt-4 ${a?`px-2`:`flex justify-center`}`,T;e[12]===a?T=e[13]:(T=a?(0,Q.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,Q.jsx)(`img`,{src:`/icon.png`,alt:`Logo`,className:`w-8 h-8 object-contain`}),(0,Q.jsx)(`h1`,{className:`text-xl font-bold tracking-tight text-[#006a4e]`,children:`Banglagram`})]}):(0,Q.jsx)(ve,{to:`/`,className:`flex justify-center items-center`,children:(0,Q.jsx)(`img`,{src:`/icon.png`,alt:`Banglagram`,className:`w-8 h-8 object-contain`})}),e[12]=a,e[13]=T);let E;e[14]!==w||e[15]!==T?(E=(0,Q.jsx)(`div`,{className:w,children:T}),e[14]=w,e[15]=T,e[16]=E):E=e[16];let D;e[17]!==a||e[18]!==S?(D=S.map((e,t)=>(0,Q.jsx)(we,{to:e.path,className:mt,children:t=>{let{isActive:n}=t;return(0,Q.jsxs)(V.div,{whileTap:{scale:.98},className:`flex items-center ${a?`gap-4 px-3`:`justify-center`} py-3 rounded-lg hover:bg-muted`,children:[(0,Q.jsxs)(`div`,{className:`relative`,children:[(0,Q.jsx)(`div`,{className:n?`text-[#006a4e]`:``,children:e.icon}),e.badge&&(0,Q.jsx)(`div`,{className:`absolute -top-2 -right-2 bg-[#f42a41] text-white text-[10px] font-bold h-4 min-w-[16px] px-1 flex items-center justify-center rounded-full border-2 border-black`,children:e.badge})]}),a&&(0,Q.jsx)(`span`,{className:`text-base truncate`,children:e.label===`Home`?`Home`:e.label===`Explore`?`Explore`:e.label===`Reels`?`Reels`:e.label===`Messages`?`Messages`:e.label===`Notifications`?`Notifications`:e.label})]})}},t)),e[17]=a,e[18]=S,e[19]=D):D=e[19];let O;e[20]===i?O=e[21]:(O=()=>i(!0),e[20]=i,e[21]=O);let k=!a&&`justify-center px-0`,A;e[22]===k?A=e[23]:(A=Z(`flex items-center justify-start w-full gap-4 px-3 py-6 rounded-lg transition-colors cursor-pointer group hover:bg-muted`,k),e[22]=k,e[23]=A);let j;e[24]===Symbol.for(`react.memo_cache_sentinel`)?(j={scale:.98},e[24]=j):j=e[24];let M;e[25]===Symbol.for(`react.memo_cache_sentinel`)?(M=(0,Q.jsx)(`div`,{className:`relative`,children:(0,Q.jsx)(le,{size:24})}),e[25]=M):M=e[25];let N;e[26]===a?N=e[27]:(N=a&&(0,Q.jsx)(`span`,{className:`text-base truncate ml-2 font-normal`,children:`Create`}),e[26]=a,e[27]=N);let P;e[28]===N?P=e[29]:(P=(0,Q.jsxs)(V.div,{whileTap:j,className:`w-full h-full flex items-center`,children:[M,N]}),e[28]=N,e[29]=P);let F;e[30]!==O||e[31]!==A||e[32]!==P?(F=(0,Q.jsx)(dt,{variant:`ghost`,onClick:O,className:A,asChild:!0,children:P}),e[30]=O,e[31]=A,e[32]=P,e[33]=F):F=e[33];let I=`/profile/${n.username}`,L;e[34]!==n.avatar||e[35]!==n.username?.[0]||e[36]!==a?(L=e=>{let{isActive:t}=e;return(0,Q.jsxs)(V.div,{whileTap:{scale:.98},className:`flex items-center ${a?`gap-4 px-3`:`justify-center`} py-3 rounded-lg hover:bg-muted`,children:[(0,Q.jsxs)(ot,{className:Z(`w-6 h-6`,t&&`border-2 border-[#006a4e]`),children:[(0,Q.jsx)(st,{src:n.avatar}),(0,Q.jsx)(ct,{children:n.username?.[0]?.toUpperCase()||`?`})]}),a&&(0,Q.jsx)(`span`,{className:`text-base truncate`,children:`Profile`})]})},e[34]=n.avatar,e[35]=n.username?.[0],e[36]=a,e[37]=L):L=e[37];let R;e[38]!==I||e[39]!==L?(R=(0,Q.jsx)(we,{to:I,className:ht,children:L}),e[38]=I,e[39]=L,e[40]=R):R=e[40];let z;e[41]!==D||e[42]!==F||e[43]!==R?(z=(0,Q.jsxs)(`div`,{className:`flex flex-col gap-2`,children:[D,F,R]}),e[41]=D,e[42]=F,e[43]=R,e[44]=z):z=e[44];let B;e[45]!==E||e[46]!==z?(B=(0,Q.jsxs)(`div`,{children:[E,z]}),e[45]=E,e[46]=z,e[47]=B):B=e[47];let H=!a&&`justify-center px-0`,U;e[48]===H?U=e[49]:(U=Z(`flex items-center justify-start w-full gap-4 px-3 py-6 rounded-lg transition-colors cursor-pointer group hover:bg-muted`,H),e[48]=H,e[49]=U);let W;e[50]===Symbol.for(`react.memo_cache_sentinel`)?(W={scale:.98},e[50]=W):W=e[50];let G,te;e[51]===Symbol.for(`react.memo_cache_sentinel`)?(G=(0,Q.jsx)(_e,{size:24,className:`dark:hidden`}),te=(0,Q.jsx)(ke,{size:24,className:`hidden dark:block`}),e[51]=G,e[52]=te):(G=e[51],te=e[52]);let K;e[53]===a?K=e[54]:(K=a&&(0,Q.jsx)(`span`,{className:`text-base ml-4 font-normal`,children:`Switch Appearance`}),e[53]=a,e[54]=K);let ne;e[55]===K?ne=e[56]:(ne=(0,Q.jsxs)(V.div,{whileTap:W,className:`w-full h-full flex items-center`,children:[G,te,K]}),e[55]=K,e[56]=ne);let re;e[57]!==U||e[58]!==ne||e[59]!==t?(re=(0,Q.jsx)(dt,{variant:`ghost`,onClick:t,className:U,asChild:!0,children:ne}),e[57]=U,e[58]=ne,e[59]=t,e[60]=re):re=e[60];let ie=!a&&`justify-center px-0`,ae;e[61]===ie?ae=e[62]:(ae=Z(`flex items-center justify-start w-full gap-4 px-3 py-6 rounded-lg transition-colors cursor-pointer group hover:bg-muted`,ie),e[61]=ie,e[62]=ae);let oe;e[63]===Symbol.for(`react.memo_cache_sentinel`)?(oe={scale:.98},e[63]=oe):oe=e[63];let ce,ue;e[64]===a?(ce=e[65],ue=e[66]):(ce=a?(0,Q.jsx)(se,{size:24}):(0,Q.jsx)(ge,{size:24}),ue=a&&(0,Q.jsx)(`span`,{className:`text-base ml-4 font-normal`,children:`Collapse`}),e[64]=a,e[65]=ce,e[66]=ue);let de;e[67]!==ce||e[68]!==ue?(de=(0,Q.jsxs)(V.div,{whileTap:oe,className:`w-full h-full flex items-center`,children:[ce,ue]}),e[67]=ce,e[68]=ue,e[69]=de):de=e[69];let fe;e[70]!==ae||e[71]!==de||e[72]!==s?(fe=(0,Q.jsx)(dt,{variant:`ghost`,onClick:s,className:ae,asChild:!0,children:de}),e[70]=ae,e[71]=de,e[72]=s,e[73]=fe):fe=e[73];let q;e[74]===u?q=e[75]:(q=()=>u(),e[74]=u,e[75]=q);let me=!a&&`justify-center px-0`,he;e[76]===me?he=e[77]:(he=Z(`flex items-center justify-start w-full gap-4 px-3 py-6 rounded-lg transition-colors cursor-pointer group hover:bg-muted text-destructive hover:text-destructive/80`,me),e[76]=me,e[77]=he);let J;e[78]===Symbol.for(`react.memo_cache_sentinel`)?(J={scale:.98},e[78]=J):J=e[78];let ye;e[79]===Symbol.for(`react.memo_cache_sentinel`)?(ye=(0,Q.jsx)(o,{size:24}),e[79]=ye):ye=e[79];let be;e[80]===a?be=e[81]:(be=a&&(0,Q.jsx)(`span`,{className:`text-base ml-4 font-normal`,children:`Log Out`}),e[80]=a,e[81]=be);let xe;e[82]===be?xe=e[83]:(xe=(0,Q.jsxs)(V.div,{whileTap:J,className:`w-full h-full flex items-center`,children:[ye,be]}),e[82]=be,e[83]=xe);let Se;e[84]!==q||e[85]!==he||e[86]!==xe?(Se=(0,Q.jsx)(dt,{variant:`ghost`,onClick:q,className:he,asChild:!0,children:xe}),e[84]=q,e[85]=he,e[86]=xe,e[87]=Se):Se=e[87];let Y;e[88]!==re||e[89]!==fe||e[90]!==Se?(Y=(0,Q.jsxs)(`div`,{className:`flex flex-col gap-2`,children:[re,fe,Se]}),e[88]=re,e[89]=fe,e[90]=Se,e[91]=Y):Y=e[91];let Ce;return e[92]!==C||e[93]!==B||e[94]!==Y?(Ce=(0,Q.jsxs)(`div`,{className:C,children:[B,Y]}),e[92]=C,e[93]=B,e[94]=Y,e[95]=Ce):Ce=e[95],Ce};function mt(e){let{isActive:t}=e;return`block rounded-lg transition-colors cursor-pointer group ${t?`font-bold`:``}`}function ht(e){let{isActive:t}=e;return`block rounded-lg transition-colors cursor-pointer group ${t?`font-bold`:``}`}var gt=H(),_t=()=>{let e=(0,gt.c)(19),{currentUser:t,setCreateModalOpen:n}=rt(),r;e[0]===Symbol.for(`react.memo_cache_sentinel`)?(r=[{icon:(0,Q.jsx)(pe,{size:24}),label:`Home`,path:`/`},{icon:(0,Q.jsx)(Oe,{size:24}),label:`Explore`,path:`/explore`},{icon:(0,Q.jsx)(f,{size:24}),label:`Reels`,path:`/reels`}],e[0]=r):r=e[0];let i=r,a;e[1]===Symbol.for(`react.memo_cache_sentinel`)?(a=i.map(yt),e[1]=a):a=e[1];let o;e[2]===Symbol.for(`react.memo_cache_sentinel`)?(o={scale:.8},e[2]=o):o=e[2];let s;e[3]===n?s=e[4]:(s=()=>n(!0),e[3]=n,e[4]=s);let c;e[5]===Symbol.for(`react.memo_cache_sentinel`)?(c=(0,Q.jsx)(le,{size:24}),e[5]=c):c=e[5];let l;e[6]===s?l=e[7]:(l=(0,Q.jsx)(V.div,{whileTap:o,className:`p-3`,onClick:s,children:c}),e[6]=s,e[7]=l);let u;e[8]===Symbol.for(`react.memo_cache_sentinel`)?(u={scale:.8},e[8]=u):u=e[8];let d;e[9]===Symbol.for(`react.memo_cache_sentinel`)?(d=(0,Q.jsx)(we,{to:`/messages`,className:bt,children:(0,Q.jsx)(V.div,{whileTap:u,className:`p-3`,children:(0,Q.jsx)(ee,{size:24})})}),e[9]=d):d=e[9];let p=`/profile/${t.username}`,m;e[10]!==t.avatar||e[11]!==t.username?.[0]?(m=e=>{let{isActive:n}=e;return(0,Q.jsx)(V.div,{whileTap:{scale:.8},className:`p-3`,children:(0,Q.jsxs)(ot,{className:Z(`w-6 h-6`,n&&`border-2 border-[#006a4e]`),children:[(0,Q.jsx)(st,{src:t.avatar}),(0,Q.jsx)(ct,{children:t.username?.[0]?.toUpperCase()||`?`})]})})},e[10]=t.avatar,e[11]=t.username?.[0],e[12]=m):m=e[12];let h;e[13]!==p||e[14]!==m?(h=(0,Q.jsx)(we,{to:p,className:xt,children:m}),e[13]=p,e[14]=m,e[15]=h):h=e[15];let g;return e[16]!==h||e[17]!==l?(g=(0,Q.jsxs)(`div`,{className:`md:hidden fixed bottom-0 left-0 right-0 border-t border-border flex justify-around items-center h-12 z-50 px-2 pb-safe bg-background/90 text-foreground backdrop-blur-md bg-opacity-90`,children:[a,l,d,h]}),e[16]=h,e[17]=l,e[18]=g):g=e[18],g};function vt(e){let{isActive:t}=e;return`block ${t?`text-[#006a4e]`:``}`}function yt(e,t){return(0,Q.jsx)(we,{to:e.path,className:vt,children:(0,Q.jsx)(V.div,{whileTap:{scale:.8},className:`p-3`,children:e.icon})},t)}function bt(e){let{isActive:t}=e;return`block ${t?`text-[#006a4e]`:``}`}function xt(e){let{isActive:t}=e;return`block ${t?`text-[#006a4e]`:``}`}var St=H(),Ct=()=>{let e=(0,St.c)(14),{isSidebarExpanded:t}=rt(),{user:n}=at(),r=te(),i;e[0]===r.pathname?i=e[1]:(i=r.pathname.startsWith(`/messages`),e[0]=r.pathname,e[1]=i);let a=i,o;e[2]===r.pathname?o=e[3]:(o=r.pathname.startsWith(`/reels`),e[2]=r.pathname,e[3]=o);let s=o,c;e[4]!==a||e[5]!==s||e[6]!==n?(c=n?(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(pt,{}),!a&&!s&&(0,Q.jsx)(_t,{})]}):(0,Q.jsx)(`div`,{className:`fixed top-4 right-4 z-[60]`,children:(0,Q.jsx)(ve,{to:`/`,className:`bg-[#006a4e] text-white px-4 py-2 rounded-lg font-semibold text-sm shadow-lg hover:bg-[#00523c] transition-colors`,children:`Log In`})}),e[4]=a,e[5]=s,e[6]=n,e[7]=c):c=e[7];let l=`flex-grow ${n?t?`md:ml-[245px]`:`md:ml-[72px]`:``} flex justify-center transition-all duration-300 ${n&&!a&&!s?`pb-14 md:pb-0`:``}`,u;e[8]===Symbol.for(`react.memo_cache_sentinel`)?(u=(0,Q.jsx)(G,{}),e[8]=u):u=e[8];let d;e[9]===l?d=e[10]:(d=(0,Q.jsx)(`main`,{className:l,children:u}),e[9]=l,e[10]=d);let f;return e[11]!==c||e[12]!==d?(f=(0,Q.jsxs)(`div`,{className:`min-h-screen font-['Hind_Siliguri'] flex flex-col md:flex-row transition-colors duration-300 bg-background text-foreground`,children:[c,d]}),e[11]=c,e[12]=d,e[13]=f):f=e[13],f};const $=Ye(`https://uyffyqlgyjieayivgvhg.supabase.co`,`sb_publishable_WFDkcqORIdT_6pMJSoxjQg_EMHEKNfb`);var wt=H();const Tt=()=>{let e=(0,wt.c)(12),{user:t}=at(),n;e[0]===t?n=e[1]:(n=async()=>{if(t)try{let e=new Date().toISOString();await $.from(`profiles`).update({last_seen:e,is_online:!0}).eq(`id`,t.id)}catch(e){let t=e;console.error(`Error updating last seen:`,t)}},e[0]=t,e[1]=n);let r=n,i;e[2]===t?i=e[3]:(i=async()=>{if(t)try{let e=new Date().toISOString();await $.from(`profiles`).update({last_seen:e,is_online:!1}).eq(`id`,t.id)}catch(e){let t=e;console.error(`Error updating offline status:`,t)}},e[2]=t,e[3]=i);let a=i,o,s;e[4]!==r||e[5]!==a||e[6]!==t?(o=()=>{if(!t)return;r();let e=setInterval(r,3e4),n=()=>{document.hidden?a():r()},i=()=>{a()};return document.addEventListener(`visibilitychange`,n),window.addEventListener(`beforeunload`,i),()=>{clearInterval(e),document.removeEventListener(`visibilitychange`,n),window.removeEventListener(`beforeunload`,i)}},s=[t,r,a],e[4]=r,e[5]=a,e[6]=t,e[7]=o,e[8]=s):(o=e[7],s=e[8]),(0,X.useEffect)(o,s);let c;return e[9]!==r||e[10]!==a?(c={updateLastSeen:r,updateOfflineStatus:a},e[9]=r,e[10]=a,e[11]=c):c=e[11],c};var Et=H(),Dt=60*1e3;const Ot=()=>{let e=(0,Et.c)(3),{user:t}=at(),n,r;e[0]===t?(n=e[1],r=e[2]):(n=()=>{if(!t)return;let e=async()=>{try{await $.from(`profiles`).update({is_online:!0,last_seen:new Date().toISOString()}).eq(`id`,t.id)}catch(e){let t=e;console.error(`Error updating online status:`,t)}};e();let n=setInterval(e,Dt),r=()=>{document.visibilityState===`visible`&&e()};return document.addEventListener(`visibilitychange`,r),()=>{clearInterval(n),document.removeEventListener(`visibilitychange`,r)}},r=[t],e[0]=t,e[1]=n,e[2]=r),(0,X.useEffect)(n,r)};var kt=H(),At=e(Be(),1);const jt=[`feed`],Mt=e=>{let t=(0,kt.c)(2),n;return t[0]===e?n=t[1]:(n={queryKey:jt,queryFn:async t=>{let{pageParam:n}=t,r=n===void 0?0:n,{data:i,error:a}=await $.rpc(`get_ranked_feed_v2`,{current_user_id:e,limit_count:10,offset_count:r*10});if(a)throw a;let o=i||[];return o.length>0&&(console.log(`FIRST POST RAW DATA V2:`,o[0]),console.log(`VIEW COUNT VALUE:`,o[0].view_count)),o.map(Nt)},initialPageParam:0,getNextPageParam:Pt},t[0]=e,t[1]=n),K(n)};function Nt(e){return{id:e.id,user:{id:e.user_id,username:e.username,name:e.full_name||e.username,avatar:e.avatar_url||``,isVerified:e.is_verified||!1},content:{type:e.type===`reel`?`video`:`image`,src:e.type===`reel`?e.video_url:e.image_url},likes:e.likes_count||0,caption:e.caption||``,comments:e.comments_count||0,views:Number(e.view_count||0),time:(0,At.default)(e.created_at).fromNow(),createdAt:e.created_at,isVerified:e.is_verified||!1,hasLiked:e.has_liked,hasSaved:e.has_saved}}function Pt(e,t){return e.length===10?t.length:void 0}var Ft=H(),It=e(Be(),1);const Lt=e=>[`profile`,e],Rt=(e,t)=>{let n=(0,Ft.c)(9),r=e||``,i;n[0]===r?i=n[1]:(i=Lt(r),n[0]=r,n[1]=i);let a=!!e,o;n[2]!==t||n[3]!==e?(o=async()=>{if(!e)throw Error(`Username required`);let{data:n,error:r}=await $.from(`profiles`).select(`id, username, full_name, avatar_url, bio, is_verified, is_online, last_seen`).eq(`username`,e).single();if(r)throw r;let i=n,{count:a}=await $.from(`posts`).select(`*`,{count:`exact`,head:!0}).eq(`user_id`,i.id),{count:o}=await $.from(`follows`).select(`*`,{count:`exact`,head:!0}).eq(`following_id`,i.id),{count:s}=await $.from(`follows`).select(`*`,{count:`exact`,head:!0}).eq(`follower_id`,i.id),{data:c}=await $.from(`posts`).select(`
           id,
           image_url,
           caption,
           created_at,
           likes (count),
           comments (count)
        `).eq(`user_id`,i.id).order(`created_at`,{ascending:!1}),l=c||[],u=new Set;if(t&&l.length>0){let e=l.map(zt),{data:n}=await $.from(`likes`).select(`post_id`).eq(`user_id`,t).in(`post_id`,e);n&&n.forEach(e=>u.add(e.post_id||``))}let d=!1;if(t&&t!==i.id){let{count:e}=await $.from(`follows`).select(`*`,{count:`exact`,head:!0}).match({follower_id:t,following_id:i.id});d=!!e&&e>0}let f=l.map(e=>{let t=e.likes,n=e.comments;return{id:e.id,user:{id:i.id,username:i.username,name:i.full_name||i.username,avatar:i.avatar_url||``,isVerified:i.is_verified||!1},content:{type:`image`,src:e.image_url},likes:t[0]?.count||0,caption:e.caption||``,comments:n[0]?.count||0,time:(0,It.default)(e.created_at).fromNow(),isVerified:i.is_verified||!1,hasLiked:u.has(e.id)}});return{user:{id:i.id,username:i.username,name:i.full_name||``,avatar:i.avatar_url||``,bio:i.bio||``,isVerified:i.is_verified||!1,stats:{posts:a||0,followers:o||0,following:s||0},isFollowing:d,isOnline:i.is_online,lastSeen:i.last_seen},posts:f}},n[2]=t,n[3]=e,n[4]=o):o=n[4];let s;return n[5]!==i||n[6]!==a||n[7]!==o?(s={queryKey:i,enabled:a,queryFn:o},n[5]=i,n[6]=a,n[7]=o,n[8]=s):s=n[8],J(s)};function zt(e){return e.id}var Bt=H(),Vt=e(Be(),1);const Ht=()=>{let e=(0,Bt.c)(2),t=Y(),n;return e[0]===t?n=e[1]:(n={mutationFn:Ut,onSuccess:(e,n)=>{t.invalidateQueries({queryKey:jt}),t.invalidateQueries({queryKey:Lt(n.username)})}},e[0]=t,e[1]=n),Te(n)};async function Ut(e){let{files:t,caption:n,userId:r}=e,i=t.map(async e=>{let t=e.name.split(`.`).pop(),n=`${r}/${(0,Vt.default)().valueOf()}_${Math.random().toString(36).substr(2,9)}.${t}`,{error:i}=await $.storage.from(`posts`).upload(n,e,{cacheControl:`3600`,upsert:!1,contentType:e.type});if(i)throw i;let{data:a}=$.storage.from(`posts`).getPublicUrl(n),{publicUrl:o}=a;return o}),a=await Promise.all(i),o=JSON.stringify(a),{data:s,error:c}=await $.from(`posts`).insert({user_id:r,caption:n,image_url:o}).select().single();if(c)throw c;return s}var Wt=H();const Gt=[`reels`],Kt=e=>{let t=(0,Wt.c)(2),n;return t[0]===e?n=t[1]:(n={queryKey:Gt,initialPageParam:0,queryFn:async t=>{let{pageParam:n}=t,r=(n===void 0?0:n)*5,i=r+4,{data:a,error:o}=await $.from(`reels`).select(`
          *,
          profiles (username, full_name, avatar_url, is_verified),
          likes (count),
          comments (count)
        `).order(`created_at`,{ascending:!1}).range(r,i);if(o)throw o;let s=a||[],c=s.map(qt),l=new Set,u=Array.from(new Set(s.map(Jt))),d=new Set;if(e){if(c.length>0){let{data:t}=await $.from(`likes`).select(`reel_id`).eq(`user_id`,e).in(`reel_id`,c);t&&t.forEach(e=>l.add(e.reel_id||``))}if(u.length>0){let{data:t}=await $.from(`follows`).select(`following_id`).eq(`follower_id`,e).in(`following_id`,u);t&&t.forEach(e=>d.add(e.following_id))}}return s.map(e=>({id:e.id,userId:e.user_id,user:{id:e.user_id,username:e.profiles?.username||`Unknown`,name:e.profiles?.full_name||`Unknown`,avatar:e.profiles?.avatar_url||``,isVerified:e.profiles?.is_verified||!1,isFollowing:d.has(e.user_id)},src:e.video_url,likes:e.likes?.[0]?.count||0,comments:e.comments?.[0]?.count||0,views:e.view_count||0,caption:e.caption||``,audio:e.audio_track_name||`Original Audio`,hasLiked:l.has(e.id)}))},getNextPageParam:Yt},t[0]=e,t[1]=n),K(n)};function qt(e){return e.id}function Jt(e){return e.user_id}function Yt(e,t){return e.length===5?t.length:void 0}var Xt=H(),Zt=e(Be(),1);const Qt=()=>{let e=(0,Xt.c)(2),t=Y(),n;return e[0]===t?n=e[1]:(n={mutationFn:$t,onSuccess:()=>{t.invalidateQueries({queryKey:Gt})}},e[0]=t,e[1]=n),Te(n)};async function $t(e){let{file:t,caption:n,userId:r}=e,i=t.name.split(`.`).pop(),a=`${r}/${(0,Zt.default)().valueOf()}.${i}`,{error:o}=await $.storage.from(`reels`).upload(a,t,{cacheControl:`3600`,upsert:!1,contentType:t.type});if(o)throw o;let{data:s}=$.storage.from(`reels`).getPublicUrl(a),{publicUrl:c}=s,{data:l,error:u}=await $.from(`reels`).insert({user_id:r,caption:n,video_url:c}).select().single();if(u)throw u;return l}var en=H();const tn=[`stories`],nn=e=>{let t=(0,en.c)(2),n;return t[0]===e?n=t[1]:(n={queryKey:tn,queryFn:async()=>{let{data:t,error:n}=await $.from(`stories`).select(`
            *,
            user:profiles (
                username,
                avatar_url,
                is_verified
            )
        `).order(`created_at`,{ascending:!1});if(n)throw n;return t.map(t=>({id:t.id,username:t.user?.username||`User`,userAvatar:t.user?.avatar_url||``,img:t.media_url,isUser:t.user_id===e,isVerified:t.user?.is_verified||!1,createdAt:t.created_at}))}},t[0]=e,t[1]=n),J(n)};var rn=H(),an=e(Be(),1);const on=()=>{let e=(0,rn.c)(2),t=Y(),n;return e[0]===t?n=e[1]:(n={mutationFn:sn,onSuccess:()=>{t.invalidateQueries({queryKey:tn})}},e[0]=t,e[1]=n),Te(n)};async function sn(e){let{file:t,userId:n}=e,r=t.name.split(`.`).pop(),i=`${`${n}-${(0,an.default)().valueOf()}.${r}`}`,{error:a}=await $.storage.from(`stories`).upload(i,t);if(a)throw a;let{data:o}=$.storage.from(`stories`).getPublicUrl(i),{publicUrl:s}=o,c=(0,an.default)().add(24,`hour`),{error:l}=await $.from(`stories`).insert({user_id:n,media_url:s,expires_at:c.toISOString()});if(l)throw l}var cn=H();function ln(e){let t=(0,cn.c)(8),n,r;t[0]===e?(n=t[1],r=t[2]):({className:n,...r}=e,t[0]=e,t[1]=n,t[2]=r);let i;t[3]===n?i=t[4]:(i=Z(`border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm`,n),t[3]=n,t[4]=i);let a;return t[5]!==r||t[6]!==i?(a=(0,Q.jsx)(`textarea`,{"data-slot":`textarea`,className:i,...r}),t[5]=r,t[6]=i,t[7]=a):a=t[7],a}var un=H();function dn(e){let t=(0,un.c)(4),n;t[0]===e?n=t[1]:({...n}=e,t[0]=e,t[1]=n);let r;return t[2]===n?r=t[3]:(r=(0,Q.jsx)(i,{"data-slot":`dialog`,...n}),t[2]=n,t[3]=r),r}function fn(e){let t=(0,un.c)(4),n;t[0]===e?n=t[1]:({...n}=e,t[0]=e,t[1]=n);let r;return t[2]===n?r=t[3]:(r=(0,Q.jsx)(Pe,{"data-slot":`dialog-portal`,...n}),t[2]=n,t[3]=r),r}function pn(e){let t=(0,un.c)(8),n,r;t[0]===e?(n=t[1],r=t[2]):({className:n,...r}=e,t[0]=e,t[1]=n,t[2]=r);let i;t[3]===n?i=t[4]:(i=Z(`data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50`,n),t[3]=n,t[4]=i);let a;return t[5]!==r||t[6]!==i?(a=(0,Q.jsx)(A,{"data-slot":`dialog-overlay`,className:i,...r}),t[5]=r,t[6]=i,t[7]=a):a=t[7],a}function mn(e){let t=(0,un.c)(15),n,r,i,a;t[0]===e?(n=t[1],r=t[2],i=t[3],a=t[4]):({className:r,children:n,showCloseButton:a,...i}=e,t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=a);let o=a===void 0?!0:a,s;t[5]===Symbol.for(`react.memo_cache_sentinel`)?(s=(0,Q.jsx)(pn,{}),t[5]=s):s=t[5];let c;t[6]===r?c=t[7]:(c=Z(`bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 outline-none sm:max-w-lg`,r),t[6]=r,t[7]=c);let l;t[8]===o?l=t[9]:(l=o&&(0,Q.jsxs)(h,{"data-slot":`dialog-close`,className:`ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4`,children:[(0,Q.jsx)(B,{}),(0,Q.jsx)(`span`,{className:`sr-only`,children:`Close`})]}),t[8]=o,t[9]=l);let u;return t[10]!==n||t[11]!==i||t[12]!==c||t[13]!==l?(u=(0,Q.jsxs)(fn,{"data-slot":`dialog-portal`,children:[s,(0,Q.jsxs)(b,{"data-slot":`dialog-content`,className:c,...i,children:[n,l]})]}),t[10]=n,t[11]=i,t[12]=c,t[13]=l,t[14]=u):u=t[14],u}function hn(e){let t=(0,un.c)(8),n,r;t[0]===e?(n=t[1],r=t[2]):({className:n,...r}=e,t[0]=e,t[1]=n,t[2]=r);let i;t[3]===n?i=t[4]:(i=Z(`flex flex-col gap-2 text-center sm:text-left`,n),t[3]=n,t[4]=i);let a;return t[5]!==r||t[6]!==i?(a=(0,Q.jsx)(`div`,{"data-slot":`dialog-header`,className:i,...r}),t[5]=r,t[6]=i,t[7]=a):a=t[7],a}function gn(e){let t=(0,un.c)(8),n,r;t[0]===e?(n=t[1],r=t[2]):({className:n,...r}=e,t[0]=e,t[1]=n,t[2]=r);let i;t[3]===n?i=t[4]:(i=Z(`text-lg leading-none font-semibold`,n),t[3]=n,t[4]=i);let a;return t[5]!==r||t[6]!==i?(a=(0,Q.jsx)(I,{"data-slot":`dialog-title`,className:i,...r}),t[5]=r,t[6]=i,t[7]=a):a=t[7],a}var _n=({onFileSelect:e,accept:t={"image/*":[],"video/*":[]},maxSize:n=100*1024*1024,multiple:r=!1})=>{let{getRootProps:i,getInputProps:a,isDragActive:o,isDragReject:s}=d({onDrop:(0,X.useCallback)(t=>{t&&t.length>0&&e(t)},[e]),accept:t,maxSize:n,multiple:r}),l=o?`border-primary`:s?`border-destructive`:`border-border`,u=o?`bg-primary/10`:`bg-transparent`;return(0,Q.jsxs)(`div`,{...i(),className:`w-full h-full min-h-[300px] flex flex-col items-center justify-center border-2 border-dashed ${l} ${u} rounded-xl transition-colors cursor-pointer p-8`,children:[(0,Q.jsx)(`input`,{...a()}),(0,Q.jsxs)(`div`,{className:`flex flex-col items-center gap-4 text-center`,children:[(0,Q.jsxs)(`div`,{className:`flex gap-4 mb-2`,children:[(0,Q.jsx)(c,{size:40,className:`text-foreground opacity-80`}),(0,Q.jsx)(O,{size:40,className:`text-foreground opacity-80`})]}),o?(0,Q.jsx)(`p`,{className:`text-xl font-medium text-primary`,children:`Drop files here`}):s?(0,Q.jsx)(`p`,{className:`text-xl font-medium text-destructive`,children:`File not supported`}):(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(`p`,{className:`text-xl font-light text-foreground`,children:`Drag photos or videos here`}),(0,Q.jsx)(`button`,{className:`bg-primary hover:bg-primary/90 text-primary-foreground px-4 py-2 rounded-lg text-sm font-semibold transition-colors mt-4`,children:`Select`})]})]})]})},vn=H();function yn(e){let t=(0,vn.c)(8),n,r;t[0]===e?(n=t[1],r=t[2]):({className:n,...r}=e,t[0]=e,t[1]=n,t[2]=r);let i;t[3]===n?i=t[4]:(i=Z(`bg-accent animate-pulse rounded-md`,n),t[3]=n,t[4]=i);let a;return t[5]!==r||t[6]!==i?(a=(0,Q.jsx)(`div`,{"data-slot":`skeleton`,className:i,...r}),t[5]=r,t[6]=i,t[7]=a):a=t[7],a}var bn=H(),xn=e=>{let t=(0,bn.c)(24),n,r,i,a,o;t[0]===e?(n=t[1],r=t[2],i=t[3],a=t[4],o=t[5]):({src:o,alt:n,className:r,fallbacknode:i,...a}=e,t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=a,t[5]=o);let[s,c]=(0,X.useState)(!1),[l,u]=(0,X.useState)(!0);if(!o||s){if(i){let e;return t[6]===i?e=t[7]:(e=(0,Q.jsx)(Q.Fragment,{children:i}),t[6]=i,t[7]=e),e}let e=`flex items-center justify-center bg-gray-100 dark:bg-zinc-800 text-gray-400 ${r}`,n;t[8]===Symbol.for(`react.memo_cache_sentinel`)?(n=(0,Q.jsx)(E,{size:24}),t[8]=n):n=t[8];let a;return t[9]===e?a=t[10]:(a=(0,Q.jsx)(`div`,{className:e,children:n}),t[9]=e,t[10]=a),a}let d;t[11]!==r||t[12]!==l?(d=l&&(0,Q.jsx)(yn,{className:`absolute inset-0 ${r}`}),t[11]=r,t[12]=l,t[13]=d):d=t[13];let f=`${r} ${l?`opacity-0`:`opacity-100`} transition-opacity duration-300`,p,m;t[14]===Symbol.for(`react.memo_cache_sentinel`)?(p=()=>{c(!0),u(!1)},m=()=>u(!1),t[14]=p,t[15]=m):(p=t[14],m=t[15]);let h;t[16]!==n||t[17]!==a||t[18]!==o||t[19]!==f?(h=(0,Q.jsx)(`img`,{src:o,alt:n,className:f,onError:p,onLoad:m,...a}),t[16]=n,t[17]=a,t[18]=o,t[19]=f,t[20]=h):h=t[20];let g;return t[21]!==d||t[22]!==h?(g=(0,Q.jsxs)(Q.Fragment,{children:[d,h]}),t[21]=d,t[22]=h,t[23]=g):g=t[23],g},Sn=H(),Cn=e=>{let t=(0,Sn.c)(58),{images:n,aspectRatio:r,className:i,onDoubleClick:a}=e,o=r===void 0?`aspect-square`:r,[s,c]=(0,X.useState)(0),[l,u]=(0,X.useState)(0);if(n.length<=1){let e;t[0]!==o||t[1]!==i?(e=Z(`w-full relative overflow-hidden`,o,i),t[0]=o,t[1]=i,t[2]=e):e=t[2];let r;t[3]!==n[0]||t[4]!==n.length?(r=n.length===1&&(0,Q.jsx)(xn,{src:n[0],className:`w-full h-full object-cover`,alt:`Post content`}),t[3]=n[0],t[4]=n.length,t[5]=r):r=t[5];let s;return t[6]!==a||t[7]!==e||t[8]!==r?(s=(0,Q.jsx)(`div`,{className:e,onDoubleClick:a,children:r}),t[6]=a,t[7]=e,t[8]=r,t[9]=s):s=t[9],s}let d;t[10]===n.length?d=t[11]:(d=e=>{u(e),c(t=>{let r=t+e;return r<0&&(r=0),r>=n.length&&(r=n.length-1),r})},t[10]=n.length,t[11]=d);let f=d,p;t[12]!==s||t[13]!==n.length||t[14]!==f?(p=(e,t)=>{t.offset.x<-50&&s<n.length-1?f(1):t.offset.x>50&&s>0&&f(-1)},t[12]=s,t[13]=n.length,t[14]=f,t[15]=p):p=t[15];let m=p,h;t[16]===Symbol.for(`react.memo_cache_sentinel`)?(h={enter:wn,center:{zIndex:1,x:0,opacity:1},exit:Tn},t[16]=h):h=t[16];let g=h,_;t[17]!==o||t[18]!==i?(_=Z(`w-full relative overflow-hidden group touch-pan-y`,o,i),t[17]=o,t[18]=i,t[19]=_):_=t[19];let v;t[20]===Symbol.for(`react.memo_cache_sentinel`)?(v={x:{type:`spring`,stiffness:300,damping:30},opacity:{duration:.2}},t[20]=v):v=t[20];let y;t[21]===Symbol.for(`react.memo_cache_sentinel`)?(y={left:0,right:0},t[21]=y):y=t[21];let b=n[s],S=`Slide ${s+1}`,C;t[22]!==b||t[23]!==S?(C=(0,Q.jsx)(xn,{src:b,className:`w-full h-full object-cover pointer-events-none`,alt:S}),t[22]=b,t[23]=S,t[24]=C):C=t[24];let w;t[25]!==s||t[26]!==l||t[27]!==m||t[28]!==C?(w=(0,Q.jsx)(V.div,{custom:l,variants:g,initial:`enter`,animate:`center`,exit:`exit`,transition:v,drag:`x`,dragConstraints:y,dragElastic:1,onDragEnd:m,className:`absolute inset-0 w-full h-full`,children:C},s),t[25]=s,t[26]=l,t[27]=m,t[28]=C,t[29]=w):w=t[29];let T;t[30]!==l||t[31]!==w?(T=(0,Q.jsx)(z,{initial:!1,custom:l,mode:`popLayout`,children:w}),t[30]=l,t[31]=w,t[32]=T):T=t[32];let E;t[33]!==s||t[34]!==f?(E=s>0&&(0,Q.jsx)(`button`,{className:`absolute left-2 top-1/2 -translate-y-1/2 bg-black/50 text-white p-1.5 rounded-full opacity-0 group-hover:opacity-100 transition-opacity z-10 hover:bg-black/70 backdrop-blur-sm`,onClick:e=>{e.stopPropagation(),f(-1)},children:(0,Q.jsx)(j,{size:16})}),t[33]=s,t[34]=f,t[35]=E):E=t[35];let D;t[36]!==s||t[37]!==n.length||t[38]!==f?(D=s<n.length-1&&(0,Q.jsx)(`button`,{className:`absolute right-2 top-1/2 -translate-y-1/2 bg-black/50 text-white p-1.5 rounded-full opacity-0 group-hover:opacity-100 transition-opacity z-10 hover:bg-black/70 backdrop-blur-sm`,onClick:e=>{e.stopPropagation(),f(1)},children:(0,Q.jsx)(x,{size:16})}),t[36]=s,t[37]=n.length,t[38]=f,t[39]=D):D=t[39];let O;if(t[40]!==s||t[41]!==n){let e;t[43]===s?e=t[44]:(e=(e,t)=>(0,Q.jsx)(`div`,{className:Z(`w-1.5 h-1.5 rounded-full transition-all shadow-sm`,t===s?`bg-white scale-125`:`bg-white/40`)},t),t[43]=s,t[44]=e),O=n.map(e),t[40]=s,t[41]=n,t[42]=O}else O=t[42];let k;t[45]===O?k=t[46]:(k=(0,Q.jsx)(`div`,{className:`absolute bottom-4 left-0 right-0 flex justify-center gap-1.5 z-10 pointer-events-none`,children:O}),t[45]=O,t[46]=k);let A=s+1,M;t[47]!==n.length||t[48]!==A?(M=(0,Q.jsxs)(`div`,{className:`absolute top-4 right-4 bg-black/60 text-white text-xs px-2 py-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none z-10 backdrop-blur-sm`,children:[A,`/`,n.length]}),t[47]=n.length,t[48]=A,t[49]=M):M=t[49];let N;return t[50]!==a||t[51]!==T||t[52]!==E||t[53]!==D||t[54]!==k||t[55]!==M||t[56]!==_?(N=(0,Q.jsxs)(`div`,{className:_,onDoubleClick:a,children:[T,E,D,k,M]}),t[50]=a,t[51]=T,t[52]=E,t[53]=D,t[54]=k,t[55]=M,t[56]=_,t[57]=N):N=t[57],N};function wn(e){return{x:e>0?`100%`:`-100%`,opacity:1}}function Tn(e){return{zIndex:0,x:e<0?`100%`:`-100%`,opacity:1}}var En=H(),Dn=()=>{let e=(0,En.c)(60),{isCreateModalOpen:t,setCreateModalOpen:n,showToast:r}=rt(),{user:i,profile:a}=at(),o;e[0]===Symbol.for(`react.memo_cache_sentinel`)?(o=[],e[0]=o):o=e[0];let[s,c]=(0,X.useState)(o),l;e[1]===Symbol.for(`react.memo_cache_sentinel`)?(l=[],e[1]=l):l=e[1];let[u,d]=(0,X.useState)(l),[f,p]=(0,X.useState)(``),[m,h]=(0,X.useState)(!1),[g,_]=(0,X.useState)(null),{mutate:v,isPending:b}=Ht(),{mutate:S,isPending:C}=Qt(),{mutate:w,isPending:T}=on(),E=b||C||T,D;e[2]===Symbol.for(`react.memo_cache_sentinel`)?(D=e=>{if(e&&e.length>0){c(e);let t=e[0].type.startsWith(`video/`);h(t),d(e.map(On)),_(t?`reel`:`post`)}},e[2]=D):D=e[2];let O=D,k,A;e[3]!==f||e[4]!==v||e[5]!==S||e[6]!==w||e[7]!==g||e[8]!==s||e[9]!==a||e[10]!==n||e[11]!==r||e[12]!==i?(k=async()=>{s.length===0||!i||!a||(g===`reel`?S({file:s[0],caption:f,userId:i.id,username:a.username},{onSuccess:()=>{r(`Reel shared`),n(!1),A()},onError:()=>r(`Failed to share reel`)}):g===`story`?w({file:s[0],userId:i.id},{onSuccess:()=>{r(`Story shared`),n(!1),A()},onError:()=>r(`Failed to share story`)}):v({files:s,caption:f,userId:i.id,username:a.username},{onSuccess:()=>{r(`Post shared`),n(!1),A()},onError:()=>r(`Failed to share post`)}))},A=()=>{c([]),d([]),p(``),h(!1),_(null)},e[3]=f,e[4]=v,e[5]=S,e[6]=w,e[7]=g,e[8]=s,e[9]=a,e[10]=n,e[11]=r,e[12]=i,e[13]=k,e[14]=A):(k=e[13],A=e[14]);let j;e[15]!==E||e[16]!==A||e[17]!==n?(j=e=>{e||(n(!1),E||A())},e[15]=E,e[16]=A,e[17]=n,e[18]=j):j=e[18];let M=j,N;e[19]===u.length?N=e[20]:(N=u.length>0&&(0,Q.jsx)(dt,{variant:`ghost`,size:`icon`,className:`-ml-2`,onClick:()=>{d([]),c([]),_(null)},children:(0,Q.jsx)(Se,{className:`h-6 w-6`})}),e[19]=u.length,e[20]=N);let F;e[21]===N?F=e[22]:(F=(0,Q.jsx)(`div`,{className:`w-20 flex justify-start`,children:N}),e[21]=N,e[22]=F);let I=u.length>0?g===`reel`?`New Reel`:g===`story`?`New Story`:`New Post`:`Create New Post`,L;e[23]===I?L=e[24]:(L=(0,Q.jsx)(gn,{className:`font-semibold text-lg text-center flex-grow`,children:I}),e[23]=I,e[24]=L);let R;e[25]!==k||e[26]!==E||e[27]!==u.length?(R=u.length>0&&(0,Q.jsx)(dt,{variant:`ghost`,onClick:k,disabled:E,className:`text-blue-500 hover:text-blue-600 hover:bg-blue-500/10 font-semibold px-2`,children:E?(0,Q.jsx)(P,{className:`h-5 w-5 animate-spin`}):`Share`}),e[25]=k,e[26]=E,e[27]=u.length,e[28]=R):R=e[28];let z;e[29]===R?z=e[30]:(z=(0,Q.jsx)(`div`,{className:`w-20 flex justify-end`,children:R}),e[29]=R,e[30]=z);let B;e[31]!==F||e[32]!==L||e[33]!==z?(B=(0,Q.jsxs)(hn,{className:`px-4 h-14 border-b flex flex-row items-center justify-between shrink-0 space-y-0`,children:[F,L,z]}),e[31]=F,e[32]=L,e[33]=z,e[34]=B):B=e[34];let V=u.length>0?`md:border-r border-border`:``,H;e[35]===V?H=e[36]:(H=Z(`flex-1 bg-black relative flex items-center justify-center overflow-hidden`,V),e[35]=V,e[36]=H);let U;e[37]!==m||e[38]!==u?(U=u.length>0?(0,Q.jsx)(`div`,{className:`relative w-full h-full flex items-center justify-center bg-[#1a1a1a]`,children:m?(0,Q.jsx)(`video`,{src:u[0],controls:!0,className:`max-h-full max-w-full object-contain`}):(0,Q.jsx)(Cn,{images:u,className:`w-full h-full bg-black`,aspectRatio:`max-h-full max-w-full`})}):(0,Q.jsx)(`div`,{className:`w-full h-full p-8 flex flex-col items-center justify-center bg-background`,children:(0,Q.jsx)(_n,{onFileSelect:O,multiple:!0})}),e[37]=m,e[38]=u,e[39]=U):U=e[39];let W;e[40]!==H||e[41]!==U?(W=(0,Q.jsx)(`div`,{className:H,children:U}),e[40]=H,e[41]=U,e[42]=W):W=e[42];let ee;e[43]!==f||e[44]!==g||e[45]!==m||e[46]!==u.length||e[47]!==a?.avatar_url||e[48]!==a?.username?(ee=u.length>0&&(0,Q.jsxs)(`div`,{className:`w-full md:w-[400px] flex flex-col bg-background`,children:[(0,Q.jsxs)(`div`,{className:`p-4 flex items-center gap-3`,children:[(0,Q.jsxs)(ot,{className:`w-10 h-10 border border-border`,children:[(0,Q.jsx)(st,{src:a?.avatar_url||``}),(0,Q.jsx)(ct,{children:a?.username?.[0]?.toUpperCase()})]}),(0,Q.jsx)(`span`,{className:`font-semibold text-sm`,children:a?.username})]}),g===`story`?(0,Q.jsx)(`div`,{className:`flex-grow flex items-center justify-center p-8 text-center text-muted-foreground`,children:(0,Q.jsx)(`p`,{className:`text-sm`,children:`Stories are visible for 24 hours. Captions are not supported on stories yet.`})}):(0,Q.jsxs)(`div`,{className:`flex-grow flex flex-col overflow-y-auto`,children:[(0,Q.jsx)(`div`,{className:`px-4 pb-4`,children:(0,Q.jsx)(ln,{className:`w-full min-h-[120px] bg-transparent border-none focus-visible:ring-0 resize-none text-base p-1 placeholder:text-muted-foreground/50`,placeholder:`Write a caption...`,value:f,onChange:e=>p(e.target.value)})}),(0,Q.jsx)(`div`,{className:`h-px w-full bg-border`}),(0,Q.jsxs)(`div`,{className:`flex flex-col`,children:[(0,Q.jsxs)(`div`,{className:`px-4 py-3 flex items-center justify-between cursor-pointer hover:bg-accent/50 transition-colors border-b border-border/50`,children:[(0,Q.jsxs)(`div`,{className:`flex items-center gap-3 text-sm`,children:[(0,Q.jsx)(y,{size:20,className:`text-muted-foreground`}),(0,Q.jsx)(`span`,{children:`Tag People`})]}),(0,Q.jsx)(x,{size:16,className:`text-muted-foreground`})]}),(0,Q.jsxs)(`div`,{className:`px-4 py-3 flex items-center justify-between cursor-pointer hover:bg-accent/50 transition-colors border-b border-border/50`,children:[(0,Q.jsxs)(`div`,{className:`flex items-center gap-3 text-sm`,children:[(0,Q.jsx)(de,{size:20,className:`text-muted-foreground`}),(0,Q.jsx)(`span`,{children:`Add Topics`})]}),(0,Q.jsx)(x,{size:16,className:`text-muted-foreground`})]})]})]}),(0,Q.jsx)(`div`,{className:`p-4 border-t border-border`,children:(0,Q.jsxs)(`div`,{className:`grid grid-cols-2 gap-2 bg-muted/50 p-1 rounded-lg`,children:[!m&&(0,Q.jsx)(`button`,{onClick:()=>_(`post`),className:Z(`text-sm font-semibold py-2 rounded-md transition-all`,g===`post`?`bg-background text-foreground shadow-sm`:`text-muted-foreground hover:text-foreground`),children:`Post`}),(0,Q.jsx)(`button`,{onClick:()=>_(m?`reel`:`story`),className:Z(`text-sm font-semibold py-2 rounded-md transition-all`,g===(m?`reel`:`story`)?`bg-background text-foreground shadow-sm`:`text-muted-foreground hover:text-foreground`),children:m?`Reel`:`Story`})]})})]}),e[43]=f,e[44]=g,e[45]=m,e[46]=u.length,e[47]=a?.avatar_url,e[48]=a?.username,e[49]=ee):ee=e[49];let G;e[50]!==W||e[51]!==ee?(G=(0,Q.jsxs)(`div`,{className:`flex-grow flex flex-col md:flex-row overflow-hidden`,children:[W,ee]}),e[50]=W,e[51]=ee,e[52]=G):G=e[52];let te;e[53]!==B||e[54]!==G?(te=(0,Q.jsxs)(mn,{className:`max-w-5xl h-[85vh] p-0 overflow-hidden flex flex-col gap-0 border-none sm:rounded-2xl`,children:[B,G]}),e[53]=B,e[54]=G,e[55]=te):te=e[55];let K;return e[56]!==M||e[57]!==t||e[58]!==te?(K=(0,Q.jsx)(dn,{open:t,onOpenChange:M,children:te}),e[56]=M,e[57]=t,e[58]=te,e[59]=K):K=e[59],K};function On(e){return URL.createObjectURL(e)}var kn=H();const An=()=>{let e=(0,kn.c)(10),t=Y(),{showToast:n,setCurrentUser:r,currentUser:i}=rt(),a;e[0]!==i||e[1]!==t||e[2]!==r||e[3]!==n?(a=e=>{n(`Profile updated`),r({...i,name:e?.full_name||``,bio:e?.bio||``,avatar:e?.avatar_url||``}),t.invalidateQueries({queryKey:[`profile`]}),e?.username&&t.invalidateQueries({queryKey:[`profile`,e.username]})},e[0]=i,e[1]=t,e[2]=r,e[3]=n,e[4]=a):a=e[4];let o;e[5]===n?o=e[6]:(o=e=>{console.error(`Update profile error:`,e),n(`Failed to update profile`)},e[5]=n,e[6]=o);let s;return e[7]!==a||e[8]!==o?(s={mutationFn:jn,onSuccess:a,onError:o},e[7]=a,e[8]=o,e[9]=s):s=e[9],Te(s)};async function jn(e){let{userId:t,name:n,bio:r,avatar:i}=e,{data:a,error:o}=await $.from(`profiles`).update({full_name:n,bio:r,avatar_url:i}).eq(`id`,t).select().single();if(o)throw o;return a}var Mn=H();function Nn(e){let t=(0,Mn.c)(10),n,r,i;t[0]===e?(n=t[1],r=t[2],i=t[3]):({className:n,type:i,...r}=e,t[0]=e,t[1]=n,t[2]=r,t[3]=i);let a;t[4]===n?a=t[5]:(a=Z(`file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm`,`focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]`,`aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive`,n),t[4]=n,t[5]=a);let o;return t[6]!==r||t[7]!==a||t[8]!==i?(o=(0,Q.jsx)(`input`,{type:i,"data-slot":`input`,className:a,...r}),t[6]=r,t[7]=a,t[8]=i,t[9]=o):o=t[9],o}var Pn=H();function Fn(e){let t=(0,Pn.c)(8),n,r;t[0]===e?(n=t[1],r=t[2]):({className:n,...r}=e,t[0]=e,t[1]=n,t[2]=r);let i;t[3]===n?i=t[4]:(i=Z(`flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50`,n),t[3]=n,t[4]=i);let a;return t[5]!==r||t[6]!==i?(a=(0,Q.jsx)(fe,{"data-slot":`label`,className:i,...r}),t[5]=r,t[6]=i,t[7]=a):a=t[7],a}var In=H(),Ln=ue,Rn=X.createContext({}),zn=e=>{let t=(0,In.c)(9),r;t[0]===e?r=t[1]:({...r}=e,t[0]=e,t[1]=r);let i;t[2]===r.name?i=t[3]:(i={name:r.name},t[2]=r.name,t[3]=i);let a;t[4]===r?a=t[5]:(a=(0,Q.jsx)(n,{...r}),t[4]=r,t[5]=a);let o;return t[6]!==i||t[7]!==a?(o=(0,Q.jsx)(Rn.Provider,{value:i,children:a}),t[6]=i,t[7]=a,t[8]=o):o=t[8],o},Bn=()=>{let e=(0,In.c)(13),t=X.useContext(Rn),n=X.useContext(Vn),{getFieldState:r}=C(),i;e[0]===t.name?i=e[1]:(i={name:t.name},e[0]=t.name,e[1]=i);let a=D(i),o;e[2]!==t.name||e[3]!==a||e[4]!==r?(o=r(t.name,a),e[2]=t.name,e[3]=a,e[4]=r,e[5]=o):o=e[5];let s=o;if(!t)throw Error(`useFormField should be used within <FormField>`);let{id:c}=n,l=`${c}-form-item`,u=`${c}-form-item-description`,d=`${c}-form-item-message`,f;return e[6]!==t.name||e[7]!==s||e[8]!==c||e[9]!==l||e[10]!==u||e[11]!==d?(f={id:c,name:t.name,formItemId:l,formDescriptionId:u,formMessageId:d,...s},e[6]=t.name,e[7]=s,e[8]=c,e[9]=l,e[10]=u,e[11]=d,e[12]=f):f=e[12],f},Vn=X.createContext({});function Hn(e){let t=(0,In.c)(13),n,r;t[0]===e?(n=t[1],r=t[2]):({className:n,...r}=e,t[0]=e,t[1]=n,t[2]=r);let i=X.useId(),a;t[3]===i?a=t[4]:(a={id:i},t[3]=i,t[4]=a);let o;t[5]===n?o=t[6]:(o=Z(`grid gap-2`,n),t[5]=n,t[6]=o);let s;t[7]!==r||t[8]!==o?(s=(0,Q.jsx)(`div`,{"data-slot":`form-item`,className:o,...r}),t[7]=r,t[8]=o,t[9]=s):s=t[9];let c;return t[10]!==a||t[11]!==s?(c=(0,Q.jsx)(Vn.Provider,{value:a,children:s}),t[10]=a,t[11]=s,t[12]=c):c=t[12],c}function Un(e){let t=(0,In.c)(10),n,r;t[0]===e?(n=t[1],r=t[2]):({className:n,...r}=e,t[0]=e,t[1]=n,t[2]=r);let{error:i,formItemId:a}=Bn(),o=!!i,s;t[3]===n?s=t[4]:(s=Z(`data-[error=true]:text-destructive`,n),t[3]=n,t[4]=s);let c;return t[5]!==a||t[6]!==r||t[7]!==o||t[8]!==s?(c=(0,Q.jsx)(Fn,{"data-slot":`form-label`,"data-error":o,className:s,htmlFor:a,...r}),t[5]=a,t[6]=r,t[7]=o,t[8]=s,t[9]=c):c=t[9],c}function Wn(e){let t=(0,In.c)(7),n;t[0]===e?n=t[1]:({...n}=e,t[0]=e,t[1]=n);let{error:r,formItemId:i,formDescriptionId:a,formMessageId:o}=Bn(),s=r?`${a} ${o}`:`${a}`,c=!!r,l;return t[2]!==i||t[3]!==n||t[4]!==s||t[5]!==c?(l=(0,Q.jsx)(p,{"data-slot":`form-control`,id:i,"aria-describedby":s,"aria-invalid":c,...n}),t[2]=i,t[3]=n,t[4]=s,t[5]=c,t[6]=l):l=t[6],l}function Gn(e){let t=(0,In.c)(10),n,r;t[0]===e?(n=t[1],r=t[2]):({className:n,...r}=e,t[0]=e,t[1]=n,t[2]=r);let{error:i,formMessageId:a}=Bn(),o=i?String(i?.message??``):r.children;if(!o)return null;let s;t[3]===n?s=t[4]:(s=Z(`text-destructive text-sm`,n),t[3]=n,t[4]=s);let c;return t[5]!==o||t[6]!==a||t[7]!==r||t[8]!==s?(c=(0,Q.jsx)(`p`,{"data-slot":`form-message`,id:a,className:s,...r,children:o}),t[5]=o,t[6]=a,t[7]=r,t[8]=s,t[9]=c):c=t[9],c}var Kn=H(),qn=We({name:ze().min(2,`Name must be at least 2 characters`).max(50),bio:ze().max(160,`Bio must be less than 160 characters`).optional()}),Jn=()=>{let e=(0,Kn.c)(56),{currentUser:t,isEditProfileOpen:n,setEditProfileOpen:r}=rt(),{user:i}=at(),{mutate:a,isPending:o}=An(),[s,c]=(0,X.useState)(t.avatar),l;e[0]===Symbol.for(`react.memo_cache_sentinel`)?(l=T(qn),e[0]=l):l=e[0];let u=t.bio||``,d;e[1]!==t.name||e[2]!==u?(d={resolver:l,defaultValues:{name:t.name,bio:u}},e[1]=t.name,e[2]=u,e[3]=d):d=e[3];let f=S(d),p;e[4]===Symbol.for(`react.memo_cache_sentinel`)?(p=e=>{if(e.target.files&&e.target.files[0]){let t=new FileReader;t.onload=e=>c(e.target?.result),t.readAsDataURL(e.target.files[0])}},e[4]=p):p=e[4];let m=p,h;e[5]===r?h=e[6]:(h=()=>r(!1),e[5]=r,e[6]=h);let g=h,_;e[7]!==s||e[8]!==g||e[9]!==a||e[10]!==i?(_=e=>{i&&a({userId:i.id,name:e.name,bio:e.bio||``,avatar:s},{onSuccess:()=>{g()}})},e[7]=s,e[8]=g,e[9]=a,e[10]=i,e[11]=_):_=e[11];let v=_,y;e[12]===Symbol.for(`react.memo_cache_sentinel`)?(y=(0,Q.jsx)(hn,{className:`p-4 border-b`,children:(0,Q.jsx)(gn,{className:`text-center font-bold`,children:`Edit Profile`})}),e[12]=y):y=e[12];let b;e[13]===s?b=e[14]:(b=(0,Q.jsx)(st,{src:s}),e[13]=s,e[14]=b);let x;e[15]===t.username?.[0]?x=e[16]:(x=t.username?.[0]?.toUpperCase()||`?`,e[15]=t.username?.[0],e[16]=x);let C;e[17]===x?C=e[18]:(C=(0,Q.jsx)(ct,{children:x}),e[17]=x,e[18]=C);let w;e[19]!==b||e[20]!==C?(w=(0,Q.jsxs)(ot,{className:`w-16 h-16`,children:[b,C]}),e[19]=b,e[20]=C,e[21]=w):w=e[21];let E;e[22]===t.username?E=e[23]:(E=(0,Q.jsx)(`div`,{className:`font-semibold text-lg`,children:t.username}),e[22]=t.username,e[23]=E);let D;e[24]===Symbol.for(`react.memo_cache_sentinel`)?(D=(0,Q.jsxs)(`label`,{className:`text-primary text-sm font-bold cursor-pointer hover:underline`,children:[`Change profile photo`,(0,Q.jsx)(`input`,{type:`file`,className:`hidden`,accept:`image/*`,onChange:m})]}),e[24]=D):D=e[24];let O;e[25]===E?O=e[26]:(O=(0,Q.jsxs)(`div`,{children:[E,D]}),e[25]=E,e[26]=O);let k;e[27]!==w||e[28]!==O?(k=(0,Q.jsxs)(`div`,{className:`flex items-center gap-4 p-4 rounded-lg bg-muted`,children:[w,O]}),e[27]=w,e[28]=O,e[29]=k):k=e[29];let A;e[30]!==f||e[31]!==v?(A=f.handleSubmit(v),e[30]=f,e[31]=v,e[32]=A):A=e[32];let j,M;e[33]===f.control?(j=e[34],M=e[35]):(j=(0,Q.jsx)(zn,{control:f.control,name:`name`,render:Yn}),M=(0,Q.jsx)(zn,{control:f.control,name:`bio`,render:Xn}),e[33]=f.control,e[34]=j,e[35]=M);let N;e[36]===o?N=e[37]:(N=o?(0,Q.jsx)(P,{className:`mr-2 h-4 w-4 animate-spin`}):`Save`,e[36]=o,e[37]=N);let F;e[38]!==o||e[39]!==N?(F=(0,Q.jsx)(dt,{type:`submit`,disabled:o,className:`w-full bg-[#006a4e] hover:bg-[#00523c] text-white font-bold`,children:N}),e[38]=o,e[39]=N,e[40]=F):F=e[40];let I;e[41]!==A||e[42]!==j||e[43]!==M||e[44]!==F?(I=(0,Q.jsxs)(`form`,{onSubmit:A,className:`space-y-4`,children:[j,M,F]}),e[41]=A,e[42]=j,e[43]=M,e[44]=F,e[45]=I):I=e[45];let L;e[46]!==f||e[47]!==I?(L=(0,Q.jsx)(Ln,{...f,children:I}),e[46]=f,e[47]=I,e[48]=L):L=e[48];let R;e[49]!==k||e[50]!==L?(R=(0,Q.jsxs)(mn,{className:`max-w-md p-0 overflow-hidden border-none sm:rounded-xl`,children:[y,(0,Q.jsxs)(`div`,{className:`p-6 flex flex-col gap-4 bg-background text-foreground`,children:[k,L]})]}),e[49]=k,e[50]=L,e[51]=R):R=e[51];let z;return e[52]!==n||e[53]!==r||e[54]!==R?(z=(0,Q.jsx)(dn,{open:n,onOpenChange:r,children:R}),e[52]=n,e[53]=r,e[54]=R,e[55]=z):z=e[55],z};function Yn(e){let{field:t}=e;return(0,Q.jsxs)(Hn,{children:[(0,Q.jsx)(Un,{children:`Name`}),(0,Q.jsx)(Wn,{children:(0,Q.jsx)(Nn,{...t,className:`bg-transparent`})}),(0,Q.jsx)(Gn,{})]})}function Xn(e){let{field:t}=e;return(0,Q.jsxs)(Hn,{children:[(0,Q.jsx)(Un,{children:`Bio`}),(0,Q.jsx)(Wn,{children:(0,Q.jsx)(ln,{...t,className:`bg-transparent h-24 resize-none`})}),(0,Q.jsx)(Gn,{})]})}var Zn=H(),Qn=e=>{let t=(0,Zn.c)(3),{className:n}=e,r=`inline-block ml-1 ${n}`,i;t[0]===Symbol.for(`react.memo_cache_sentinel`)?(i=(0,Q.jsxs)(`g`,{transform:`translate(1.4065934065934016 1.4065934065934016) scale(2.81 2.81)`,children:[(0,Q.jsx)(`path`,{d:`M 30.091 10.131 L 30.091 10.131 c 5.28 -13.046 23.695 -13.207 29.202 -0.255 l 0 0 l 0 0 c 12.959 -5.491 26.093 7.416 20.829 20.469 l 0 0 l 0 0 c 13.046 5.28 13.207 23.695 0.255 29.202 l 0 0 l 0 0 c 5.491 12.959 -7.416 26.093 -20.469 20.829 l 0 0 l 0 0 c -5.28 13.046 -23.695 13.207 -29.202 0.255 l 0 0 l 0 0 C 17.748 86.122 4.613 73.215 9.878 60.162 l 0 0 l 0 0 C -3.169 54.881 -3.33 36.467 9.623 30.96 l 0 0 l 0 0 C 4.131 18.001 17.038 4.866 30.091 10.131 L 30.091 10.131 z`,fill:`#0096F1`}),(0,Q.jsx)(`polygon`,{points:`39.66,63.79 23.36,47.76 28.97,42.05 39.3,52.21 59.6,29.58 65.56,34.93`,fill:`#FFFFFF`})]}),t[0]=i):i=t[0];let a;return t[1]===r?a=t[2]:(a=(0,Q.jsx)(`svg`,{width:`16`,height:`16`,viewBox:`0 0 256 256`,xmlns:`http://www.w3.org/2000/svg`,className:r,children:i}),t[1]=r,t[2]=a),a},$n=H(),er=e(Be(),1),tr=e(He(),1);Fe(),er.default.extend(tr.default),er.default.locale(`en`);var nr=()=>{let e=(0,$n.c)(108),{viewingStory:t,setViewingStory:n,showToast:i}=rt(),{user:a}=at(),o=re(),{data:s}=nn(a?.id),c;e[0]===s?c=e[1]:(c=s===void 0?[]:s,e[0]=s,e[1]=c);let l=c,u;e[2]===t?u=e[3]:(u=e=>e.id===t,e[2]=t,e[3]=u);let d=l.findIndex(u),[f,p]=(0,X.useState)(-1),[m,h]=(0,X.useState)(0);d!==-1&&f===-1&&p(d);let g;e[4]!==f||e[5]!==n||e[6]!==l.length?(g=()=>{f<l.length-1?(p(rr),h(0)):n(null)},e[4]=f,e[5]=n,e[6]=l.length,e[7]=g):g=e[7];let _=g,v;e[8]===f?v=e[9]:(v=()=>{f>0&&(p(ir),h(0))},e[8]=f,e[9]=v);let y=v,b,S;if(e[10]!==f||e[11]!==_||e[12]!==t?(b=()=>{if(t===null||f===-1)return;let e=setInterval(()=>{h(e=>e>=100?(_(),0):e+1)},50);return()=>clearInterval(e)},S=[f,t,_],e[10]=f,e[11]=_,e[12]=t,e[13]=b,e[14]=S):(b=e[13],S=e[14]),(0,X.useEffect)(b,S),t===null||f===-1||l.length===0)return null;let C=l[f];if(!C)return null;let w;e[15]===n?w=e[16]:(w=()=>n(null),e[15]=n,e[16]=w);let T=w,E,D,O;e[17]===Symbol.for(`react.memo_cache_sentinel`)?(D={opacity:0,scale:.9},O={opacity:1,scale:1},E={opacity:0,scale:.9},e[17]=E,e[18]=D,e[19]=O):(E=e[17],D=e[18],O=e[19]);let k;e[20]===Symbol.for(`react.memo_cache_sentinel`)?(k=(0,Q.jsx)(B,{size:32}),e[20]=k):k=e[20];let A;e[21]===T?A=e[22]:(A=(0,Q.jsx)(dt,{variant:`ghost`,size:`icon`,className:`absolute top-4 right-4 z-50 text-white hover:bg-white/10 hover:text-white`,onClick:T,children:k}),e[21]=T,e[22]=A);let M;if(e[23]!==f||e[24]!==m||e[25]!==l){let t;e[27]!==f||e[28]!==m?(t=(e,t)=>(0,Q.jsx)(`div`,{className:`h-1 bg-white/30 flex-1 rounded-full overflow-hidden`,children:(0,Q.jsx)(V.div,{className:`h-full bg-white origin-left`,initial:{scaleX:0},animate:{scaleX:t<f?1:t===f?m/100:0},transition:{type:`tween`,ease:`linear`}})},t),e[27]=f,e[28]=m,e[29]=t):t=e[29],M=l.map(t),e[23]=f,e[24]=m,e[25]=l,e[26]=M}else M=e[26];let N;e[30]===M?N=e[31]:(N=(0,Q.jsx)(`div`,{className:`absolute top-4 left-0 right-0 flex gap-1 px-2 z-20`,children:M}),e[30]=M,e[31]=N);let P;e[32]!==C.username||e[33]!==o||e[34]!==n?(P=e=>{e.stopPropagation(),n(null),o(`/profile/${C.username}`)},e[32]=C.username,e[33]=o,e[34]=n,e[35]=P):P=e[35];let F=C.userAvatar||C.img,I;e[36]===F?I=e[37]:(I=(0,Q.jsx)(st,{src:F}),e[36]=F,e[37]=I);let L;e[38]===C.username?.[0]?L=e[39]:(L=C.username?.[0]?.toUpperCase()||`?`,e[38]=C.username?.[0],e[39]=L);let R;e[40]===L?R=e[41]:(R=(0,Q.jsx)(ct,{children:L}),e[40]=L,e[41]=R);let H;e[42]!==P||e[43]!==I||e[44]!==R?(H=(0,Q.jsxs)(ot,{className:`w-8 h-8 border border-white cursor-pointer`,onClick:P,children:[I,R]}),e[42]=P,e[43]=I,e[44]=R,e[45]=H):H=e[45];let U;e[46]!==C.username||e[47]!==o||e[48]!==n?(U=e=>{e.stopPropagation(),n(null),o(`/profile/${C.username}`)},e[46]=C.username,e[47]=o,e[48]=n,e[49]=U):U=e[49];let W;e[50]!==C.username||e[51]!==U?(W=(0,Q.jsx)(`span`,{className:`font-semibold text-sm cursor-pointer hover:underline`,onClick:U,children:C.username}),e[50]=C.username,e[51]=U,e[52]=W):W=e[52];let ee;e[53]===C.isVerified?ee=e[54]:(ee=C.isVerified&&(0,Q.jsx)(Qn,{}),e[53]=C.isVerified,e[54]=ee);let G;e[55]!==W||e[56]!==ee?(G=(0,Q.jsxs)(`div`,{className:`flex items-center`,children:[W,ee]}),e[55]=W,e[56]=ee,e[57]=G):G=e[57];let te;e[58]===C.createdAt?te=e[59]:(te=C.createdAt?(0,er.default)(C.createdAt).fromNow(!0):``,e[58]=C.createdAt,e[59]=te);let K;e[60]===te?K=e[61]:(K=(0,Q.jsx)(`span`,{className:`text-white/70 text-xs`,children:te}),e[60]=te,e[61]=K);let ne;e[62]!==H||e[63]!==G||e[64]!==K?(ne=(0,Q.jsxs)(`div`,{className:`absolute top-8 left-4 flex items-center gap-3 z-20 text-white`,children:[H,G,K]}),e[62]=H,e[63]=G,e[64]=K,e[65]=ne):ne=e[65];let ie,ae,oe;e[66]===Symbol.for(`react.memo_cache_sentinel`)?(ie={opacity:0,x:20},ae={opacity:1,x:0},oe={opacity:0,x:-20},e[66]=ie,e[67]=ae,e[68]=oe):(ie=e[66],ae=e[67],oe=e[68]);let se;e[69]===C.img?se=e[70]:(se=(0,Q.jsx)(`img`,{src:C.img,className:`w-full h-full object-contain`,alt:`story`,loading:`lazy`}),e[69]=C.img,e[70]=se);let ce;e[71]!==C.id||e[72]!==se?(ce=(0,Q.jsx)(z,{mode:`wait`,children:(0,Q.jsx)(V.div,{initial:ie,animate:ae,exit:oe,className:`w-full h-full`,children:se},C.id)}),e[71]=C.id,e[72]=se,e[73]=ce):ce=e[73];let le;e[74]===y?le=e[75]:(le=(0,Q.jsx)(`div`,{className:`absolute inset-y-0 left-0 w-1/3 z-10`,onClick:y}),e[74]=y,e[75]=le);let ue;e[76]===_?ue=e[77]:(ue=(0,Q.jsx)(`div`,{className:`absolute inset-y-0 right-0 w-1/3 z-10`,onClick:_}),e[76]=_,e[77]=ue);let de;e[78]!==ce||e[79]!==le||e[80]!==ue?(de=(0,Q.jsxs)(`div`,{className:`flex-1 relative flex items-center justify-center bg-gray-900`,children:[ce,le,ue]}),e[78]=ce,e[79]=le,e[80]=ue,e[81]=de):de=e[81];let fe=`Reply to ${C.username}...`,pe;e[82]===fe?pe=e[83]:(pe=(0,Q.jsx)(`div`,{className:`flex-1 relative`,children:(0,Q.jsx)(Nn,{type:`text`,placeholder:fe,className:`w-full bg-transparent border-white/50 rounded-full py-6 px-4 text-white text-sm placeholder:text-white/70 focus-visible:ring-0 focus-visible:border-white`})}),e[82]=fe,e[83]=pe);let q;e[84]===i?q=e[85]:(q=(0,Q.jsx)(r,{size:28,className:`text-white cursor-pointer hover:scale-110 transition-transform`,onClick:()=>i(`Liked story`)}),e[84]=i,e[85]=q);let he;e[86]===Symbol.for(`react.memo_cache_sentinel`)?(he=(0,Q.jsx)(me,{size:28,className:`text-white cursor-pointer hover:scale-110 transition-transform`}),e[86]=he):he=e[86];let ge;e[87]!==pe||e[88]!==q?(ge=(0,Q.jsxs)(`div`,{className:`absolute bottom-0 w-full p-4 flex items-center gap-4 z-20 bg-gradient-to-t from-black/50 to-transparent`,children:[pe,q,he]}),e[87]=pe,e[88]=q,e[89]=ge):ge=e[89];let J;e[90]!==N||e[91]!==ne||e[92]!==de||e[93]!==ge?(J=(0,Q.jsxs)(`div`,{className:`relative w-full md:w-[400px] h-full md:h-[90vh] bg-black md:rounded-lg overflow-hidden flex flex-col`,children:[N,ne,de,ge]}),e[90]=N,e[91]=ne,e[92]=de,e[93]=ge,e[94]=J):J=e[94];let _e=f===0,ve;e[95]===Symbol.for(`react.memo_cache_sentinel`)?(ve=(0,Q.jsx)(j,{size:48}),e[95]=ve):ve=e[95];let ye;e[96]!==y||e[97]!==_e?(ye=(0,Q.jsx)(`button`,{className:`hidden md:block absolute left-4 text-white/50 hover:text-white`,onClick:y,disabled:_e,children:ve}),e[96]=y,e[97]=_e,e[98]=ye):ye=e[98];let be=f===l.length-1,xe;e[99]===Symbol.for(`react.memo_cache_sentinel`)?(xe=(0,Q.jsx)(x,{size:48}),e[99]=xe):xe=e[99];let Se;e[100]!==_||e[101]!==be?(Se=(0,Q.jsx)(`button`,{className:`hidden md:block absolute right-4 text-white/50 hover:text-white`,onClick:_,disabled:be,children:xe}),e[100]=_,e[101]=be,e[102]=Se):Se=e[102];let Y;return e[103]!==A||e[104]!==J||e[105]!==ye||e[106]!==Se?(Y=(0,Q.jsxs)(V.div,{initial:D,animate:O,exit:E,className:`fixed inset-0 z-[200] bg-black flex items-center justify-center`,children:[A,J,ye,Se]}),e[103]=A,e[104]=J,e[105]=ye,e[106]=Se,e[107]=Y):Y=e[107],Y};function rr(e){return e+1}function ir(e){return e-1}var ar=H();const or=()=>{let e=(0,ar.c)(2),t=Y(),n;return e[0]===t?n=e[1]:(n={mutationFn:sr,onMutate:async e=>{let{targetId:n,type:r,hasLiked:i}=e,a=r===`post`?jt:Gt;await t.cancelQueries({queryKey:a});let o=t.getQueryData(a);return t.setQueryData(a,e=>{if(!e)return e;if(r===`post`&&typeof e==`object`&&e&&`pages`in e){let t=e;return{...t,pages:t.pages.map(e=>e.map(e=>{if(e.id===n){let t=Number(e.likes);return{...e,hasLiked:!i,likes:i?Math.max(0,t-1):t+1}}return e}))}}return r===`reel`&&Array.isArray(e)?e.map(e=>{if(e.id===n){let t=Number(e.likes);return{...e,hasLiked:!i,likes:i?Math.max(0,t-1):t+1}}return e}):e}),{previousData:o,queryKey:a}},onError:(e,n,r)=>{r?.previousData&&t.setQueryData(r.queryKey,r.previousData),console.error(e)},onSettled:(e,n,r)=>{let{type:i}=r,a=i===`post`?jt:Gt;t.invalidateQueries({queryKey:a})}},e[0]=t,e[1]=n),Te(n)};async function sr(e){let{targetId:t,type:n,userId:r,hasLiked:i}=e,a=n===`post`?{user_id:r,post_id:t}:{user_id:r,reel_id:t};if(i){let{error:e}=await $.from(`likes`).delete().match(a);if(e)throw e}else{let{error:e}=await $.from(`likes`).insert(a);if(e)throw e}}var cr=H(),lr=e(Be(),1);const ur=()=>{let e=(0,cr.c)(11),t=Y(),{profile:n}=at(),r;e[0]!==n?.avatar_url||e[1]!==n?.username||e[2]!==t?(r=async e=>{let{targetId:r,type:i,text:a,userId:o,audioBlob:s,parentId:c}=e,l=[`comments`,i,r],u=i===`post`?jt:Gt;await t.cancelQueries({queryKey:l}),await t.cancelQueries({queryKey:u});let d=t.getQueryData(l),f=t.getQueryData(u),p={id:`temp-${(0,lr.default)().valueOf()}`,created_at:(0,lr.default)().toISOString(),text:a,user_id:o,post_id:i===`post`?r:void 0,reel_id:i===`reel`?r:void 0,audioUrl:s?URL.createObjectURL(s):void 0,parent_id:c,likes_count:0,hasLiked:!1,user:{username:n?.username||`You`,avatar_url:n?.avatar_url||``,isVerified:!1}};return t.setQueryData(l,e=>[p,...e===void 0?[]:e]),t.setQueryData(u,e=>{if(!e)return e;if(i===`post`&&e.pages){let t=e;return{...t,pages:t.pages.map(e=>e.map(e=>e.id===r?{...e,comments:Number(e.comments)+1}:e))}}return i===`reel`&&Array.isArray(e)?e.map(e=>e.id===r?{...e,comments:Number(e.comments)+1}:e):e}),{previousComments:d,previousFeed:f,commentsKey:l,feedKey:u}},e[0]=n?.avatar_url,e[1]=n?.username,e[2]=t,e[3]=r):r=e[3];let i,a;e[4]===t?(i=e[5],a=e[6]):(i=(e,n,r)=>{let i=r;i?.previousComments&&t.setQueryData(i.commentsKey,i.previousComments),i?.previousFeed&&t.setQueryData(i.feedKey,i.previousFeed)},a=(e,n)=>{let r=n.type===`post`?jt:Gt;t.invalidateQueries({queryKey:r}),t.invalidateQueries({queryKey:[`comments`,n.type,n.targetId]})},e[4]=t,e[5]=i,e[6]=a);let o;return e[7]!==r||e[8]!==i||e[9]!==a?(o={mutationFn:dr,onMutate:r,onError:i,onSuccess:a},e[7]=r,e[8]=i,e[9]=a,e[10]=o):o=e[10],Te(o)};async function dr(e){let{targetId:t,type:n,text:r,userId:i,audioBlob:a,parentId:o}=e,s=null;if(a){let e=`${i}/${Date.now()}.webm`,{error:t}=await $.storage.from(`audio-messages`).upload(e,a);if(t)throw t;let{data:n}=$.storage.from(`audio-messages`).getPublicUrl(e);s=n.publicUrl}let{data:c,error:l}=await $.from(`comments`).insert({user_id:i,post_id:n===`post`?t:null,reel_id:n===`reel`?t:null,text:r,audio_url:s,parent_id:o}).select(`
          *,
          user:profiles(username, avatar_url, is_verified)
        `).single();if(l)throw l;let u=c;return{id:u.id,created_at:u.created_at,text:u.text,user_id:u.user_id,post_id:u.post_id,reel_id:u.reel_id,parent_id:u.parent_id,likes_count:0,hasLiked:!1,audioUrl:u.audio_url,user:{username:u.user?.username,avatar_url:u.user?.avatar_url,isVerified:u.user?.is_verified}}}var fr=H();const pr=()=>{let e=(0,fr.c)(2),t=Y(),n;return e[0]===t?n=e[1]:(n={mutationFn:mr,onSuccess:()=>{t.invalidateQueries({queryKey:jt}),t.invalidateQueries({queryKey:[`savedPosts`]})}},e[0]=t,e[1]=n),Te(n)};async function mr(e){let{postId:t,userId:n,hasSaved:r}=e;if(r){let{error:e}=await $.from(`saves`).delete().match({user_id:n,post_id:t});if(e)throw e}else{let{error:e}=await $.from(`saves`).insert({user_id:n,post_id:t});if(e)throw e}}var hr=H();function gr(e){let t=(0,hr.c)(12),n,r,i,a;t[0]===e?(n=t[1],r=t[2],i=t[3],a=t[4]):({className:n,orientation:i,decorative:a,...r}=e,t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=a);let o=i===void 0?`horizontal`:i,s=a===void 0?!0:a,c;t[5]===n?c=t[6]:(c=Z(`bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px`,n),t[5]=n,t[6]=c);let l;return t[7]!==s||t[8]!==o||t[9]!==r||t[10]!==c?(l=(0,Q.jsx)(N,{"data-slot":`separator`,decorative:s,orientation:o,className:c,...r}),t[7]=s,t[8]=o,t[9]=r,t[10]=c,t[11]=l):l=t[11],l}var _r=H();function vr(e){let t=(0,_r.c)(14),n,r,i;t[0]===e?(n=t[1],r=t[2],i=t[3]):({className:r,children:n,...i}=e,t[0]=e,t[1]=n,t[2]=r,t[3]=i);let a;t[4]===r?a=t[5]:(a=Z(`relative`,r),t[4]=r,t[5]=a);let o;t[6]===n?o=t[7]:(o=(0,Q.jsx)(Ae,{"data-slot":`scroll-area-viewport`,className:`focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1`,children:n}),t[6]=n,t[7]=o);let s,c;t[8]===Symbol.for(`react.memo_cache_sentinel`)?(s=(0,Q.jsx)(yr,{}),c=(0,Q.jsx)(W,{}),t[8]=s,t[9]=c):(s=t[8],c=t[9]);let l;return t[10]!==i||t[11]!==a||t[12]!==o?(l=(0,Q.jsxs)(je,{"data-slot":`scroll-area`,className:a,...i,children:[o,s,c]}),t[10]=i,t[11]=a,t[12]=o,t[13]=l):l=t[13],l}function yr(e){let t=(0,_r.c)(13),n,r,i;t[0]===e?(n=t[1],r=t[2],i=t[3]):({className:n,orientation:i,...r}=e,t[0]=e,t[1]=n,t[2]=r,t[3]=i);let o=i===void 0?`vertical`:i,s=o===`vertical`&&`h-full w-2.5 border-l border-l-transparent`,c=o===`horizontal`&&`h-2.5 flex-col border-t border-t-transparent`,l;t[4]!==n||t[5]!==s||t[6]!==c?(l=Z(`flex touch-none p-px transition-colors select-none`,s,c,n),t[4]=n,t[5]=s,t[6]=c,t[7]=l):l=t[7];let u;t[8]===Symbol.for(`react.memo_cache_sentinel`)?(u=(0,Q.jsx)(a,{"data-slot":`scroll-area-thumb`,className:`bg-border relative flex-1 rounded-full`}),t[8]=u):u=t[8];let d;return t[9]!==o||t[10]!==r||t[11]!==l?(d=(0,Q.jsx)(M,{"data-slot":`scroll-area-scrollbar`,orientation:o,className:l,...r,children:u}),t[9]=o,t[10]=r,t[11]=l,t[12]=d):d=t[12],d}var br=H(),xr=e=>{let t=(0,br.c)(27),{onRecordingComplete:n,onCancel:r}=e,[i,a]=(0,X.useState)(!1),[o,s]=(0,X.useState)(0),[c,l]=(0,X.useState)(null),[u,d]=(0,X.useState)(!1),[f,p]=(0,X.useState)(0),m=(0,X.useRef)(null),h;t[0]===Symbol.for(`react.memo_cache_sentinel`)?(h=[],t[0]=h):h=t[0];let g=(0,X.useRef)(h),_=(0,X.useRef)(null),v=(0,X.useRef)(null),y;t[1]===Symbol.for(`react.memo_cache_sentinel`)?(y=()=>{_.current&&clearInterval(_.current),m.current&&m.current.stream.getTracks().forEach(Sr)},t[1]=y):y=t[1];let b=y,x;t[2]===r?x=t[3]:(x=async()=>{try{let e=await navigator.mediaDevices.getUserMedia({audio:!0}),t=new MediaRecorder(e);m.current=t,g.current=[],t.ondataavailable=e=>{e.data.size>0&&g.current.push(e.data)},t.onstop=()=>{l(new Blob(g.current,{type:`audio/webm`})),b()},t.start(),a(!0),_.current=setInterval(()=>{s(Cr)},1e3)}catch(e){let t=e;console.error(`Error accessing microphone:`,t),r()}},t[2]=r,t[3]=x);let S=x,C,w;t[4]===S?(C=t[5],w=t[6]):(C=()=>{let e=setTimeout(()=>{S()},0);return()=>{clearTimeout(e),b()}},w=[S,b],t[4]=S,t[5]=C,t[6]=w),(0,X.useEffect)(C,w);let T;t[7]===i?T=t[8]:(T=()=>{m.current&&i&&(m.current.stop(),a(!1))},t[7]=i,t[8]=T);let E=T,D=wr,O;t[9]!==c||t[10]!==u?(O=()=>{if(c){if(!v.current){let e=URL.createObjectURL(c);v.current=new Audio(e),v.current.onended=()=>d(!1),v.current.ontimeupdate=()=>{p(v.current?.currentTime||0)}}u?v.current.pause():v.current.play(),d(!u)}},t[9]=c,t[10]=u,t[11]=O):O=t[11];let k=O,A;t[12]!==c||t[13]!==n?(A=()=>{c&&n(c)},t[12]=c,t[13]=n,t[14]=A):A=t[14];let j=A,M,N,P;t[15]===Symbol.for(`react.memo_cache_sentinel`)?(P={opacity:0,y:10},M={opacity:1,y:0},N={opacity:0,y:10},t[15]=M,t[16]=N,t[17]=P):(M=t[15],N=t[16],P=t[17]);let F;return t[18]!==c||t[19]!==k||t[20]!==j||t[21]!==u||t[22]!==r||t[23]!==f||t[24]!==o||t[25]!==E?(F=(0,Q.jsx)(V.div,{initial:P,animate:M,exit:N,className:`flex items-center gap-2 w-full bg-zinc-100 dark:bg-zinc-800 p-2 rounded-full`,children:c?(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(dt,{size:`icon`,variant:`ghost`,className:`h-8 w-8 text-zinc-500 hover:text-red-500`,onClick:r,children:(0,Q.jsx)(Ee,{size:18})}),(0,Q.jsxs)(`div`,{className:`flex-1 flex items-center gap-2`,children:[(0,Q.jsx)(dt,{size:`icon`,variant:`ghost`,className:`h-8 w-8`,onClick:k,children:u?(0,Q.jsx)(be,{size:18}):(0,Q.jsx)(ie,{size:18})}),(0,Q.jsx)(`div`,{className:`h-1 flex-1 bg-zinc-300 dark:bg-zinc-700 rounded-full overflow-hidden`,children:(0,Q.jsx)(`div`,{className:`h-full bg-blue-500 transition-all duration-100`,style:{width:`${f/o*100}%`}})}),(0,Q.jsx)(`span`,{className:`text-xs font-mono text-zinc-500 w-10`,children:D(o)})]}),(0,Q.jsx)(dt,{size:`icon`,className:`h-8 w-8 bg-blue-500 hover:bg-blue-600 rounded-full`,onClick:j,children:(0,Q.jsx)(me,{size:16,className:`text-white`})})]}):(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsxs)(`div`,{className:`flex-1 flex items-center gap-2 px-3`,children:[(0,Q.jsx)(`div`,{className:`w-2 h-2 rounded-full bg-red-500 animate-pulse`}),(0,Q.jsx)(`span`,{className:`text-sm font-mono text-red-500`,children:D(o)}),(0,Q.jsx)(`span`,{className:`text-xs text-zinc-500`,children:`Recording...`})]}),(0,Q.jsx)(dt,{size:`icon`,variant:`ghost`,className:`h-8 w-8 text-red-500 hover:text-red-600 hover:bg-red-100 dark:hover:bg-red-900/20`,onClick:E,children:(0,Q.jsx)(Ce,{size:16,fill:`currentColor`})})]})}),t[18]=c,t[19]=k,t[20]=j,t[21]=u,t[22]=r,t[23]=f,t[24]=o,t[25]=E,t[26]=F):F=t[26],F};function Sr(e){return e.stop()}function Cr(e){return e+1}function wr(e){return`${Math.floor(e/60)}:${(e%60).toString().padStart(2,`0`)}`}var Tr=H();const Er=(e,t)=>{let n=(0,Tr.c)(12),{user:r}=at(),i=r?.id,a;n[0]!==i||n[1]!==e||n[2]!==t?(a=[`comments`,t,e,i],n[0]=i,n[1]=e,n[2]=t,n[3]=a):a=n[3];let o;n[4]!==e||n[5]!==t||n[6]!==r?(o=async()=>{let n=t===`post`?`post_id`:`reel_id`,{data:i,error:a}=await $.from(`comments`).select(`
          *,
          profiles:user_id (
            username,
            avatar_url,
            is_verified
          )
        `).eq(n,e).order(`created_at`,{ascending:!1});if(a)throw a;if(!i)return[];let o=i,s=new Set;if(r){let e=o.map(Dr);if(e.length>0){let{data:t}=await $.from(`comment_likes`).select(`comment_id`).eq(`user_id`,r.id).in(`comment_id`,e);t&&t.forEach(e=>s.add(e.comment_id))}}return o.map(e=>{let t=e.audio_url||void 0;return t&&t.includes(`/storage/v1/object/audio-messages/`)&&!t.includes(`/storage/v1/object/public/`)&&(t=t.replace(`/storage/v1/object/audio-messages/`,`/storage/v1/object/public/audio-messages/`)),{id:e.id,created_at:e.created_at,text:e.text,user_id:e.user_id,post_id:e.post_id||void 0,reel_id:e.reel_id||void 0,audioUrl:t,parent_id:e.parent_id,likes_count:e.likes_count||0,hasLiked:s.has(e.id),user:{username:e.profiles?.username||`Guest`,avatar_url:e.profiles?.avatar_url||`https://api.dicebear.com/9.x/avataaars/svg?seed=guest`,isVerified:e.profiles?.is_verified||!1}}})},n[4]=e,n[5]=t,n[6]=r,n[7]=o):o=n[7];let s=!!e,c;return n[8]!==a||n[9]!==o||n[10]!==s?(c={queryKey:a,queryFn:o,enabled:s},n[8]=a,n[9]=o,n[10]=s,n[11]=c):c=n[11],J(c)};function Dr(e){return e.id}var Or=H();const kr=()=>{let e=(0,Or.c)(12),t=Y(),{user:n}=at(),r;e[0]===n?r=e[1]:(r=async e=>{let{commentId:t,hasLiked:r}=e;if(!n)throw Error(`Not authenticated`);if(r){let{error:e}=await $.from(`comment_likes`).delete().match({user_id:n.id,comment_id:t});if(e)throw e}else{let{error:e}=await $.from(`comment_likes`).insert({user_id:n.id,comment_id:t});if(e)throw e}},e[0]=n,e[1]=r);let i,a,o;e[2]!==t||e[3]!==n?.id?(i=async e=>{let{commentId:r,hasLiked:i,targetId:a,type:o}=e;await t.cancelQueries({queryKey:[`comments`,o,a,n?.id]});let s=t.getQueryData([`comments`,o,a,n?.id]);return t.setQueryData([`comments`,o,a,n?.id],e=>e&&e.map(e=>e.id===r?{...e,hasLiked:!i,likes_count:i?e.likes_count-1:e.likes_count+1}:e)),{previousComments:s}},a=(e,r,i)=>{i?.previousComments&&t.setQueryData([`comments`,r.type,r.targetId,n?.id],i.previousComments)},o=(e,r,i)=>{t.invalidateQueries({queryKey:[`comments`,i.type,i.targetId,n?.id]})},e[2]=t,e[3]=n?.id,e[4]=i,e[5]=a,e[6]=o):(i=e[4],a=e[5],o=e[6]);let s;return e[7]!==r||e[8]!==i||e[9]!==a||e[10]!==o?(s={mutationFn:r,onMutate:i,onError:a,onSettled:o},e[7]=r,e[8]=i,e[9]=a,e[10]=o,e[11]=s):s=e[11],Te(s)};var Ar=H(),jr=e=>{let t=(0,Ar.c)(13),{src:n}=e,[r,i]=(0,X.useState)(!1),a=X.useRef(null),[o,s]=(0,X.useState)(0),c;t[0]!==r||t[1]!==n?(c=()=>{a.current||(a.current=new Audio(n),a.current.onended=()=>{i(!1),s(0)},a.current.ontimeupdate=()=>{a.current&&s(a.current.currentTime/a.current.duration*100||0)}),r?a.current.pause():a.current.play(),i(!r)},t[0]=r,t[1]=n,t[2]=c):c=t[2];let l=c,u;t[3]===r?u=t[4]:(u=r?(0,Q.jsx)(be,{size:14}):(0,Q.jsx)(ie,{size:14}),t[3]=r,t[4]=u);let d;t[5]!==u||t[6]!==l?(d=(0,Q.jsx)(dt,{variant:`ghost`,size:`icon`,className:`h-6 w-6 shrink-0`,onClick:l,children:u}),t[5]=u,t[6]=l,t[7]=d):d=t[7];let f=`${o}%`,p;t[8]===f?p=t[9]:(p=(0,Q.jsx)(`div`,{className:`h-1 flex-grow bg-secondary rounded-full overflow-hidden`,children:(0,Q.jsx)(`div`,{className:`h-full bg-primary rounded-full transition-all duration-100`,style:{width:f}})}),t[8]=f,t[9]=p);let m;return t[10]!==d||t[11]!==p?(m=(0,Q.jsxs)(`div`,{className:`flex items-center gap-2 bg-muted rounded-full px-3 py-1 mt-1 w-fit min-w-[150px]`,children:[d,p]}),t[10]=d,t[11]=p,t[12]=m):m=t[12],m},Mr=H(),Nr=e(Be(),1);const Pr=e=>{let t=(0,Mr.c)(77),{comment:n,replies:i,depth:a,onReply:o,targetId:s,type:c}=e,l=a===void 0?0:a,{showToast:u}=rt(),{user:d}=at(),{mutate:f}=kr(),[p,m]=(0,X.useState)(!1),h=l>0,g;t[0]!==n.hasLiked||t[1]!==n.id||t[2]!==u||t[3]!==s||t[4]!==f||t[5]!==c||t[6]!==d?(g=()=>{if(!d){u(`Log in to like comments`);return}f({commentId:n.id,hasLiked:n.hasLiked,targetId:s,type:c})},t[0]=n.hasLiked,t[1]=n.id,t[2]=u,t[3]=s,t[4]=f,t[5]=c,t[6]=d,t[7]=g):g=t[7];let _=g,v=h&&`ml-8 md:ml-12`,y;t[8]===v?y=t[9]:(y=Z(`flex gap-3 mb-4`,v),t[8]=v,t[9]=y);let b;t[10]===n.user.avatar_url?b=t[11]:(b=(0,Q.jsx)(st,{src:n.user.avatar_url}),t[10]=n.user.avatar_url,t[11]=b);let x;t[12]===n.user.username[0]?x=t[13]:(x=n.user.username[0]?.toUpperCase(),t[12]=n.user.username[0],t[13]=x);let S;t[14]===x?S=t[15]:(S=(0,Q.jsx)(ct,{children:x}),t[14]=x,t[15]=S);let C;t[16]!==b||t[17]!==S?(C=(0,Q.jsxs)(ot,{className:`w-8 h-8 shrink-0`,children:[b,S]}),t[16]=b,t[17]=S,t[18]=C):C=t[18];let w;t[19]===n.user.username?w=t[20]:(w=(0,Q.jsx)(`span`,{className:`font-semibold text-sm`,children:n.user.username}),t[19]=n.user.username,t[20]=w);let T;t[21]===n.user.isVerified?T=t[22]:(T=n.user.isVerified&&(0,Q.jsx)(Qn,{}),t[21]=n.user.isVerified,t[22]=T);let E;t[23]===n.created_at?E=t[24]:(E=(0,Nr.default)(n.created_at).fromNow(!0),t[23]=n.created_at,t[24]=E);let D;t[25]===E?D=t[26]:(D=(0,Q.jsx)(`span`,{className:`text-xs text-muted-foreground ml-1`,children:E}),t[25]=E,t[26]=D);let O;t[27]!==T||t[28]!==D||t[29]!==w?(O=(0,Q.jsxs)(`div`,{className:`flex items-center gap-1`,children:[w,T,D]}),t[27]=T,t[28]=D,t[29]=w,t[30]=O):O=t[30];let k;t[31]!==n.audioUrl||t[32]!==n.text?(k=n.audioUrl?(0,Q.jsx)(`div`,{className:`mt-1`,children:(0,Q.jsx)(jr,{src:n.audioUrl})}):(0,Q.jsx)(`p`,{className:`text-sm dark:text-gray-200 leading-normal whitespace-pre-wrap break-words`,children:n.text}),t[31]=n.audioUrl,t[32]=n.text,t[33]=k):k=t[33];let A;t[34]!==n||t[35]!==o?(A=(0,Q.jsx)(`button`,{onClick:()=>o(n),className:`text-xs font-semibold text-muted-foreground hover:text-foreground transition-colors`,children:`Reply`}),t[34]=n,t[35]=o,t[36]=A):A=t[36];let j;t[37]!==i.length||t[38]!==p?(j=i.length>0&&(0,Q.jsxs)(`button`,{onClick:()=>m(!p),className:`text-xs font-semibold text-muted-foreground hover:text-foreground transition-colors flex items-center gap-1`,children:[(0,Q.jsx)(`div`,{className:`w-6 h-[1px] bg-muted-foreground`}),p?`Hide replies`:`View ${i.length} replies`]}),t[37]=i.length,t[38]=p,t[39]=j):j=t[39];let M;t[40]!==A||t[41]!==j?(M=(0,Q.jsxs)(`div`,{className:`flex items-center gap-4 mt-1`,children:[A,j]}),t[40]=A,t[41]=j,t[42]=M):M=t[42];let N;t[43]!==O||t[44]!==k||t[45]!==M?(N=(0,Q.jsxs)(`div`,{className:`flex flex-col`,children:[O,k,M]}),t[43]=O,t[44]=k,t[45]=M,t[46]=N):N=t[46];let P;t[47]!==l||t[48]!==o||t[49]!==i||t[50]!==p||t[51]!==s||t[52]!==c?(P=p&&i.length>0&&(0,Q.jsx)(`div`,{className:`mt-4`,children:i.map(e=>(0,Q.jsx)(Pr,{comment:e,replies:e.replies||[],depth:l+1,onReply:o,targetId:s,type:c},e.id))}),t[47]=l,t[48]=o,t[49]=i,t[50]=p,t[51]=s,t[52]=c,t[53]=P):P=t[53];let F;t[54]!==N||t[55]!==P?(F=(0,Q.jsxs)(`div`,{className:`flex-1 min-w-0`,children:[N,P]}),t[54]=N,t[55]=P,t[56]=F):F=t[56];let I=n.hasLiked?`text-red-500`:`text-muted-foreground hover:text-muted-foreground/80`,L;t[57]===I?L=t[58]:(L=Z(`transition-colors`,I),t[57]=I,t[58]=L);let R=n.hasLiked&&`fill-current`,z;t[59]===R?z=t[60]:(z=Z(`w-3 h-3`,R),t[59]=R,t[60]=z);let B;t[61]===z?B=t[62]:(B=(0,Q.jsx)(r,{className:z}),t[61]=z,t[62]=B);let V;t[63]!==_||t[64]!==L||t[65]!==B?(V=(0,Q.jsx)(`button`,{onClick:_,className:L,children:B}),t[63]=_,t[64]=L,t[65]=B,t[66]=V):V=t[66];let H;t[67]===n.likes_count?H=t[68]:(H=n.likes_count>0&&(0,Q.jsx)(`span`,{className:`text-[10px] text-muted-foreground`,children:n.likes_count}),t[67]=n.likes_count,t[68]=H);let U;t[69]!==V||t[70]!==H?(U=(0,Q.jsxs)(`div`,{className:`flex flex-col items-center gap-0.5 pt-1`,children:[V,H]}),t[69]=V,t[70]=H,t[71]=U):U=t[71];let W;return t[72]!==F||t[73]!==U||t[74]!==y||t[75]!==C?(W=(0,Q.jsxs)(`div`,{className:y,children:[C,F,U]}),t[72]=F,t[73]=U,t[74]=y,t[75]=C,t[76]=W):W=t[76],W};var Fr=H();const Ir=e=>{let t=(0,Fr.c)(12),{targetId:n,type:r,onReply:i}=e,{data:a,isLoading:o}=Er(n,r),s;t[0]===a?s=t[1]:(s=a===void 0?[]:a,t[0]=a,t[1]=s);let c=s,l;bb0:{if(!c){let e;t[2]===Symbol.for(`react.memo_cache_sentinel`)?(e=[],t[2]=e):e=t[2],l=e;break bb0}let e;if(t[3]!==c){let n=new Map;e=[],c.forEach(e=>{n.set(e.id,{...e,replies:[]})}),c.forEach(t=>{let r=n.get(t.id);t.parent_id&&n.has(t.parent_id)?n.get(t.parent_id).replies.push(r):e.push(r)}),t[3]=c,t[4]=e}else e=t[4];l=e}let u=l;if(o){let e;return t[5]===Symbol.for(`react.memo_cache_sentinel`)?(e=(0,Q.jsx)(`div`,{className:`p-4 space-y-4`,children:[1,2,3].map(Lr)}),t[5]=e):e=t[5],e}if(c.length===0){let e;return t[6]===Symbol.for(`react.memo_cache_sentinel`)?(e=(0,Q.jsxs)(`div`,{className:`flex flex-col items-center justify-center py-12 text-center`,children:[(0,Q.jsx)(`div`,{className:`text-2xl mb-2`,children:``}),(0,Q.jsx)(`h3`,{className:`font-semibold text-lg`,children:`No comments yet.`}),(0,Q.jsx)(`p`,{className:`text-muted-foreground text-sm`,children:`Start the conversation.`})]}),t[6]=e):e=t[6],e}let d;return t[7]!==i||t[8]!==u||t[9]!==n||t[10]!==r?(d=(0,Q.jsx)(`div`,{className:`p-4 pb-20 md:pb-4`,children:u.map(e=>(0,Q.jsx)(Pr,{comment:e,replies:e.replies||[],onReply:i,targetId:n,type:r},e.id))}),t[7]=i,t[8]=u,t[9]=n,t[10]=r,t[11]=d):d=t[11],d};function Lr(e){return(0,Q.jsxs)(`div`,{className:`flex gap-3`,children:[(0,Q.jsx)(yn,{className:`w-8 h-8 rounded-full`}),(0,Q.jsxs)(`div`,{className:`flex-1 space-y-2`,children:[(0,Q.jsx)(yn,{className:`h-4 w-32`}),(0,Q.jsx)(yn,{className:`h-3 w-full`})]})]},e)}var Rr=H(),zr=e(Be(),1),Br=e(He(),1);Fe(),zr.default.extend(Br.default),zr.default.locale(`en`);var Vr=()=>{let e=(0,Rr.c)(183),{viewingPost:t,viewingReel:n,showToast:i,savedPostIds:a,setViewingPost:o,setViewingReel:c}=rt(),{mutate:u}=pr(),d=re(),{user:f}=at(),{mutate:p}=or(),{mutate:m,isPending:h}=ur(),[g,_]=(0,X.useState)(``),[v,y]=(0,X.useState)(!1),[b,x]=(0,X.useState)(!1),[S,C]=(0,X.useState)(null),T=X.useRef(null),E=X.useRef(null),D=t||n,O,k;e[0]===Symbol.for(`react.memo_cache_sentinel`)?(O=()=>{let e=e=>{T.current&&!T.current.contains(e.target)&&y(!1)};return document.addEventListener(`mousedown`,e),()=>document.removeEventListener(`mousedown`,e)},k=[],e[0]=O,e[1]=k):(O=e[0],k=e[1]),X.useEffect(O,k);let A;e[2]===Symbol.for(`react.memo_cache_sentinel`)?(A=e=>{_(t=>t+e.emoji)},e[2]=A):A=e[2];let j=A,M=!!n,N=M?`reel`:`post`,F=D?String(D.id):``,I;bb0:{if(!D){let t;e[3]===Symbol.for(`react.memo_cache_sentinel`)?(t=[],e[3]=t):t=e[3],I=t;break bb0}if(M){let t=D,n;e[4]===t.src?n=e[5]:(n=[t.src],e[4]=t.src,e[5]=n),I=n;break bb0}let t=D,n=t.content?.src;if(!n){let n=t.content?.poster||``,r;e[6]===n?r=e[7]:(r=[n],e[6]=n,e[7]=r),I=r;break bb0}try{if(n.startsWith(`[`)){let t;e[8]===n?t=e[9]:(t=JSON.parse(n),e[8]=n,e[9]=t),I=t;break bb0}let t;e[10]===n?t=e[11]:(t=[n],e[10]=n,e[11]=t),I=t}catch{let t;e[12]===n?t=e[13]:(t=[n],e[12]=n,e[13]=t),I=t}}let L=I;if(!D)return null;let z;e[14]!==D.id||e[15]!==a?(z=a.has(D.id),e[14]=D.id,e[15]=a,e[16]=z):z=e[16];let V=z,H=D.hasLiked||!1,U;e[17]!==D.id||e[18]!==H||e[19]!==i||e[20]!==p||e[21]!==N||e[22]!==f?(U=()=>{if(!f){i(`Log in to like`);return}p({targetId:String(D.id),type:N,userId:f.id,hasLiked:H})},e[17]=D.id,e[18]=H,e[19]=i,e[20]=p,e[21]=N,e[22]=f,e[23]=U):U=e[23];let W=U,G;e[24]===Symbol.for(`react.memo_cache_sentinel`)?(G=e=>{C(e),E.current?.focus()},e[24]=G):G=e[24];let te=G,K;e[25]!==D.id||e[26]!==m||e[27]!==g||e[28]!==S?.id||e[29]!==i||e[30]!==N||e[31]!==f?(K=(e,t)=>{if(e&&e.preventDefault(),!f){i(`Log in to comment`);return}!t&&!g.trim()||m({targetId:String(D.id),type:N,text:t?`Voice Message`:g,userId:f.id,audioBlob:t,parentId:S?.id},{onSuccess:()=>{i(`Comment added`),_(``),x(!1),C(null)},onError:()=>i(`Failed to add comment`)})},e[25]=D.id,e[26]=m,e[27]=g,e[28]=S?.id,e[29]=i,e[30]=N,e[31]=f,e[32]=K):K=e[32];let ne=K,ie;e[33]!==o||e[34]!==c||e[35]!==t||e[36]!==n?(ie=()=>{t&&o(null),n&&c(null),C(null)},e[33]=o,e[34]=c,e[35]=t,e[36]=n,e[37]=ie):ie=e[37];let ae=ie,oe;e[38]!==d||e[39]!==ae?(oe=e=>{ae(),d(`/profile/${e.username}`)},e[38]=d,e[39]=ae,e[40]=oe):oe=e[40];let se=oe,ce;e[41]===ae?ce=e[42]:(ce=e=>!e&&ae(),e[41]=ae,e[42]=ce);let le;e[43]===D.user.username?le=e[44]:(le=(0,Q.jsxs)(gn,{className:`sr-only`,children:[`Post by `,D.user.username]}),e[43]=D.user.username,e[44]=le);let ue;e[45]!==M||e[46]!==L?(ue=(0,Q.jsx)(`div`,{className:`hidden md:flex flex-1 bg-black items-center justify-center h-full border-r border-border relative group`,children:M?(0,Q.jsx)(`video`,{src:L[0],className:`max-h-full max-w-full`,controls:!0,autoPlay:!0,loop:!0}):(0,Q.jsx)(Cn,{images:L,className:`w-full h-full bg-black`,aspectRatio:`max-h-full max-w-full`})}),e[45]=M,e[46]=L,e[47]=ue):ue=e[47];let de;e[48]===Symbol.for(`react.memo_cache_sentinel`)?(de=(0,Q.jsx)(`div`,{className:`md:hidden w-full text-center font-bold text-sm`,children:`Comments`}),e[48]=de):de=e[48];let fe;e[49]!==D.user||e[50]!==se?(fe=()=>se(D.user),e[49]=D.user,e[50]=se,e[51]=fe):fe=e[51];let pe;e[52]===D.user.avatar?pe=e[53]:(pe=(0,Q.jsx)(st,{src:D.user.avatar}),e[52]=D.user.avatar,e[53]=pe);let q;e[54]===D.user.username[0]?q=e[55]:(q=D.user.username?.[0]?.toUpperCase()||`?`,e[54]=D.user.username[0],e[55]=q);let he;e[56]===q?he=e[57]:(he=(0,Q.jsx)(ct,{children:q}),e[56]=q,e[57]=he);let ge;e[58]!==pe||e[59]!==he?(ge=(0,Q.jsxs)(ot,{className:`w-8 h-8 border border-border`,children:[pe,he]}),e[58]=pe,e[59]=he,e[60]=ge):ge=e[60];let J;e[61]===D.user.username?J=e[62]:(J=(0,Q.jsx)(`span`,{className:`font-semibold text-sm hover:opacity-70`,children:D.user.username}),e[61]=D.user.username,e[62]=J);let _e;e[63]===D.user.isVerified?_e=e[64]:(_e=D.user.isVerified&&(0,Q.jsx)(Qn,{}),e[63]=D.user.isVerified,e[64]=_e);let ve;e[65]!==J||e[66]!==_e?(ve=(0,Q.jsxs)(`div`,{className:`flex items-center`,children:[J,_e]}),e[65]=J,e[66]=_e,e[67]=ve):ve=e[67];let be;e[68]!==fe||e[69]!==ge||e[70]!==ve?(be=(0,Q.jsxs)(`div`,{className:`hidden md:flex items-center gap-3 cursor-pointer`,onClick:fe,children:[ge,ve]}),e[68]=fe,e[69]=ge,e[70]=ve,e[71]=be):be=e[71];let xe;e[72]===Symbol.for(`react.memo_cache_sentinel`)?(xe=(0,Q.jsx)(w,{size:20,className:`hidden md:block cursor-pointer hover:opacity-70`}),e[72]=xe):xe=e[72];let Se;e[73]===be?Se=e[74]:(Se=(0,Q.jsxs)(`div`,{className:`p-4 flex items-center justify-between shrink-0`,children:[de,be,xe]}),e[73]=be,e[74]=Se);let Y;e[75]===Symbol.for(`react.memo_cache_sentinel`)?(Y=(0,Q.jsx)(gr,{}),e[75]=Y):Y=e[75];let Ce;e[76]!==D.user||e[77]!==se?(Ce=()=>se(D.user),e[76]=D.user,e[77]=se,e[78]=Ce):Ce=e[78];let we;e[79]===D.user.avatar?we=e[80]:(we=(0,Q.jsx)(st,{src:D.user.avatar}),e[79]=D.user.avatar,e[80]=we);let Te;e[81]===D.user.username[0]?Te=e[82]:(Te=D.user.username[0].toUpperCase(),e[81]=D.user.username[0],e[82]=Te);let Ee;e[83]===Te?Ee=e[84]:(Ee=(0,Q.jsx)(ct,{children:Te}),e[83]=Te,e[84]=Ee);let De;e[85]!==Ce||e[86]!==we||e[87]!==Ee?(De=(0,Q.jsxs)(ot,{className:`w-8 h-8 cursor-pointer flex-shrink-0`,onClick:Ce,children:[we,Ee]}),e[85]=Ce,e[86]=we,e[87]=Ee,e[88]=De):De=e[88];let Oe;e[89]!==D.user||e[90]!==se?(Oe=()=>se(D.user),e[89]=D.user,e[90]=se,e[91]=Oe):Oe=e[91];let ke;e[92]!==D.user.username||e[93]!==Oe?(ke=(0,Q.jsx)(`span`,{className:`font-semibold mr-2 cursor-pointer`,onClick:Oe,children:D.user.username}),e[92]=D.user.username,e[93]=Oe,e[94]=ke):ke=e[94];let Ae;e[95]===D.user.isVerified?Ae=e[96]:(Ae=D.user.isVerified&&(0,Q.jsx)(Qn,{}),e[95]=D.user.isVerified,e[96]=Ae);let je;e[97]!==ke||e[98]!==Ae?(je=(0,Q.jsxs)(`div`,{className:`flex items-center`,children:[ke,Ae]}),e[97]=ke,e[98]=Ae,e[99]=je):je=e[99];let Me;e[100]===D.caption?Me=e[101]:(Me=(0,Q.jsx)(`span`,{className:`whitespace-pre-wrap`,children:D.caption}),e[100]=D.caption,e[101]=Me);let Pe;e[102]===D?Pe=e[103]:(Pe=`createdAt`in D&&D.createdAt?(0,zr.default)(D.createdAt).fromNow():`time`in D?D.time:``,e[102]=D,e[103]=Pe);let Fe;e[104]===Pe?Fe=e[105]:(Fe=(0,Q.jsx)(`div`,{className:`text-xs text-muted-foreground mt-1`,children:Pe}),e[104]=Pe,e[105]=Fe);let Ie;e[106]!==je||e[107]!==Me||e[108]!==Fe?(Ie=(0,Q.jsxs)(`div`,{className:`text-sm`,children:[je,Me,Fe]}),e[106]=je,e[107]=Me,e[108]=Fe,e[109]=Ie):Ie=e[109];let Le;e[110]!==De||e[111]!==Ie?(Le=(0,Q.jsxs)(`div`,{className:`flex gap-3`,children:[De,Ie]}),e[110]=De,e[111]=Ie,e[112]=Le):Le=e[112];let Re;e[113]!==F||e[114]!==N?(Re=(0,Q.jsx)(Ir,{targetId:F,type:N,onReply:te}),e[113]=F,e[114]=N,e[115]=Re):Re=e[115];let ze;e[116]!==Le||e[117]!==Re?(ze=(0,Q.jsx)(`div`,{className:`flex-1 min-h-0 overflow-hidden`,children:(0,Q.jsx)(vr,{className:`h-full w-full`,children:(0,Q.jsxs)(`div`,{className:`p-4 space-y-4`,children:[Le,Re]})})}),e[116]=Le,e[117]=Re,e[118]=ze):ze=e[118];let Be;e[119]===Symbol.for(`react.memo_cache_sentinel`)?(Be=(0,Q.jsx)(gr,{}),e[119]=Be):Be=e[119];let Ve;e[120]===v?Ve=e[121]:(Ve=v&&(0,Q.jsx)(`div`,{ref:T,className:`absolute bottom-full left-0 z-50 shadow-2xl mb-2`,children:(0,Q.jsx)(s,{theme:document.documentElement.classList.contains(`dark`)?l.DARK:l.LIGHT,onEmojiClick:j,lazyLoadEmojis:!0,skinTonesDisabled:!0,searchDisabled:!1,width:300,height:400})}),e[120]=v,e[121]=Ve);let He=`cursor-pointer hover:opacity-70 transition-transform active:scale-90 ${H?`fill-[#f42a41] text-[#f42a41]`:``}`,Ue;e[122]!==W||e[123]!==He?(Ue=(0,Q.jsx)(r,{size:24,className:He,onClick:W}),e[122]=W,e[123]=He,e[124]=Ue):Ue=e[124];let We;e[125]===Symbol.for(`react.memo_cache_sentinel`)?(We=(0,Q.jsx)(ee,{size:24,className:`-scale-x-100 cursor-pointer hover:opacity-70`,onClick:()=>E.current?.focus()}),e[125]=We):We=e[125];let Ge;e[126]===i?Ge=e[127]:(Ge=(0,Q.jsx)(me,{size:24,className:`cursor-pointer hover:opacity-70`,onClick:()=>i(`Shared`)}),e[126]=i,e[127]=Ge);let Ke;e[128]!==Ue||e[129]!==Ge?(Ke=(0,Q.jsxs)(`div`,{className:`flex items-center gap-4`,children:[Ue,We,Ge]}),e[128]=Ue,e[129]=Ge,e[130]=Ke):Ke=e[130];let qe=`cursor-pointer hover:opacity-70 ${V?`fill-current`:``}`,Je;e[131]!==D||e[132]!==V||e[133]!==u||e[134]!==f?(Je=()=>{f&&D&&u({postId:String(D.id),userId:f.id,hasSaved:V})},e[131]=D,e[132]=V,e[133]=u,e[134]=f,e[135]=Je):Je=e[135];let Ye;e[136]!==qe||e[137]!==Je?(Ye=(0,Q.jsx)(R,{size:24,className:qe,onClick:Je}),e[136]=qe,e[137]=Je,e[138]=Ye):Ye=e[138];let Xe;e[139]!==Ke||e[140]!==Ye?(Xe=(0,Q.jsxs)(`div`,{className:`flex items-center justify-between mb-2`,children:[Ke,Ye]}),e[139]=Ke,e[140]=Ye,e[141]=Xe):Xe=e[141];let Ze=D.likes+` likes`,Qe;e[142]===Ze?Qe=e[143]:(Qe=(0,Q.jsx)(`span`,{className:`font-semibold text-sm`,children:Ze}),e[142]=Ze,e[143]=Qe);let $e;e[144]===D?$e=e[145]:($e=`createdAt`in D&&D.createdAt?(0,zr.default)(D.createdAt).fromNow():`time`in D?D.time:``,e[144]=D,e[145]=$e);let et;e[146]===$e?et=e[147]:(et=(0,Q.jsx)(`span`,{className:`text-[10px] text-muted-foreground uppercase`,children:$e}),e[146]=$e,e[147]=et);let tt;e[148]!==Qe||e[149]!==et?(tt=(0,Q.jsxs)(`div`,{className:`flex flex-col mb-2`,children:[Qe,et]}),e[148]=Qe,e[149]=et,e[150]=tt):tt=e[150];let nt;e[151]===b?nt=e[152]:(nt=!b&&(0,Q.jsx)(`div`,{className:`flex gap-4 mt-2 mb-1 overflow-x-auto scrollbar-hide py-1`,children:[``,``,``,``,``,``,``,``].map(e=>(0,Q.jsx)(`span`,{className:`text-xl cursor-pointer hover:scale-125 transition-transform`,onClick:()=>_(t=>t+e),children:e},e))}),e[151]=b,e[152]=nt);let it;e[153]===S?it=e[154]:(it=S&&(0,Q.jsxs)(`div`,{className:`flex items-center gap-2 mr-2 bg-primary/10 px-2 py-0.5 rounded text-xs text-primary whitespace-nowrap`,children:[(0,Q.jsxs)(`span`,{children:[`@`,S.user.username]}),(0,Q.jsx)(`button`,{onClick:()=>C(null),children:(0,Q.jsx)(B,{className:`w-3 h-3`})})]}),e[153]=S,e[154]=it);let Z;e[155]!==ne||e[156]!==h||e[157]!==g||e[158]!==v||e[159]!==b?(Z=b?(0,Q.jsx)(xr,{onRecordingComplete:e=>ne(void 0,e),onCancel:()=>x(!1)}):(0,Q.jsxs)(`form`,{onSubmit:e=>ne(e),className:`flex items-center gap-2 w-full relative`,children:[(0,Q.jsx)(ye,{size:20,className:`cursor-pointer transition-colors flex-shrink-0 ${v?`text-primary`:`text-muted-foreground hover:text-foreground`}`,onClick:()=>y(!v)}),(0,Q.jsx)(`input`,{ref:E,type:`text`,placeholder:`Add a comment...`,className:`bg-transparent text-sm w-full outline-none text-foreground`,value:g,onChange:e=>_(e.target.value),onFocus:()=>y(!1),disabled:h}),!g&&(0,Q.jsx)(Ne,{size:20,className:`text-muted-foreground cursor-pointer hover:text-foreground flex-shrink-0`,onClick:()=>x(!0)}),(0,Q.jsx)(`button`,{type:`submit`,className:`text-primary text-sm font-semibold disabled:opacity-50 hover:text-primary/80 flex-shrink-0`,disabled:!g||h,children:h?(0,Q.jsx)(P,{className:`h-4 w-4 animate-spin`}):`Post`})]}),e[155]=ne,e[156]=h,e[157]=g,e[158]=v,e[159]=b,e[160]=Z):Z=e[160];let lt;e[161]!==it||e[162]!==Z?(lt=(0,Q.jsxs)(`div`,{className:`flex bg-muted rounded-full px-3 py-1.5 focus-within:ring-1 ring-primary/50 items-center justify-between border border-transparent transition-all`,children:[it,Z]}),e[161]=it,e[162]=Z,e[163]=lt):lt=e[163];let ut;e[164]!==Ve||e[165]!==Xe||e[166]!==tt||e[167]!==nt||e[168]!==lt?(ut=(0,Q.jsxs)(`div`,{className:`px-4 py-3 relative shrink-0`,children:[Ve,Xe,tt,nt,lt]}),e[164]=Ve,e[165]=Xe,e[166]=tt,e[167]=nt,e[168]=lt,e[169]=ut):ut=e[169];let dt;e[170]!==Se||e[171]!==ze||e[172]!==ut?(dt=(0,Q.jsxs)(`div`,{className:`w-full md:w-[400px] flex flex-col h-full overflow-hidden`,children:[Se,Y,ze,Be,ut]}),e[170]=Se,e[171]=ze,e[172]=ut,e[173]=dt):dt=e[173];let ft;e[174]!==ue||e[175]!==dt?(ft=(0,Q.jsxs)(`div`,{className:`flex flex-col md:flex-row h-full w-full bg-background`,children:[ue,dt]}),e[174]=ue,e[175]=dt,e[176]=ft):ft=e[176];let pt;e[177]!==le||e[178]!==ft?(pt=(0,Q.jsxs)(mn,{className:`max-w-5xl h-[95vh] md:h-[650px] md:max-h-[90vh] p-0 overflow-hidden border-none sm:rounded-lg`,children:[le,ft]}),e[177]=le,e[178]=ft,e[179]=pt):pt=e[179];let mt;return e[180]!==ce||e[181]!==pt?(mt=(0,Q.jsx)(dn,{open:!0,onOpenChange:ce,children:pt}),e[180]=ce,e[181]=pt,e[182]=mt):mt=e[182],mt},Hr=H(),Ur=e=>{let t=(0,Hr.c)(6),{children:n}=e,r,i,a,o;t[0]===Symbol.for(`react.memo_cache_sentinel`)?(r={opacity:0},i={opacity:1},a={opacity:0},o={duration:.15,ease:`easeOut`},t[0]=r,t[1]=i,t[2]=a,t[3]=o):(r=t[0],i=t[1],a=t[2],o=t[3]);let s;return t[4]===n?s=t[5]:(s=(0,Q.jsx)(V.div,{initial:r,animate:i,exit:a,transition:o,className:`w-full flex justify-center`,children:n}),t[4]=n,t[5]=s),s},Wr=H();function Gr(){let e=(0,Wr.c)(4),t;e[0]===Symbol.for(`react.memo_cache_sentinel`)?(t=(0,Q.jsxs)(`div`,{className:`mb-8 mt-4 flex items-center gap-2 px-2`,children:[(0,Q.jsx)(yn,{className:`w-8 h-8 rounded-md shrink-0`}),(0,Q.jsx)(yn,{className:`h-6 w-32 hidden lg:block`})]}),e[0]=t):t=e[0];let n;e[1]===Symbol.for(`react.memo_cache_sentinel`)?(n=(0,Q.jsxs)(`div`,{className:`hidden md:flex flex-col w-[72px] lg:w-[245px] h-screen fixed border-r border-border p-4 gap-4 z-50 bg-background`,children:[t,(0,Q.jsx)(`div`,{className:`flex flex-col gap-2`,children:Array.from({length:6}).map(Yr)})]}),e[1]=n):n=e[1];let r;e[2]===Symbol.for(`react.memo_cache_sentinel`)?(r=(0,Q.jsx)(`div`,{className:`md:hidden fixed bottom-0 left-0 right-0 h-16 border-t border-border bg-background flex justify-around items-center px-4 z-50`,children:Array.from({length:5}).map(Jr)}),e[2]=r):r=e[2];let i;return e[3]===Symbol.for(`react.memo_cache_sentinel`)?(i=(0,Q.jsxs)(`div`,{className:`min-h-screen flex flex-col md:flex-row bg-background`,children:[n,r,(0,Q.jsx)(`main`,{className:`flex-grow md:ml-[72px] lg:ml-[245px] flex justify-center pt-4 md:pt-8 pb-20 md:pb-0`,children:(0,Q.jsxs)(`div`,{className:`w-full max-w-[470px] flex flex-col gap-6 px-4 md:px-0`,children:[(0,Q.jsx)(`div`,{className:`flex gap-4 overflow-hidden`,children:Array.from({length:6}).map(qr)}),Array.from({length:2}).map(Kr)]})})]}),e[3]=i):i=e[3],i}function Kr(e,t){return(0,Q.jsxs)(`div`,{className:`w-full rounded-xl overflow-hidden border border-border bg-card shadow-sm`,children:[(0,Q.jsxs)(`div`,{className:`p-3 flex items-center gap-3`,children:[(0,Q.jsx)(yn,{className:`w-8 h-8 rounded-full`}),(0,Q.jsxs)(`div`,{className:`space-y-2`,children:[(0,Q.jsx)(yn,{className:`w-24 h-3`}),(0,Q.jsx)(yn,{className:`w-16 h-2`})]})]}),(0,Q.jsx)(yn,{className:`w-full aspect-square`}),(0,Q.jsxs)(`div`,{className:`p-3 space-y-3`,children:[(0,Q.jsx)(yn,{className:`w-full h-4`}),(0,Q.jsx)(yn,{className:`w-3/4 h-4`})]})]},t)}function qr(e,t){return(0,Q.jsxs)(`div`,{className:`flex flex-col items-center gap-2 shrink-0`,children:[(0,Q.jsx)(yn,{className:`w-16 h-16 rounded-full border-2 border-background`}),(0,Q.jsx)(yn,{className:`w-12 h-2`})]},t)}function Jr(e,t){return(0,Q.jsx)(yn,{className:`w-6 h-6 rounded-full`},t)}function Yr(e,t){return(0,Q.jsxs)(`div`,{className:`flex items-center gap-4 px-2 py-3`,children:[(0,Q.jsx)(yn,{className:`w-6 h-6 rounded-md shrink-0`}),(0,Q.jsx)(yn,{className:`h-4 w-24 hidden lg:block`})]},t)}var Xr=H(),Zr=e(Be(),1);const Qr=[`notifications`],$r=e=>{let t=(0,Xr.c)(5),n=!!e,r;t[0]===e?r=t[1]:(r=async()=>{let{data:t,error:n}=await $.from(`notifications`).select(`
          id,
          created_at,
          type,
          post_id,
          reel_id,
          actor_id,
          actor:profiles!actor_id (username, avatar_url, is_verified)
        `).eq(`user_id`,e).order(`created_at`,{ascending:!1});if(n)throw n;return(t||[]).map(ei)},t[0]=e,t[1]=r);let i;return t[2]!==n||t[3]!==r?(i={queryKey:Qr,enabled:n,queryFn:r},t[2]=n,t[3]=r,t[4]=i):i=t[4],J(i)};function ei(e){let t=`interacted with you.`;return e.type===`follow`?t=`started following you.`:e.type===`like`?t=`liked your `+(e.reel_id?`reel.`:`post.`):e.type===`comment`?t=`commented on your `+(e.reel_id?`reel.`:`post.`):e.type===`mention`&&(t=`mentioned you in a `+(e.reel_id?`reel.`:`post.`)),{id:e.id,created_at:e.created_at,type:e.type,user:{id:e.actor_id||``,username:e.actor?.username||`Unknown`,name:e.actor?.username||`Unknown`,avatar:e.actor?.avatar_url||``,isVerified:e.actor?.is_verified||!1},text:t,time:(0,Zr.default)(e.created_at).fromNow(),isFollowing:!1,post_id:e.post_id||void 0,reel_id:e.reel_id||void 0}}var ti=H(),ni=e=>{let t=(0,ti.c)(7),n;t[0]===e?n=t[1]:({...n}=e,t[0]=e,t[1]=n);let{theme:r}=Me(),i=r===void 0?`system`:r,a,o;t[2]===Symbol.for(`react.memo_cache_sentinel`)?(a={success:(0,Q.jsx)(g,{className:`size-4`}),info:(0,Q.jsx)(u,{className:`size-4`}),warning:(0,Q.jsx)(ne,{className:`size-4`}),error:(0,Q.jsx)(ae,{className:`size-4`}),loading:(0,Q.jsx)(P,{className:`size-4 animate-spin`})},o={"--normal-bg":`var(--popover)`,"--normal-text":`var(--popover-foreground)`,"--normal-border":`var(--border)`,"--border-radius":`var(--radius)`},t[2]=a,t[3]=o):(a=t[2],o=t[3]);let s;return t[4]!==n||t[5]!==i?(s=(0,Q.jsx)(v,{theme:i,className:`toaster group`,icons:a,style:o,...n}),t[4]=n,t[5]=i,t[6]=s):s=t[6],s},ri=H(),ii=e(Be(),1),ai=(0,X.lazy)(()=>Ue(()=>import(`./HomeView-BIY3KiPp.js`),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]))),oi=(0,X.lazy)(()=>Ue(()=>import(`./ProfileView-DDaHHPzN.js`),__vite__mapDeps([10,1,2,3,4,5,11,9]))),si=(0,X.lazy)(()=>Ue(()=>import(`./MessagesView-BOLlrCp7.js`),__vite__mapDeps([12,1,2,3,4,5,11]))),ci=(0,X.lazy)(()=>Ue(()=>import(`./ReelsView-BMQmIY6g.js`),__vite__mapDeps([13,1,2,3,4,5,7,8,9]))),li=(0,X.lazy)(()=>Ue(()=>import(`./NotificationsView-BbBkCTo_.js`),__vite__mapDeps([14,1,2,3,4,5,9,8]))),ui=(0,X.lazy)(()=>Ue(()=>import(`./ExploreView-Cvt-nVxc.js`),__vite__mapDeps([15,1,2,3,4,5]))),di=(0,X.lazy)(()=>Ue(()=>import(`./AuthView-HhhOvXGw.js`),__vite__mapDeps([16,1,2,3,4]))),fi=(0,X.lazy)(()=>Ue(()=>import(`./PostView-N0IIGuj7.js`),__vite__mapDeps([17,1,2,3,4,5,6,7,8])));function pi(){let e=(0,ri.c)(43),{theme:t,viewingStory:n,setCurrentUser:r,setUnreadNotificationsCount:i,showToast:a}=rt(),{user:o,profile:s,loading:c}=at(),l=te(),u=Y();Ot();let{data:d}=$r(o?.id),f;e[0]===d?f=e[1]:(f=d===void 0?[]:d,e[0]=d,e[1]=f);let p=f,m=l.pathname.startsWith(`/reels/`)&&l.pathname.split(`/`).length===3||l.pathname.startsWith(`/post/`)&&l.pathname.split(`/`).length===3,h,g;e[2]===t?(h=e[3],g=e[4]):(h=()=>{t===`dark`?document.documentElement.classList.add(`dark`):document.documentElement.classList.remove(`dark`)},g=[t],e[2]=t,e[3]=h,e[4]=g),(0,X.useEffect)(h,g);let _,v;e[5]!==u||e[6]!==a||e[7]!==o?(_=()=>{if(!o)return;let e=$.channel(`notifications_realtime_${o.id}`).on(`postgres_changes`,{event:`INSERT`,schema:`public`,table:`notifications`,filter:`user_id=eq.${o.id}`},e=>{console.log(`New notification:`,e),u.invalidateQueries({queryKey:Qr}),a(`New notification received`)}).subscribe();return()=>{$.removeChannel(e)}},v=[o,u,a],e[5]=u,e[6]=a,e[7]=o,e[8]=_,e[9]=v):(_=e[8],v=e[9]),(0,X.useEffect)(_,v);let y,b;e[10]!==p||e[11]!==i?(y=()=>{let e=localStorage.getItem(`lastNotificationReadTime`),t=e?(0,ii.default)(e):(0,ii.default)(0);i(p.filter(e=>e.created_at&&(0,ii.default)(e.created_at).isAfter(t)).length)},b=[p,i],e[10]=p,e[11]=i,e[12]=y,e[13]=b):(y=e[12],b=e[13]),(0,X.useEffect)(y,b),Tt();let x,S;if(e[14]!==s||e[15]!==r||e[16]!==o?(x=()=>{s&&o&&r({id:o.id,username:s.username,name:s.full_name||o.email||`User`,avatar:s.avatar_url||`https://api.dicebear.com/9.x/avataaars/svg?seed=default`,bio:s.bio||``,isVerified:s.is_verified||!1,stats:{posts:0,followers:0,following:0}})},S=[s,o,r],e[14]=s,e[15]=r,e[16]=o,e[17]=x,e[18]=S):(x=e[17],S=e[18]),(0,X.useEffect)(x,S),c){let t;return e[19]===Symbol.for(`react.memo_cache_sentinel`)?(t=(0,Q.jsx)(`div`,{className:`min-h-screen flex items-center justify-center bg-background`,children:(0,Q.jsx)(`img`,{src:`/icon.png`,className:`w-20 h-20 animate-pulse`,alt:`Loading`})}),e[19]=t):t=e[19],t}if(!o&&!m){let t;return e[20]===Symbol.for(`react.memo_cache_sentinel`)?(t=(0,Q.jsx)(X.Suspense,{fallback:(0,Q.jsx)(`div`,{className:`min-h-screen flex items-center justify-center bg-background`,children:(0,Q.jsx)(`img`,{src:`/icon.png`,className:`w-20 h-20 animate-pulse`,alt:`Loading`})}),children:(0,Q.jsx)(di,{})}),e[20]=t):t=e[20],t}let C,w,T,E;e[21]===Symbol.for(`react.memo_cache_sentinel`)?(C=(0,Q.jsx)(ni,{}),w=(0,Q.jsx)(Dn,{}),T=(0,Q.jsx)(Jn,{}),E=(0,Q.jsx)(Vr,{}),e[21]=C,e[22]=w,e[23]=T,e[24]=E):(C=e[21],w=e[22],T=e[23],E=e[24]);let D;e[25]===n?D=e[26]:(D=n!==null&&(0,Q.jsx)(nr,{}),e[25]=n,e[26]=D);let O;e[27]===D?O=e[28]:(O=(0,Q.jsx)(z,{children:D}),e[27]=D,e[28]=O);let k;e[29]===Symbol.for(`react.memo_cache_sentinel`)?(k=(0,Q.jsx)(Gr,{}),e[29]=k):k=e[29];let A;e[30]===Symbol.for(`react.memo_cache_sentinel`)?(A=(0,Q.jsx)(Ct,{}),e[30]=A):A=e[30];let j;e[31]===Symbol.for(`react.memo_cache_sentinel`)?(j=(0,Q.jsx)(q,{path:`/`,element:(0,Q.jsx)(Ur,{children:(0,Q.jsx)(ai,{})})}),e[31]=j):j=e[31];let M;e[32]===Symbol.for(`react.memo_cache_sentinel`)?(M=(0,Q.jsx)(q,{path:`/explore`,element:(0,Q.jsx)(Ur,{children:(0,Q.jsx)(ui,{})})}),e[32]=M):M=e[32];let N;e[33]===Symbol.for(`react.memo_cache_sentinel`)?(N=(0,Q.jsx)(q,{path:`/post/:id`,element:(0,Q.jsx)(Ur,{children:(0,Q.jsx)(fi,{})})}),e[33]=N):N=e[33];let P;e[34]===Symbol.for(`react.memo_cache_sentinel`)?(P=(0,Q.jsx)(q,{path:`/reels/:id?`,element:(0,Q.jsx)(Ur,{children:(0,Q.jsx)(ci,{})})}),e[34]=P):P=e[34];let F;e[35]===Symbol.for(`react.memo_cache_sentinel`)?(F=(0,Q.jsx)(q,{path:`/messages/:username?`,element:(0,Q.jsx)(Ur,{children:(0,Q.jsx)(si,{})})}),e[35]=F):F=e[35];let I;e[36]===Symbol.for(`react.memo_cache_sentinel`)?(I=(0,Q.jsx)(q,{path:`/notifications`,element:(0,Q.jsx)(Ur,{children:(0,Q.jsx)(li,{})})}),e[36]=I):I=e[36];let L;e[37]===Symbol.for(`react.memo_cache_sentinel`)?(L=(0,Q.jsxs)(q,{element:A,children:[j,M,N,P,F,I,(0,Q.jsx)(q,{path:`/profile/:username`,element:(0,Q.jsx)(Ur,{children:(0,Q.jsx)(oi,{})})})]}),e[37]=L):L=e[37];let R;e[38]===l?R=e[39]:(R=(0,Q.jsx)(z,{mode:`wait`,children:(0,Q.jsx)(X.Suspense,{fallback:k,children:(0,Q.jsx)(De,{location:l,children:L},l.pathname)})}),e[38]=l,e[39]=R);let B;return e[40]!==O||e[41]!==R?(B=(0,Q.jsxs)(Q.Fragment,{children:[C,w,T,E,O,R]}),e[40]=O,e[41]=R,e[42]=B):B=e[42],B}const mi=({children:e})=>{let[t,n]=(0,X.useState)(null),[r,i]=(0,X.useState)(null),[a,o]=(0,X.useState)(null),[s,c]=(0,X.useState)(!0);(0,X.useEffect)(()=>{$.auth.getSession().then(({data:{session:e}})=>{n(e),i(e?.user??null),e?.user?l(e.user.id):c(!1)});let{data:{subscription:e}}=$.auth.onAuthStateChange((e,t)=>{n(t),i(t?.user??null),t?.user?l(t.user.id):(o(null),c(!1))});return()=>e.unsubscribe()},[]);let l=async e=>{try{let{data:t,error:n}=await $.from(`profiles`).select(`*`).eq(`id`,e).single();n?console.error(`Error fetching profile:`,n):o(t)}finally{c(!1)}};return(0,Q.jsx)(it.Provider,{value:{session:t,user:r,profile:a,loading:s,signIn:async(e,t)=>{let{data:n,error:r}=await $.auth.signInWithPassword({email:e,password:t});return{data:n,error:r}},signUp:async(e,t,n)=>{let{data:r,error:i}=await $.auth.signUp({email:e,password:t,options:{data:n}});return{data:r,error:i}},signOut:async()=>{await $.auth.signOut()},resetPassword:async e=>{let{data:t,error:n}=await $.auth.resetPasswordForEmail(e,{redirectTo:`${window.location.origin}/?reset=true`});return{data:t,error:n}},updatePassword:async e=>{let{data:t,error:n}=await $.auth.updateUser({password:e});return{data:t,error:n}}},children:!s&&e})};var hi=new qe({defaultOptions:{queries:{staleTime:1e3*60*5,gcTime:1e3*60*60*24,retry:1}}}),gi=Je({storage:window.localStorage});(0,Xe.createRoot)(document.getElementById(`root`)).render((0,Q.jsx)(X.StrictMode,{children:(0,Q.jsxs)(t,{client:hi,persistOptions:{persister:gi},children:[(0,Q.jsx)(U,{children:(0,Q.jsx)(mi,{children:(0,Q.jsx)(pi,{})})}),(0,Q.jsx)(k,{initialIsOpen:!1})]})}));export{ot as A,Kt as C,Mt as D,jt as E,rt as F,st as M,Z as N,$ as O,at as P,nn as S,Rt as T,yn as _,ur as a,hn as b,Ln as c,Hn as d,Un as f,xn as g,Cn as h,pr as i,ct as j,dt as k,Wn as l,Nn as m,jr as n,or as o,Gn as p,xr as r,Qn as s,$r as t,zn as u,dn as v,Lt as w,gn as x,mn as y};